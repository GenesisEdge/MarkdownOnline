var C=Object.defineProperty;var I=(e,t,n)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var b=(e,t,n)=>(I(e,typeof t!="symbol"?t+"":t,n),n);import{c as client}from"./react-dom-d3bdc6a0.js";import{s as styled,B as Button,g as grey,M as Menu,D as Dialog,a as DialogTitle,b as DialogContent,c as DialogContentText,T as TextField,d as DialogActions,e as default_1,f as MenuItem,h as default_1$1,F as FormControl,i as Box$1,I as InputLabel,S as Select,j as default_1$3,k as default_1$4,l as default_1$5,m as default_1$6,n as TreeItem,t as treeItemClasses,o as alpha,C as Collapse,p as SimpleTreeView,q as default_1$7,r as default_1$8,u as default_1$9,v as Breadcrumbs,L as Link,w as default_1$a,x as default_1$b,y as Typography,z as default_1$c,A as Switch,E as Divider,G as useTheme,H as default_1$d,J as default_1$e,K as Tooltip,Z as Zoom,N as createTheme,O as purple,P as Drawer,Q as ThemeProvider,R as IconButton,U as default_1$f,V as default_1$g,W as Grid,X as CssBaseline,Y as AppBar,_ as Toolbar,$ as default_1$h,a0 as default_1$i,a1 as default_1$j,a2 as List,a3 as ListItem,a4 as ListItemButton,a5 as ListItemAvatar,a6 as Avatar,a7 as ListItemText,a8 as default_1$k,a9 as default_1$l,aa as default_1$m,ab as Backdrop,ac as blue,ad as green}from"./@mui-d5c7f6ed.js";import{Message,Notification}from"https://jsd.onmicrosoft.cn/npm/@arco-design/web-react@2.62.0/+esm";import{openDB,updateDB,cursorGetData,cursorGetDataByIndex}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@V2.1.1/@cdn/functions/App/db.min.js";import{makeAutoObservable,observable,toJS}from"https://jsd.onmicrosoft.cn/npm/mobx@6.12.0/+esm";import{o as observer}from"./mobx-react-ed2466fd.js";import axios from"https://jsd.onmicrosoft.cn/npm/axios@1.6.5/+esm";import hljs from"https://npm.elemecdn.com/@highlightjs/cdn-assets@11.6.0/es/highlight.min.js";import{marked}from"https://npm.elemecdn.com/marked/lib/marked.esm.js";import mermaid from"https://jsd.onmicrosoft.cn/npm/mermaid@10/dist/mermaid.esm.min.mjs";import*as IncrementalDOM from"https://jsd.onmicrosoft.cn/npm/incremental-dom@0.7.0/+esm";import"https://npm.elemecdn.com/katex@0.16.7/dist/katex.min.js";import"https://jsd.onmicrosoft.cn/npm/string-replace-async@3.0.2/index.min.js";import kit from"https://jsd.onmicrosoft.cn/npm/bigonion-kit@0.12.3/esm/kit.min.js";import{M as MarkdownIt}from"./markdown-it-6b60e067.js";import{d as default_1$2}from"./markdown-it-incremental-dom-c4f66209.js";import mdItMultimdTable from"https://jsd.onmicrosoft.cn/npm/markdown-it-multimd-table@4.2.3/+esm";import markdownItGithubToc from"https://jsd.onmicrosoft.cn/npm/markdown-it-github-toc@3.2.4/src/index.js/+esm";import{full}from"https://jsd.onmicrosoft.cn/npm/markdown-it-emoji@3.0.0/+esm";import{has,emojify}from"https://jsd.onmicrosoft.cn/npm/node-emoji@2.1.3/+esm";import vconsole from"https://jsd.onmicrosoft.cn/npm/vconsole@3.15.1/+esm";import markdownitFootNote from"https://jsd.onmicrosoft.cn/npm/markdown-it-footnote@4.0.0/+esm";import html2canvas from"https://jsd.onmicrosoft.cn/npm/html2canvas@1.4.1/+esm";import{u as useSpring,a as animated}from"./@react-spring-525339cc.js";import{Q,Z}from"./react-photo-view-15a9a969.js";import{l as loader,F as Ft}from"./@monaco-editor-38e7c7a5.js";import{R as ResizableBox}from"./react-resizable-8f73e4ed.js";import{delimiters0,delimeterSizing0,greekLetters0,otherLetters0,spacing0,verticalLayout0,logicAndSetTheory0,macros0,bigOperators0,binaryOperators0,binomialCoefficients0,fractions0,mathOperators0,relations0,negatedRelations0,arrows0,font0,size0,style0,symbolsAndPunctuation0,debugging0,accents1,annotation1,verticalLayout1,overlap1,spacing1,logicAndSetTheory1,mathOperators1,sqrt1,extensibleArrows1,font1,braketNotation1,classAssignment1,verticalLayout2,binomialCoefficients2,fractions2,color2,envs}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/@cdn/functions/Monaco/snippets/latexRules.min.js";import prettier from"https://jsd.onmicrosoft.cn/npm/prettier@3.2.4/+esm";import parseMd from"https://jsd.onmicrosoft.cn/npm/prettier@3.2.4/plugins/markdown.js/+esm";import data from"https://jsd.onmicrosoft.cn/npm/@emoji-mart/data@1.1.2/+esm";import{$ as $e5534fc185f7111e$export$2e2bcd8739ae039}from"./@emoji-mart-3805b488.js";import{gsap}from"https://jsd.onmicrosoft.cn/npm/gsap@3.12.5/+esm";import"./react-3f121ed2.js";import"./@babel-f8d566ba.js";import"./clsx-0839fdbe.js";import"./@emotion-d13e5fae.js";import"./hoist-non-react-statics-3f8ebaa8.js";import"./stylis-79144faa.js";import"./react-is-e5978b8b.js";import"./react-transition-group-bc100b23.js";import"./@popperjs-f3391c26.js";import"./prop-types-7395632d.js";import"./mobx-react-lite-290ab4f8.js";import"./use-sync-external-store-b84fba6b.js";import"./mdurl-d7fdfec3.js";import"./uc.micro-78e30319.js";import"./entities-52510f6e.js";import"./linkify-it-7ae06500.js";import"./punycode.js-c41da3d1.js";import"./htmlparser2-b305cd15.js";import"./inherits-2c87d58f.js";import"./state-local-dd516420.js";import"./react-draggable-b033082a.js";import"./emoji-mart-029374f1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const React$k=window.React,ColorButton=styled(Button)(({theme:e})=>({color:e.palette.mode==="light"?"rgb(55, 65, 81)":"#FFFFFF",marginLeft:10,fontFamily:["electronicFont"].join(","),backgroundColor:e.palette.mode==="light"?"#FFFFFF":"","&:hover":{backgroundColor:e.palette.mode==="light"?grey[300]:""}}));function CustomizedButtons(e){return React$k.createElement(ColorButton,{id:"demo-customized-button",href:e.href?e.href:void 0,"aria-controls":e.open?"demo-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":e.open?"true":void 0,disableElevation:!0,onClick:e.onClick,onMouseOver:e.onHover,endIcon:e.endIcon,startIcon:e.startIcon?e.startIcon:void 0,variant:"contained"},e.children)}function getMdTextFromMonaco(){var e;if((e=window.editor)!=null&&e.getValue){let t=window.editor.getValue();return t=t.replace(/\r\n/g,`
`),t}else return"null"}function getRenderHTML(e="view-area"){let t=document.getElementById(e);if(t)return t.innerHTML}function fillInMemoryText(e){openDB("md_content",2).then(t=>{updateDB(t,"users_md",{uuid:1,contentText:e})})}async function readMemoryText(){return new Promise(e=>{openDB("md_content",2).then(t=>{cursorGetData(t,"users_md").then(n=>{e(n)})})})}function fillInMemoryImgs(e,t){openDB("md_content",2).then(n=>{for(let a=0;a<=e.length-1;a++){let o={uuid:t+a,imgBase64:e[a]};updateDB(n,"users_img",o)}})}async function readMemoryImg(e,t){return new Promise(n=>{openDB("md_content",2).then(a=>{cursorGetDataByIndex(a,"users_img",e,t).then(o=>{n(o)})})})}async function readAllMemoryImg(){return new Promise(e=>{openDB("md_content",2).then(t=>{cursorGetData(t,"users_img").then(n=>{e(n)})})})}function save(e=null,t=!0){let n=getMdTextFromMonaco();t&&n!="null"?(Message.success({style:{position:"relative",zIndex:1},content:"保存成功!",closable:!0,duration:2500,position:"top"}),fillInMemoryText(n)):save()}async function isSaved(){return await readMemoryText().then(e=>{var t;return e?((t=e[0])==null?void 0:t.contentText)===getMdTextFromMonaco():!1})}class ImageStore{constructor(t){b(this,"displayState",!1);makeAutoObservable(this,{displayState:observable}),this.displayState=t}display(){this.displayState=!0}hidden(){this.displayState=!1}}const imageStore=new ImageStore(!1),useImage=()=>imageStore,React$j=window.React,StyledMenu=styled(e=>React$j.createElement(Menu,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...e}))(({theme:e})=>({"& .MuiPaper-root":{borderRadius:6,marginTop:e.spacing(1),color:e.palette.mode==="light"?"rgb(55, 65, 81)":e.palette.grey[300],"& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:20,color:e.palette.mode==="light"?"rgb(55, 65, 81)":e.palette.grey[300],marginRight:e.spacing(1.5)}}}}));function CloudMail(e,t,n){for(var a=document.getElementById("view-area"),o=window.getComputedStyle(a),r=0;r<o.length;r++){var i=o[r];o.getPropertyValue(i)}axios({url:e,method:t,data:n,headers:{"Content-Type":"application/json"}}).then(u=>{console.log(u)})}const React$i=window.React;function Share(e){let t=React$i.useRef(),[n,a]=React$i.useState(!1),o=i=>{a(()=>!1),e.onClick(i)},r=i=>{let s=t.current.value;CloudMail("https://service-g12i7wh1-1321514649.sh.apigw.tencentcs.com/release/mail","post",{to:s,subject:"Mailed from Markdown Online+",html:`<div class="markdown-body">${getRenderHTML()}</div>`,raw:0}),o(i),Notification.success({title:"邮件发送成功！",content:"Beta版本,请勿重复尝试",position:"topRight"}),Notification.info({title:"请注意,邮件发送暂时不能完全支持mermaid和Latex",content:"Beta版本,请勿重复尝试",position:"topRight"}),e.closAll()};return React$i.createElement(React$i.Fragment,null,React$i.createElement(Dialog,{fullWidth:!0,maxWidth:"sm",open:n,onClose:o},React$i.createElement(DialogTitle,null,"神奇邮箱"),React$i.createElement(DialogContent,null,React$i.createElement(DialogContentText,null,"请输入你要发送到的邮箱",React$i.createElement("br",null)),React$i.createElement(TextField,{inputRef:t,autoFocus:!0,margin:"dense",id:"name",label:"Email Address",type:"email",fullWidth:!0,variant:"standard"})),React$i.createElement(DialogActions,null,React$i.createElement(Button,{onClick:o},"取消"),React$i.createElement(Button,{onClick:r},"发送"))),React$i.createElement(default_1,null),"分享(开发中)",React$i.createElement(StyledMenu,{style:{width:"fitContent"},anchorOrigin:{vertical:-5,horizontal:12},id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:e.anchorEl,open:e.open,onClick:e.onClick},React$i.createElement(MenuItem,{onClick:i=>{i.stopPropagation(),a(!0)},disableRipple:!0},React$i.createElement(default_1$1,null),"邮箱分享")))}class operateLocalStorage{constructor(){b(this,"version","0.1")}setItem(t,n){localStorage.setItem(t,n)}getItem(t){return localStorage.getItem(t)?localStorage.getItem(t):""}removeItem(t){localStorage.removeItem(t)}}let welcomeText;function blankTextInit(){return new Promise(e=>{readMemoryText().then(t=>{t.length&&t[0].contentText?(window.editor.setValue(t[0].contentText),e()):(fetch("https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/source/assets/welcome.md").then(n=>n.text()).then(n=>{welcomeText=n,window.editor.setValue(welcomeText)}).catch(n=>{console.error("Error fetching markdown:",n)}),e())})})}function PageBreaker(e){let t=/\|---\|/g;return e=e.replace(t,()=>'<div style="page-break-after: always;"></div>'),e}const index="";async function prepareParser(e){async function t(c){let l=c.attrGet("src");if(l.startsWith("/vf/")){let m=l.match(/\d+/)[0];return await readMemoryImg("uuid",parseInt(m)).then(f=>f[0].imgBase64)}}async function n(c){let l=c.content,m;try{return await mermaid.parse(l,{suppressErrors:!1}),await mermaid.parse(l,{suppressErrors:!0})&&(m=await mermaid.render(`_mermaidSvg_${kit.getUUID().slice(0,5)}`,l)),m.svg}catch(f){return`<pre class="ERR">${f}</pre>`}}let a=[],o=[],r=[],i=[],s=markdownParser();s.renderer.rules.image=function(c,l){var m;return(m=c[l].attrGet("src"))!=null&&m.startsWith("/vf/")&&a.push(c[l]),""},s.renderer.rules.fence=function(c,l,m,f,h){return c[l].info==="mermaid"&&o.push(c[l]),""},s.render(e,{});for(const c of a){let l=await t(c);r.push(l)}for(const c of o){let l=await n(c);i.push(l)}return{vfImgSrcArr:r,vfImgSeq:0,mermaidParsedArr:i,mermaidSeq:0}}async function mdConverter(e=!0){let t=getMdTextFromMonaco();t=PageBreaker(t);let n=await prepareParser(t);IncrementalDOM.patch(document.getElementById("view-area"),markdownParser().renderToIncrementalDOM(t,n)),hljs.highlightAll()}const regs={markHighlight:/@@(.*?)@@/,emoji:/^:([a-zA-Z0-9_\+\-]+):/},newTokenizer={heading(e){return e.match(/^#{1,6}\s.*/),!1},codespan(e){return e.match(/^\&+([^\&\n]+?)\&+/),!1}},newRenderer={paragraph(e){return`<p class="line-hilight">${e}</p>`},heading(e,t){return`
            <h${t}  class="line-hilight">
              <a href="#">
                <span class="header-link"></span>
              </a>
              ${e}
            </h${t}>`},code(code,lang,_escaped){let finalCodeBlock;return lang=="js-run"?(new vconsole,`${eval(code)}`):(hljs.getLanguage(lang)?finalCodeBlock=`<pre><code class="language-${lang} ">${code}</code></pre>`:lang=="mermaid"?finalCodeBlock=`<div class="language-mermaid language-plaintext">${code}</div>`:finalCodeBlock=`<pre><code class="language-plaintext">${code}</code></pre>`,finalCodeBlock)},image(e,t,n){const a="#";let o=Math.random(),r="auto",i="",s="L",u=n.split(a);if(u.length>1)for(let c=0;c<u.length;c++){let l=u[c];l==="s"&&(i+="box-shadow: rgb(199 199 199) 1vh 2vh 21px"),l==="s1"&&(i+="box-shadow: rgb(146 146 146) 1vh 2vh 21px;"),l==="s2"&&(i+="box-shadow: rgb(32 32 32 / 86%) 1vh 2vh 21px"),(l==="C"||l=="c")&&(s="C"),(l==="R"||l=="r")&&(s="R"),l.startsWith("w")&&(r=u[c].substring(1),r.endsWith("%")||(r+="px"))}return`<div class="imgBox-r FLEX ${o} ${s=="C"?" JUS-CENTER":s=="R"?"JUS-RIGHT":""}" ><img class="img_resize_transition" width="${r}" style="${i}" src="${e}" alt="${n}"></div>`}},importUrlExtension={extensions:[{name:"importUrl",level:"block",start(e){return e.indexOf(`
:`)},tokenizer(e){const n=/^:(https?:\/\/.+?):/.exec(e);if(n)return{type:"importUrl",raw:n[0],url:n[1],html:""}},renderer(e){return`<iframe style="border:none" src="${e.url}" width="100%" height="100%"></iframe>`}}]},markItExtension={extensions:[{name:"markIt",level:"inline",start(e){var t;return(t=e.match(/@@/))==null?void 0:t.index},tokenizer(e,t){const n=e.match(regs.markHighlight),a=n?n[1]:"";if(n)return{type:"markIt",raw:e,text:a}},renderer(e){return`${e.raw.replace(regs.markHighlight,`<mark>${e.text}</mark>`)}`}}]},imgExtension={name:"newRenderer",level:"block",tokenizer:newTokenizer,renderer:newRenderer,async:!0,async walkTokens(e){if(e.type,e.type==="image"){const t=e.href;if(t!=null&&t.match(/vf/)){let n=(t.match(/vf\/(\d+)/)?t.match(/vf\/(\d+)/)[1]:0).toString(),a=await readMemoryImg("uuid",parseInt(n)).then(o=>o[0]?o[0].imgBase64:0);e.href=a}}else e.type==="code"||e.type}},emojiExtension={extensions:[{name:"emoji",level:"inline",start(e){var t;return(t=e.match(/:/))==null?void 0:t.index},tokenizer(e,t){const n=e.match(regs.emoji);return n?{type:"emoji",raw:n[0],text:n[1]}:!1},renderer(e){return has(e.raw)?emojify(e.raw):e.raw}}]};class ConfigStore{constructor({themeState:t,emojiPickerState:n,contextMenuClickPosition:a,settingsConfig:o}){b(this,"themeState");b(this,"emojiPickerState");b(this,"contextMenuClickPosition");b(this,"settingsConfig");makeAutoObservable(this,{themeState:observable,emojiPickerState:observable,contextMenuClickPosition:observable,settingsConfig:observable}),this.themeState=t,this.emojiPickerState=n,this.contextMenuClickPosition=a,this.settingsConfig=o}getAllConfig(){let t={};return Object.getOwnPropertyNames(this).forEach((n,a)=>{t[n]=this[n]}),t}}function markdownitLineNumber(e,t){const n=function(a,o,r,i,s){let u;return a[o].map&&a[o].level===0&&(u=a[o].map[0],a[o].attrSet("data-line",String(u))),s.renderToken(a,o,r)};e.renderer.rules.paragraph_open=e.renderer.rules.heading_open=e.renderer.rules.table_open=n}let myPlugin=function(e){e.core.ruler.before("inline","myrule",function(t){var n=t.tokens;for(let a=0;a<n.length;a++)n[a].content&&n[a].content.indexOf("MYRULE")})},imagePlugin=function(e){e.renderer.rules.image,e.renderer.rules.image=function(t,n,a,o,r){var R;const i=t[n],s="#";let u=i.attrs[i.attrIndex("src")][1],c=i.content;i&&((R=i.attrGet("src"))!=null&&R.startsWith("/vf/"))&&o.vfImgSrcArr&&(u=o.vfImgSrcArr[o.vfImgSeq++]);let l="auto",m="",f="L",h=c.split(s);if(h.length>1)for(let d=0;d<h.length;d++){let g=h[d];g==="s"&&(m+="box-shadow: rgb(199 199 199) 1vh 2vh 21px"),g==="s1"&&(m+="box-shadow: rgb(146 146 146) 1vh 2vh 21px;"),g==="s2"&&(m+="box-shadow: rgb(32 32 32 / 86%) 1vh 2vh 21px"),(g==="C"||g=="c")&&(f="C"),(g==="R"||g=="r")&&(f="R"),g.startsWith("w")&&(l=h[d].substring(1),l.endsWith("%")||(l+="px"))}return`<div class="imgBox-r FLEX  ${f=="C"?" JUS-CENTER":f=="R"?"JUS-RIGHT":""}" ><img class="img_resize_transition" width="${l}" style="${m}" src="${u}" alt="${c}">
    </div>`}},codePlugin=function(e){const t=e.renderer.rules.code_block;e.renderer.rules.fence=function(n,a,o,r,i){let s;n[a].map&&n[a].level===0&&(s=n[a].map[0],n[a].attrSet("data-line",String(s)));let u=n[a].info,c=n[a].content;if(u==="mermaid"){if(r.mermaidParsedArr)return`<div data-line="${s}" class="language-mermaid language-plaintext">
        ${r.mermaidParsedArr[r.mermaidSeq++]}
        </div>`}else return hljs.getLanguage(u)?`<pre data-line="${s}"><code class="language-${u} ${getTheme()==="light"?"":"hljs-dark"}">${c}</code></pre>`:`<div class="code-container" data-line="${s}">
      <pre><code class="language-plaintext">${c}</code></pre>
    </div>`;return t(n,a,o,r,i)}},cluePlugin=function(e){function t(n){const a=n.tokens;for(let o=0;o<a.length;o++)if(a[o].type==="inline"){let r=a[o].children;for(let i=0;i<r.length;i++){const s=r[i];if(s.type==="text"&&s.content){const c=s.content.match(/\^(.*?)\^(.*?)\#$/);if(c){const l=new n.Token("html_block","",0);l.content=`<div class="${c[2]}">${e.render(c[1])}</div>`,r[i]=l,i++}}}}}e.core.ruler.push("my_rule1",t),e.inline.ruler.before("emphasis","mark",(n,a)=>!1)};function preViewClickEvent(e,t,n=e.createDecorationsCollection()){document.getElementById("view-area").addEventListener("dblclick",function(a){let o=a.target,r=0;if(o!==this){for(;o;){if(o.hasAttribute("data-line")){r=parseInt(o.getAttribute("data-line"));break}o=o.parentElement}r&&(window.editor.setPosition({lineNumber:r+1,column:1}),window.editor.revealLineInCenter(r+1),n.clear(),n.set([{range:new t.Range(r+1,1,r+1,1),options:{isWholeLine:!0,className:"HILIGHT-MONACO",zIndex:0}}]))}})}const katex=window.katex;function isValidDelim(e,t){var n,a,o=e.posMax,r=!0,i=!0;return n=t>0?e.src.charCodeAt(t-1):-1,a=t+1<=o?e.src.charCodeAt(t+1):-1,(n===32||n===9||a>=48&&a<=57)&&(i=!1),(a===32||a===9)&&(r=!1),{can_open:r,can_close:i}}function math_inline(e,t){var n,a,o,r,i;if(e.src[e.pos]!=="$")return!1;if(r=isValidDelim(e,e.pos),!r.can_open)return t||(e.pending+="$"),e.pos+=1,!0;for(n=e.pos+1,a=n;(a=e.src.indexOf("$",a))!==-1;){for(i=a-1;e.src[i]==="\\";)i-=1;if((a-i)%2==1)break;a+=1}return a===-1?(t||(e.pending+="$"),e.pos=n,!0):a-n===0||a-n===2?(t||(e.pending+="$$"),e.pos=n+1,!0):(r=isValidDelim(e,a),r.can_close?(t||(o=e.push("math_inline","math",0),o.markup="$",o.content=e.src.slice(n,a)),e.pos=a+1,!0):(t||(e.pending+="$"),e.pos=n,!0))}function math_block(e,t,n,a){var o,r,i,s,u=!1,c,l=e.bMarks[t]+e.tShift[t],m=e.eMarks[t];if(l+2>m||e.src.slice(l,l+2)!=="$$")return!1;if(l+=2,o=e.src.slice(l,m),a)return!0;for(o.trim().slice(-2)==="$$"&&(o=o.trim().slice(0,-2),u=!0),i=t;!u&&(i++,!(i>=n||(l=e.bMarks[i]+e.tShift[i],m=e.eMarks[i],l<m&&e.tShift[i]<e.blkIndent)));)e.src.slice(l,m).trim().slice(-2)==="$$"&&(s=e.src.slice(0,m).lastIndexOf("$$"),r=e.src.slice(l,s),u=!0);return e.line=i+1,c=e.push("math_block","math",0),c.block=!0,c.content=(o&&o.trim()?o+`
`:"")+e.getLines(t+1,i,e.tShift[t],!0)+(r&&r.trim()?r:""),c.map=[t,e.line],c.markup="$$",!0}function markdownItLatex(e,t){t=t||{throwOnError:!1,strict:!1};var n=function(i){if(t.displayMode=!1,i)try{return katex.renderToString(i,t)}catch{return i}else return"Latex Missing"},a=function(i,s){return n(i[s].content)},o=function(i,s){t.displayMode=!0;let u;if(s.map&&s.level===0&&(u=s.map[0]),i)try{return`<p data-line=${String(u)}>`+katex.renderToString(i,t)+"</p>"}catch{return i}else return"LATEX MISSING"},r=function(i,s){return o(i[s].content,i[s])+`
`};e.inline.ruler.after("escape","math_inline",math_inline),e.block.ruler.after("blockquote","math_block",math_block,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=a,e.renderer.rules.math_block=r}function markdownParser(){return MarkdownIt({html:!0,linkify:!0,typographer:!0,breaks:!0}).use(markdownitLineNumber).use(myPlugin).use(imagePlugin).use(mdItMultimdTable,{multiline:!0,rowspan:!0,headerless:!0,multibody:!0,aotolabel:!0}).use(codePlugin).use(cluePlugin).use(markdownitFootNote).use(markdownItGithubToc,{anchorLinkSymbol:""}).use(full).use(markdownItLatex).use(default_1$2,IncrementalDOM)}class settingsClass{constructor(){}markedInit(){marked.use({mangle:!1,headerIds:!1,strict:!1,extensions:[],async:!0,lineNumber:!0},importUrlExtension,imgExtension,markItExtension,emojiExtension)}mermaidInit(){mermaid.parseError=t=>{},mermaid.initialize({securityLevel:"loose",logLevel:4,startOnLoad:!1,theme:"base"}),mermaid.mermaidAPI.initialize({startOnLoad:!1})}hljsInit(){hljs.configure({ignoreUnescapedHTML:!0})}settingsAllInit(){this.markedInit(),this.mermaidInit(),this.hljsInit()}static newSettings(){return new this}}function allInit(e=window.editor,t=window.monaco){new settingsClass().settingsAllInit(),blankTextInit().then(()=>{mdConverter(),kit.sleep(110).then(()=>{Notification.success({title:"已更新到最新版本",content:"当前版本:v2.1.1",position:"bottomRight"}),kit.sleep(780).then(()=>{Notification.info({title:"版本新增特性",content:"1. 修复溢出滚动条bug 2.新增语音识别",position:"bottomRight"})})})}),window.deco=e.createDecorationsCollection(),preViewClickEvent(e,t,window.deco),window._speechData={processing:!1,speechResult:"",speech:null}}const defaultConfig={themeState:"light",emojiPickerState:"off",contextMenuClickPosition:{posx:20,posy:20},settingsConfig:{basic:{syncScroll:!0,speechLanguage:"zh-CN"},advanced:{}}};function configInit(e){function t(o){typeof n[o]=="object"?a.setItem(o,JSON.stringify(n[o])):a.setItem(o,n[o])}let n=e,a=new operateLocalStorage;for(let o in n)if(a.getItem(o))if(o=="themeState"||o=="emojiPickerState"||o=="settingsConfig")try{typeof n[o]=="object"?n[o]=JSON.parse(a.getItem(o).toString()):n[o]=a.getItem(o).toString()}catch{t(o)}else t(o);else t(o);return n}const configStore=new ConfigStore(configInit(defaultConfig)),useConfig=()=>configStore;let opLocalStorage=new operateLocalStorage;function changeTheme(e){e=="light"?(useConfig().themeState="light",opLocalStorage.setItem("themeState","light")):(useConfig().themeState="dark",opLocalStorage.setItem("themeState","dark"))}function getTheme(){return useConfig().themeState}function changeEmojiPickerState(e){e=="on"?(useConfig().emojiPickerState="on",opLocalStorage.setItem("emojiPickerState","on")):(useConfig().emojiPickerState="off",opLocalStorage.setItem("emojiPickerState","off"))}function getEmojiPickerState(){return useConfig().emojiPickerState}function setContextMenuClickPosition(e){if(e.posx&&e.posy)useConfig().contextMenuClickPosition=e;else return!1}function getContextMenuClickPosition(){return useConfig().contextMenuClickPosition}function changeSettings(e){const t=getSettings(),n=updateSettingsConfig(t,e);useConfig().settingsConfig=n,opLocalStorage.setItem("settingsConfig",JSON.stringify(n))}function getSettings(){return toJS(useConfig().settingsConfig)}function updateSettingsConfig(e,t){for(const n in t)n in e?Object.assign(e[n],t[n]):e[n]=t[n];return e}function exportAsImage(e=3,t="markdown.jpeg"){let n=document.getElementById("view-area").innerHTML;window.document.body.innerHTML=`<div id="exportBox" style="width:64vw" class="markdown-body markdown-body-${getTheme()==="light"?"light":"dark"}">${n}</div>`,kit.sleep(250).then(()=>{html2canvas(document.getElementById("exportBox"),{scale:e}).then(a=>{let o=a.toDataURL("image/png",.6);var r=document.createElement("a");r.download=t,r.href=o,r.click()}),kit.sleep(2e3).then(()=>{window.location.reload()})})}function exportAsMd(){let e=getMdTextFromMonaco()??"";kit.sleep(250).then(()=>{var t=document.createElement("a");t.href="data:text/plain;charset=utf-8,"+encodeURIComponent(e),t.download="text.md",t.click()})}function myPrint(){let e=document.getElementById("view-area").innerHTML;window.document.body.style.background=getTheme()==="light"?"":"#0D1117",window.document.body.innerHTML=`<div class="markdown-body markdown-body-${getTheme()==="light"?"light":"dark"}">${e}</div>`,kit.sleep(250).then(()=>{window.print(),location.reload()})}const React$h=window.React;function Export(e){let t=e.closeExportMenu;e.closeMenu;let[n,a]=React$h.useState(!1),o=l=>{console.log(l),t(l),a(()=>!1)},r=React$h.useRef();const[i,s]=React$h.useState(3),u=l=>{l.stopPropagation(),s(l.target.value)};let c=l=>{o(l);let m=r.current.value;exportAsImage(i??4,m??"md_snapshot.png"),e.closeMenu(l),Notification.success({title:"导出成功！",content:"Beta版本,请勿重复尝试",position:"topRight"})};return React$h.createElement(React$h.Fragment,null,React$h.createElement(Dialog,{className:"avoid",onClose:o,open:n,fullWidth:!0,maxWidth:"sm"},React$h.createElement("div",{onClick:l=>{l.stopPropagation()}},React$h.createElement(DialogTitle,null,"导出设置"),React$h.createElement(DialogContent,null,React$h.createElement(DialogContentText,null,"请选择图片清晰度"),React$h.createElement("br",null),React$h.createElement(FormControl,{fullWidth:!0},React$h.createElement(Box$1,null,React$h.createElement(InputLabel,{id:"demo-simple-select-label"},"图片清晰度"),React$h.createElement(Select,{label:"图片清晰度",defaultValue:"4",defaultChecked:!0,fullWidth:!0,onChange:u},React$h.createElement(MenuItem,{value:"1"},"1 (比较模糊,体积轻巧)"),React$h.createElement(MenuItem,{value:"2"},"2 (有些模糊)"),React$h.createElement(MenuItem,{value:"4"},"3 (默认,适中,推荐)"),React$h.createElement(MenuItem,{value:"6"},"4 (比较清晰,体积稍大)"),React$h.createElement(MenuItem,{value:"10"},"5 (超鸡无敌霹雳霸清晰,体积较大)"))),React$h.createElement(Box$1,{marginX:"8px"},React$h.createElement(TextField,{inputRef:r,margin:"dense",id:"export_img_name",defaultValue:"md_snapshot.png",label:"导出的文件名",type:"text",fullWidth:!0,variant:"standard",placeholder:"md_snapshot.png"})))),React$h.createElement(DialogActions,null,React$h.createElement(Button,{onClick:o},"取消"),React$h.createElement(Button,{onClick:c},"确认导出")))),React$h.createElement(default_1$3,null),"导出",React$h.createElement(StyledMenu,{style:{width:"fitContent"},anchorOrigin:{vertical:-5,horizontal:12},id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:e.anchorEl,open:e.open,onClick:l=>{t(l)}},React$h.createElement(MenuItem,{onClick:()=>{myPrint()},disableRipple:!0},React$h.createElement(default_1$4,null),"导出为PDF"),React$h.createElement(MenuItem,{onClick:l=>{a(!0),t(l)},disableRipple:!0},React$h.createElement(default_1$5,null),"导出为图片(Beta1.0)"),React$h.createElement(MenuItem,{onClick:()=>{exportAsMd()},disableRipple:!0},React$h.createElement(default_1$6,null),"导出为Markdown")))}const React$g=window.React;function TransitionComponent(e){const t=useSpring({to:{opacity:e.in?1:0,transform:`translate3d(${e.in?0:20}px,0,0)`}});return React$g.createElement(animated.div,{style:t},React$g.createElement(Collapse,{...e}))}const StyledTreeItem=styled(TreeItem)(({theme:e})=>({color:e.palette.mode==="light"?e.palette.grey[800]:e.palette.grey[200],[`& .${treeItemClasses.content}`]:{borderRadius:e.spacing(.5),padding:e.spacing(.5,1),margin:e.spacing(.2,0),[`& .${treeItemClasses.label}`]:{fontSize:"0.89rem",fontWeight:500}},[`& .${treeItemClasses.iconContainer}`]:{borderRadius:"80%",backgroundColor:e.palette.mode==="light"?alpha(e.palette.primary.main,.45):e.palette.primary.dark,color:e.palette.mode==="dark"&&e.palette.primary.contrastText,padding:e.spacing(0,1.2)}})),CustomTreeItem=React$g.forwardRef((e,t)=>React$g.createElement(StyledTreeItem,{...e,slots:{groupTransition:TransitionComponent,...e.slots},ref:t}));function SettingsRoute(){return React$g.createElement(React$g.Fragment,null,React$g.createElement(Box$1,{className:"transparent-scrollbar",sx:{overflow:"scroll",flex:"0 0 30%",minHeight:20,overflowX:"hidden",borderRight:"solid rgba(0, 0, 0, 0.12)"}},React$g.createElement(SimpleTreeView,{"aria-label":"customized",defaultExpandedItems:["1_x"],slots:{endIcon:default_1$7},sx:{userSelect:"none",minHeight:270,maxWidth:300}},React$g.createElement(CustomTreeItem,{slots:{endIcon:default_1$8},onClick:()=>{document.getElementById("settings_1_x").scrollIntoView()},itemId:"1_x",label:"基础设置"},React$g.createElement(CustomTreeItem,{slots:{endIcon:default_1$9},onClick:()=>{document.getElementById("settings_1_1").scrollIntoView()},itemId:"1_2",label:"主题设置"}),React$g.createElement(CustomTreeItem,{slots:{endIcon:default_1$8},onClick:()=>{document.getElementById("settings_1_2").scrollIntoView()},itemId:"1_3",label:"编辑器设置"})),React$g.createElement(CustomTreeItem,{itemId:"2_x",label:"高级设置"},React$g.createElement(CustomTreeItem,{itemId:"2_2",label:"导出设置"}),React$g.createElement(CustomTreeItem,{itemId:"2_3",label:"Mermaid设置"})))))}const React$f=window.React;function handleClick(e){e.preventDefault()}function IconBreadcrumbs(){return React$f.createElement(Box$1,{sx:{marginBottom:"5px"},role:"presentation",onClick:handleClick},React$f.createElement(Breadcrumbs,{"aria-label":"breadcrumb"},React$f.createElement(Link,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/"},React$f.createElement(default_1$a,{sx:{mr:.5},fontSize:"inherit"}),"MUI"),React$f.createElement(Link,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/material-ui/getting-started/installation/"},React$f.createElement(default_1$b,{sx:{mr:.5},fontSize:"inherit"}),"Core"),React$f.createElement(Typography,{sx:{display:"flex",alignItems:"center"},color:"text.primary"},React$f.createElement(default_1$c,{sx:{mr:.5},fontSize:"inherit"}),"Breadcrumb")))}let MaterialUISwitch=styled(Switch)(({theme:e})=>({width:62,height:34,padding:7,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(22px)","& .MuiSwitch-thumb:before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M4.2 2.5l-.7 1.8-1.8.7 1.8.7.7 1.8.6-1.8L6.7 5l-1.9-.7-.6-1.8zm15 8.3a6.7 6.7 0 11-6.6-6.6 5.8 5.8 0 006.6 6.6z"/></svg>')`},"& + .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be"}}},"& .MuiSwitch-thumb":{backgroundColor:e.palette.mode==="dark"?"#003892":"#001e3c",width:32,height:32,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M9.305 1.667V3.75h1.389V1.667h-1.39zm-4.707 1.95l-.982.982L5.09 6.072l.982-.982-1.473-1.473zm10.802 0L13.927 5.09l.982.982 1.473-1.473-.982-.982zM10 5.139a4.872 4.872 0 00-4.862 4.86A4.872 4.872 0 0010 14.862 4.872 4.872 0 0014.86 10 4.872 4.872 0 0010 5.139zm0 1.389A3.462 3.462 0 0113.471 10a3.462 3.462 0 01-3.473 3.472A3.462 3.462 0 016.527 10 3.462 3.462 0 0110 6.528zM1.665 9.305v1.39h2.083v-1.39H1.666zm14.583 0v1.39h2.084v-1.39h-2.084zM5.09 13.928L3.616 15.4l.982.982 1.473-1.473-.982-.982zm9.82 0l-.982.982 1.473 1.473.982-.982-1.473-1.473zM9.305 16.25v2.083h1.389V16.25h-1.39z"/></svg>')`}},"& .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be",borderRadius:20/2}}));const React$e=window.React,IOSSwitch=styled(e=>React$e.createElement(Switch,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...e}))(({theme:e})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:e.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:e.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:e.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:e.transitions.create(["background-color"],{duration:500})}}));let speechRecognition=(e,t=!0,n)=>{const a=new webkitSpeechRecognition||new SpeechRecognition;let o=!1;return a.lang=e,a.continuous=!0,a.interimResults=!1,t&&a.start(),a.onstart=()=>{o=!0},a.onresult=r=>{let i=r.results[r.results.length-1][0].transcript;console.log(i,i.length),window._speechData.speechResult=i,n(i.length),o===!1&&a.stopRecognition()},a.onerror=r=>{console.error(r.error)},a.onend=()=>{console.log(o),o&&a.start()},a.stopRecognition=()=>{a.stop(),o=!1},{recognition:a,recognizing:o}};const speechLanguageMap={1:["zh-CN","普通话"],2:["en-US","English"],3:["ja-JP","日本語"]},React$d=window.React,SettingsBody=observer(function e(){const t=getTheme(),n={transition:"0.3s",position:"relative",padding:"5px",borderRadius:"3px",display:"flex",flexDirection:"column",mt:"10px",mb:"5px",ml:"0px",pl:"25px","&::before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:4,backgroundColor:"transparent",transition:"background-color 0.3s"},"&:hover::before":{backgroundColor:t==="light"?"#840084":"#d2d2d2"},"&:hover":{backgroundColor:t==="light"?"#E7E6E5":""}},a={color:"#8B8A8A",fontSize:"0.79rem",fontWeight:500,mb:"5px"},[o,r]=React$d.useState(!1);function i(c,l){const m=document.querySelector(".markdown-body");l?(changeTheme("dark"),r(c.target.checked),console.log(m.style.cssText),m.style.cssText=""):(changeTheme("light"),r(c.target.checked),console.log(m.style.cssText))}function s(c,l){changeSettings(l?{basic:{syncScroll:!0}}:{basic:{syncScroll:!1}})}function u(c){changeSettings({basic:{speechLanguage:c.target.value}})}return React$d.useEffect(()=>{r(getTheme()==="dark")},[getTheme()]),React$d.createElement(React$d.Fragment,null,React$d.createElement(Box$1,{className:"transparent-scrollbar",sx:{width:"100%",padding:"1rem",display:"flex",flexDirection:"column",fontSize:"0.89rem",maxHight:"200px",overflowY:"scroll"}},React$d.createElement(Typography,{id:"settings_1_x",sx:{fontSize:"30px",fontWeight:"700"}},"基础设置"),React$d.createElement(Divider,null),React$d.createElement(Box$1,{sx:n},React$d.createElement(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500}},"Theme"),React$d.createElement(Typography,{sx:a},"更改编辑器的主题"),React$d.createElement(MaterialUISwitch,{checked:o,size:"small",inputProps:{"aria-label":"controlled"},onChange:i})),React$d.createElement(Box$1,{sx:n},React$d.createElement(Typography,{id:"settings_1_2",sx:{fontSize:"0.89rem",fontWeight:500}},"Synchronous Scrolling"),React$d.createElement(Typography,{sx:a},"同步滚动左边编辑区和预览区域。(开发中)"),React$d.createElement(IOSSwitch,{checked:getSettings().basic.syncScroll,size:"small",inputProps:{"aria-label":"controlled"},onChange:s})),React$d.createElement(Box$1,{sx:n},React$d.createElement(Typography,{sx:{fontSize:"0.89rem",fontWeight:500}},"Speech To Text"),React$d.createElement(Typography,{sx:a},"选择语音转文字的识别语言"),React$d.createElement(Select,{value:getSettings().basic.speechLanguage??"zh-CN",defaultChecked:!0,fullWidth:!0,size:"small",onChange:u},React$d.createElement(MenuItem,{value:speechLanguageMap[1][0]},speechLanguageMap[1][1]),React$d.createElement(MenuItem,{value:speechLanguageMap[2][0]},speechLanguageMap[2][1]),React$d.createElement(MenuItem,{value:speechLanguageMap[3][0]},speechLanguageMap[3][1]))),React$d.createElement(Typography,{id:"settings_1_x",sx:{mt:"20px",fontSize:"30px",fontWeight:"700"}},"高级设置（施工中）"),React$d.createElement(Divider,null),React$d.createElement(Box$1,{sx:n},React$d.createElement(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500}},"Export Settings"),React$d.createElement(Typography,{sx:a},"更改导出设置(施工中)"),React$d.createElement(IOSSwitch,{disabled:!0,size:"small",inputProps:{"aria-label":"controlled"}})),React$d.createElement(Box$1,{sx:n},React$d.createElement(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500}},"Mermaid Configs"),React$d.createElement(Typography,{sx:a},"更改Mermaid流程图的设置(施工中)"),React$d.createElement(IOSSwitch,{disabled:!0,size:"small",inputProps:{"aria-label":"controlled"}}))))}),React$c=window.React;function Settings(e){useTheme().palette;const t=getTheme();React$c.useRef();let[n,a]=React$c.useState(!1);React$c.useState("");let o=r=>{a(()=>!1),e.onClick(r),e.closeAll()};return React$c.useEffect(()=>{}),React$c.createElement(React$c.Fragment,null,React$c.createElement(Dialog,{fullScreen:!1,maxWidth:!1,open:e.open,onClose:o,sx:{height:"100vh"}},React$c.createElement(Box$1,{sx:{background:t==="light"?"#F8FAFB":"",padding:"1rem",height:"58vh",width:"60vw"}},React$c.createElement(IconBreadcrumbs,null),React$c.createElement(Divider,{sx:{my:.5}}),React$c.createElement(Box$1,{sx:{height:"48vh",display:"flex",background:t==="light"?"#F8FAFB":"",padding:"5px",flexDirection:"row",borderRradius:"50px",borderRadius:"5px"}},React$c.createElement(SettingsRoute,null),React$c.createElement(SettingsBody,null)))),React$c.createElement(default_1$7,null),"设置")}const React$b=window.React,CustomizedMenus=observer(()=>{const e=useImage(),[t,n]=React$b.useState(null),[a,o]=React$b.useState(null),[r,i]=React$b.useState(null),[s,u]=React$b.useState(null),[c,l]=React$b.useState(!1),m=!!t,f=!!a,h=!!r,R=!!s,d=p=>{n(p.currentTarget)},g=p=>{o(p.currentTarget),p.stopPropagation()},x=async p=>{await isSaved()?(i(p.target),p.stopPropagation()):(p.stopPropagation(),$(),l(!0))},w=p=>{u(p.currentTarget)},$=()=>{n(null)},y=p=>{o(null),p.stopPropagation()},E=p=>{i(null),p.stopPropagation()},k=p=>{u(null),p.stopPropagation()},v=()=>{e.display(),$()};return React$b.createElement("div",null,React$b.createElement(Dialog,{open:c,onClose:()=>{l(!1)}},React$b.createElement(DialogTitle,null,React$b.createElement(Typography,{variant:"h6",gutterBottom:!0},"Ready To Export? You Have Not Saved Yet!")),React$b.createElement(DialogContent,null,React$b.createElement(DialogContentText,null,React$b.createElement(Typography,{variant:"body1",gutterBottom:!0},'Once you have clicked the "yes" button, your text will be saved.'))),React$b.createElement(DialogActions,null,React$b.createElement(Button,{onClick:()=>{l(!1),save(),myPrint()}},"YES"),React$b.createElement(Button,{onClick:()=>{l(!1)},autoFocus:!0},"NO"))),React$b.createElement(CustomizedButtons,{open:m,endIcon:React$b.createElement(default_1$d,null),onClick:d},"更多"),React$b.createElement(StyledMenu,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:t,open:m,onClose:$},React$b.createElement(MenuItem,{onClick:v,disableRipple:!0},React$b.createElement(default_1$8,null),"图片管理器"),React$b.createElement(MenuItem,{onClick:p=>{x(p)},disableRipple:!0},React$b.createElement(Export,{anchorEl:r,open:h,closeMenu:$,closeExportMenu:E})),React$b.createElement(Divider,{sx:{my:.5}}),React$b.createElement(MenuItem,{onClick:p=>{g(p)},disableRipple:!0},React$b.createElement(Share,{closAll:$,anchorEl:a,open:f,onClick:y})),React$b.createElement(MenuItem,{onClick:p=>{w(p)},disableRipple:!0},React$b.createElement(Settings,{closeAll:$,anchorEl:s,open:R,onClick:k})),React$b.createElement(MenuItem,{onClick:()=>{$()},disableRipple:!0},React$b.createElement(default_1$e,null),"更多(敬请期待)")))});function getSelectionText(e=window.editor){const t=e??window.editor;var n=t.getSelection(),a=n.startLineNumber,o=n.startColumn,r=n.endLineNumber,i=n.endColumn,s=t.getModel().getValueInRange({startLineNumber:a,startColumn:o,endLineNumber:r,endColumn:i});return s}function selectionIsNull(e=window.editor){const n=(e??window.editor).getSelection();return n.startLineNumber==n.endLineNumber&&n.startColumn==n.endColumn}function insertTextMonacoAtCursor(e,t,n=window.editor,a=window.monaco){const o=window.editor,r=e,i=window.editor.getSelections()[0];o.executeEdits("img-insert",[{range:new window.monaco.Range(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn),text:r,forceMoveMarkers:t}])}function insertQuotationInMonaco(e=window.editor){const t=e??window.editor,n=t.getSelection();if(!selectionIsNull()&&!getSelectionText(e)[0].match(/["']/)){t.executeEdits("my-insert-quotation-double",[{range:new window.monaco.Range(n.startLineNumber,n.startColumn,n.startLineNumber,n.startColumn),text:'"',forceMoveMarkers:!1},{range:new window.monaco.Range(n.endLineNumber,n.endColumn,n.endLineNumber,n.endColumn),text:'"',forceMoveMarkers:!1}]);let a={startLineNumber:n.startLineNumber,startColumn:n.startColumn+1,endLineNumber:n.endLineNumber,endColumn:n.endColumn+1};t.setSelection(a)}else selectionIsNull()?t.executeEdits("my-insert-quotation-single",[{range:new window.monaco.Range(n.startLineNumber,n.startColumn,n.startLineNumber,n.startColumn),text:'"',forceMoveMarkers:!0}]):t.executeEdits("my-insert-quotation-single2",[{range:new window.monaco.Range(n.startLineNumber,n.startColumn+1,n.startLineNumber,n.startColumn),text:'"',forceMoveMarkers:!0}])}function writeClipboard(e){navigator.clipboard.writeText(e).catch(t=>{console.error("Failed to copy text: ",t)})}const React$a=window.React,_MagicImg=React$a.forwardRef(MagicImg);function MagicImg(e,t){let n="FLEX JUS-CENTER ",a={width:"fitContent"};const[o,r]=React$a.useState(!1);function i(c){c.altKey&&writeClipboard(`![我是图片](/vf/${e.uuid})`),c.ctrlKey&&insertTextMonacoAtCursor(`![我是图片](/vf/${e.uuid})`,!0)}let[s,u]=React$a.useState({src:e.src,uuid:e.uuid,magic:e.magic!=0,className:n+(e.className??""),style:e.style?{...e.style,...a}:a});return React$a.createElement(React$a.Fragment,null,React$a.createElement("div",{...s,...e,ref:t,className:s.className,style:s.style},React$a.createElement(Q,null,React$a.createElement(Z,{triggers:["onDoubleClick"],src:s.src},React$a.createElement(Tooltip,{placement:"right",TransitionComponent:Zoom,arrow:!0,title:"按住Ctrl点击插入"},React$a.createElement("img",{onMouseEnter:()=>{r(!0)},onMouseLeave:()=>{r(!1)},onClick:c=>{i(c)},style:{width:"70%",transition:" 0.2s ease-in-out",borderRadius:"5px",transform:o?"translate(0px, -2px)":"",boxShadow:o?"1vh 2vh 21px rgb(79 79 79)":"rgb(216 216 216) 1vh 2vh 21px"},src:s.src,alt:"error"}))))))}const React$9=window.React;function LR(e){const t=React$9.Children.toArray(e.children).length;let n="LR ",a={display:"flex",flexDirection:"row",justifyContent:e.jus??"center",alignItems:e.ali??"center",width:"100%",height:"100%"},[o,r]=React$9.useState({style:e.style?{...e.style,...a}:a,className:n+(e.className??""),space:e.space??void 0,order:[]}),[i,s]=React$9.useState({marginRight:"5px",width:"100%",height:"100%"});return React$9.createElement(React$9.Fragment,null,React$9.createElement("div",{...o,...e,className:o.className,style:o.style},React$9.Children.map(e.children,(u,c)=>c==t-1?React$9.createElement("div",{style:{...i,flex:o.space?"auto":void 0}},u):React$9.createElement("div",{style:{...i,order:`${o.order[c]}`,flex:`0 0 ${o.space?o.space[c]:void 0}%`}},u))))}const React$8=window.React;function Box(e){var r,i;let t="Box ",n={display:"flex",flexDirection:e.dir??"row",justifyContent:e.jus??"center",alignItems:e.ali??"center",width:e.min==1?"fitContent":"100%",height:e.min==1?"fitContent":"100%",transform:e.move?`translate(${((r=e.move)==null?void 0:r.x)??0}, ${((i=e.move)==null?void 0:i.y)??0})`:void 0},[a,o]=React$8.useState({style:e.style?{...e.style,...n}:n,className:t+(e.className??""),space:e.space??void 0,order:[]});return React$8.createElement(React$8.Fragment,null,React$8.createElement("div",{...a,...e,className:a.className,style:a.style},e.children))}function deleteDBAll(e){let t=window.indexedDB.deleteDatabase(e);t.onerror=function(n){console.log("删除失败")},t.onsuccess=function(n){console.log("删除成功")}}const React$7=window.React,theme=createTheme({palette:{primary:{main:"#1976d2"},secondary:purple}}),TemporaryDrawer=observer(e=>{const t=useImage(),[n,a]=React$7.useState(!1),[o,r]=React$7.useState([]),[i,s]=React$7.useState(!1);function u(){s(!0)}return React$7.useEffect(()=>{readAllMemoryImg().then(c=>{r(c)})}),React$7.useEffect(()=>{a(t.displayState)},[t.displayState]),React$7.createElement(React$7.Fragment,null,React$7.createElement(Dialog,{open:i,onClose:()=>{s(!1)}},React$7.createElement(DialogTitle,{id:"alert-dialog-title"},"Ready to delete all the images?"),React$7.createElement(DialogContent,null,React$7.createElement(DialogContentText,{id:"alert-dialog-description"},'Once you have clicked the "yes" button, your pictures and your text will be deleted!')),React$7.createElement(DialogActions,null,React$7.createElement(Button,{onClick:()=>{s(!1),deleteDBAll("md_content"),window.location.reload()}},"YES"),React$7.createElement(Button,{onClick:()=>{s(!1)},autoFocus:!0},"NO"))),React$7.createElement(Drawer,{anchor:"bottom",open:n,elevation:16,onClose:()=>{t.hidden()}},React$7.createElement("div",{style:{height:"60vh"}},React$7.createElement("div",null,React$7.createElement(ThemeProvider,{theme},React$7.createElement(Box,null,React$7.createElement(LR,{space:[90]},React$7.createElement(Box,{min:1,move:{x:"5vw"}},React$7.createElement("p",null,"图片管理器"),React$7.createElement(Tooltip,{title:React$7.createElement("div",null,"管理粘贴上传的图片",React$7.createElement("ul",{style:{margin:"2px"}},React$7.createElement("li",null,"按住Ctrl点击图片插入"),React$7.createElement("li",null,"双击图片放大预览"),React$7.createElement("li",null,"按住Alt点击图片复制图片")))},React$7.createElement(IconButton,null,React$7.createElement(default_1$f,{color:"primary"})))),React$7.createElement(Box,null,React$7.createElement(Tooltip,{title:"删除全部图片和储存的文字"},React$7.createElement(IconButton,{onClick:u},React$7.createElement(default_1$g,{color:"primary"})))))))),React$7.createElement(Divider,{style:{marginBottom:"1.3vh"}}),React$7.createElement(Grid,{container:!0,rowSpacing:5,columns:16},o?o.map((c,l)=>React$7.createElement(Grid,{id:c.uuid,key:c.uuid,xs:8},React$7.createElement(_MagicImg,{magic:0,src:c.imgBase64,uuid:c.uuid}))):void 0))))}),svg_1=""+new URL("../2904f250.aboutBox关闭.svg",import.meta.url).href;let aboutMd;const aboutBox=async()=>{let e=`
<div class="closeBox" id="closeAbout">
<img id="closeAboutSvg" class="closeSvg" src=${svg_1} alt="">
</div>
`;await fetch("https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/source/assets/about.md").then(async n=>{aboutMd=n.text(),document.getElementById("aboutMd")&&(document.getElementById("aboutMd").innerHTML=e+t(await aboutMd))}).catch(n=>{console.error("Error fetching markdown:",n)});function t(n){return markdownParser().render(n)}document.getElementById("closeAboutSvg").addEventListener("click",()=>{document.getElementById("aboutBox").style.display="none"}),document.getElementById("aboutBox").addEventListener("click",n=>{n.target==document.getElementById("markdownParser")&&(document.getElementById("aboutBox").style.display="none")}),document.getElementById("aboutBox").style.display="block"},React$6=window.React,runTo=(e,t)=>{kit.sleep(t).then(()=>{window.location.href=e})},handleHomeClick=()=>{runTo("https://bigonion.cn",300)},boxShadow="0px 2px 4px -1px rgba(0,0,0,0.2), 0px 4px 5px 0px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12);",drawerWidth=240,DrawerAppBar=observer(e=>{const t=useTheme(),{window:n}=e,[a,o]=React$6.useState(!1),r=()=>{o(c=>!c)},i=n!==void 0?()=>n().document.body:void 0;React$6.useState(!1);const s=()=>{Message.info({content:"此功能仍然在开发中",closable:!0,duration:3e3,position:"bottom"})},u=React$6.createElement(Box$1,{onClick:r,sx:{textAlign:"center",height:"100%",bgcolor:"black"}},React$6.createElement(Typography,{variant:"h1",sx:{fontSize:"20px",my:2,color:"wheat",textAlign:"center",boxShadow}},"Markdown+ Online View"),React$6.createElement(List,{sx:{height:"100%",bgcolor:"background.paper"}},React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:handleHomeClick},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$a,null))),React$6.createElement(ListItemText,{primary:"Home",secondary:""}))),React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:s},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$k,null))),React$6.createElement(ListItemText,{primary:"Photos",secondary:""}))),React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:myPrint},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$l,null))),React$6.createElement(ListItemText,{primary:"Export",secondary:""}))),React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:()=>{aboutBox()}},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$m,null))),React$6.createElement(ListItemText,{primary:"About",secondary:""})))));return React$6.createElement(React$6.Fragment,null,React$6.createElement("div",{className:"FLEX ",style:{flex:"0 0 8.7vh"}},React$6.createElement(CssBaseline,null),React$6.createElement(AppBar,{component:"nav",sx:{position:"inherit",justifyContent:"center",zIndex:100,height:"8.7vh",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},React$6.createElement(Toolbar,null,React$6.createElement(IconButton,{color:"inherit",onClick:r,sx:{mr:200,display:{sm:"none"}}},React$6.createElement(default_1$h,null)),React$6.createElement(default_1$i,{sx:{color:t.palette.mode=="light"?"black":"white",display:{xs:"none",md:"flex"},transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",mr:1}}),React$6.createElement(Typography,{variant:"h1",component:"a",fontFamily:"monospace",href:"/",sx:{flexGrow:1,display:{xs:"none",sm:"block"},color:t.palette.mode==="light"?t.palette.primary.contrastText:t.palette.secondary.contrastText,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",textDecoration:"none"}},React$6.createElement("h1",{style:{fontSize:"28px"}},"Markdown+ Online View")),React$6.createElement(Box$1,{sx:{display:{xs:"none",sm:"flex",flexDirection:"row"}}},React$6.createElement(CustomizedButtons,{href:"https://bigonion.cn",startIcon:React$6.createElement(default_1$j,null)},"首页"),React$6.createElement(CustomizedButtons,{onClick:()=>{aboutBox()},startIcon:React$6.createElement(default_1$f,null)},"关于"),React$6.createElement(CustomizedMenus,null),React$6.createElement(TemporaryDrawer,null)))),React$6.createElement(Box$1,{sx:{display:{xs:"flex",sm:"none"}},component:"nav"},React$6.createElement(Drawer,{container:i,variant:"temporary",open:a,onClose:r,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:drawerWidth}}},u))))});function enableFastKeyEvent(){document.addEventListener("keydown",e=>{e.key=="Tab"&&e.preventDefault(),e.ctrlKey&&e.key=="b",e.key=="c"&&e.altKey,e.ctrlKey&&e.key=="s"&&(e.stopPropagation(),e.preventDefault(),save()),e.key=="i"&&e.altKey&&e.ctrlKey,e.key=="o"&&e.altKey&&e.ctrlKey},!0)}function monacoPasteEvent(e,t){e.getContainerDomNode().addEventListener("paste",n=>{handlePasteEvent(n).then(a=>{if(a){let o="",r=new Date().getTime();console.log(a);for(let i=0;i<=a.length-1;i++)console.log(i),o+=`![我是图片](/vf/${r+i})`;fillInMemoryImgs(a,r),insertTextMonacoAtCursor(o,!0)}})},!0)}function handlePasteEvent(e){return new Promise(t=>{let a=(e.clipboardData||window.clipboardData).items;const o=a.length;let r=[];for(let i=0;i<a.length;i++){let s=a[i];if(s.kind=="file"){e.preventDefault(),e.stopPropagation();let u=s.getAsFile(),c=new FileReader;c.onload=function(m){r.push(m.target.result),i===o-1&&t(r)};const l=u.type.split("/")[1];(l==="png"||l==="jpg"||l==="jpeg"||l==="webp"||l==="svg")&&c.readAsDataURL(u)}else t([])}})}let lock=!1,triggerTime=0;function triggerConverterEvent(e=2){let t,n;triggerTime++,lock?(clearTimeout(t),t=setTimeout(function(){mdConverter(),triggerTime=0},300)):(clearTimeout(n),triggerTime>=e?(lock=!0,mdConverter(),n=setTimeout(()=>{lock=!1,triggerTime=0},200)):mdConverter())}function getCommandPaletteText(){return document.getElementsByClassName("ibwrapper")[0]?document.getElementsByClassName("ibwrapper")[0].children[0].value:""}function exeTableAction(){const e=getCommandPaletteText().split("#")[1],t=getCommandPaletteText().split("#")[2];insertTextMonacoAtCursor(generateMarkdownTable(e,t),!0)}function generateMarkdownTable(e,t){if(!e||!t)return"";let n="| ";for(let a=0;a<t;a++)n+=`Header  ${a+1} | `;n+=`
|`;for(let a=0;a<t;a++)n+="--- | ";for(let a=0;a<e;a++){n+=`
| `;for(let o=0;o<t;o++)n+=` Cell ${a+1}-${o+1} | `}return n}function exeInsertPageBreakerAction(){insertTextMonacoAtCursor(`|---|
`,!0)}function exeLatexBlockAction(e,t){const n=e.getPosition();n.column==1&&(insertTextMonacoAtCursor(`$$

$$`,!0),e.setPosition({column:1,lineNumber:n.lineNumber+1}))}function exeEmojiPickerAction(e,t){getEmojiPickerState()==="on"?changeEmojiPickerState("off"):changeEmojiPickerState("on")}function exeSpeechPanelAction(e,t){const n=getSettings().basic.speechLanguage??"zh-CN";let a=o=>{insertTextMonacoAtCursor(window._speechData.speechResult,!0)};if(window._speechData.processing)window._speechData.processing=!1,window._speechData.speech.stopRecognition(),window._speechData.speech=null,window._speechData.speechResult="";else{window._speechData.processing=!0;let{recognition:o}=speechRecognition(n,!0,a);window._speechData.speech=o}}function monacoKeyEvent(e,t){const n={save:t.KeyMod.CtrlCmd|t.KeyCode.KeyS,left:t.KeyMod.CtrlCmd|t.KeyCode.KeyL,right:t.KeyMod.CtrlCmd|t.KeyCode.KeyR,quotation:t.KeyMod.Shift|t.KeyCode.Quote,format:t.KeyMod.Shift|t.KeyCode.KeyF,pageBreaker:t.KeyMod.CtrlCmd|t.KeyMod.Alt|t.KeyCode.Enter,latexBlock:t.KeyMod.CtrlCmd|t.KeyCode.KeyM,voice2Words:t.KeyMod.CtrlCmd|t.KeyMod.Alt|t.KeyCode.KeyV};e.addAction({id:"fsKey2",label:"fsKey2",keybindings:[],run:a=>{e.getAction("editor.action.formatDocument").run()}}),e.addAction({id:"fsKey3",label:"fsKey3",keybindings:[n.left],run:()=>{}}),e.addAction({id:"fsKey4",label:"fsKey4",keybindings:[],run:()=>{insertQuotationInMonaco()}}),e.addAction({id:"table-any",label:"table#x#x",keybindings:[],run:()=>{exeTableAction()}}),e.addAction({id:"reload",label:"Reload Markdown Online View+",keybindings:[],contextMenuGroupId:"navigation",run:()=>{window.location.reload()}}),e.addAction({id:"reload-no-cache",label:"Reload Markdown Online View+ (With No Cache)",keybindings:[],run:()=>{window.location.reload(!0)}}),e.addAction({id:"export.asPDF",label:"Export AS PDF",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:0,run:async()=>{await isSaved()?myPrint():(save(),kit.sleep(800).then(()=>{myPrint()}))}}),e.addAction({id:"export.asImg",label:"Export As Image",keybindings:[],run:()=>{exportAsImage()}}),e.addAction({id:"insert.pageBreaker",label:"Insert A Page Breaker",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:0,run:()=>{exeInsertPageBreakerAction()}}),e.addAction({id:"insert.latexBlock",label:"Insert A Latex Block",keybindings:[n.latexBlock],contextMenuGroupId:"navigation",contextMenuOrder:0,run:()=>{exeLatexBlockAction(e)}}),e.addAction({id:"show.emojiPicker",label:"Show Emoji Picker 🤪",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:-100,run:()=>{exeEmojiPickerAction()}}),e.addAction({id:"insert.voice2words",label:"Speech to text",keybindings:[n.voice2Words],contextMenuGroupId:"navigation",run:()=>{exeSpeechPanelAction()}})}function monacoSnippets(e,t){t.languages.registerCompletionItemProvider("markdown",{provideCompletionItems:(n,a,o)=>{const r=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:a.lineNumber,endColumn:a.column});if(!isInLatexBlock(r)&&a.column===2)return{suggestions:[{label:"clg",kind:t.languages.CompletionItemKind.Function,insertText:"console.log(${1:val})",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"调试..."},{label:"code",kind:t.languages.CompletionItemKind.Function,insertText:"\n```${1:js}\n${2:}\n```\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"code"},{label:"table 2x2",kind:t.languages.CompletionItemKind.Function,insertText:"\n|${1:}    |${1:}     |\n|--- |---  |\n|${1:}    |${1:}     |\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"table 2x2"},{label:"table 2x4",kind:t.languages.CompletionItemKind.Function,insertText:"\n|${1:}    |${1:}    |${1:}    |${1:}    |\n|--- |--- |--- |--- |\n|${1:}    |${1:}    |${1:}    |${1:}    |\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"table 2x4"},{label:"ignore",kind:t.languages.CompletionItemKind.Field,insertText:"<!-- prettier-ignore -->",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"ignore prettier"},{label:"ignore-block",kind:t.languages.CompletionItemKind.Field,insertText:`<!-- prettier-ignore-start -->
\${1:}
<!-- prettier-ignore-end -->`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"ignore block"},{label:"latex-block",kind:t.languages.CompletionItemKind.Field,insertText:`$$
\${1:}
$$
`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"Create A LaTex Block"},{label:"latex-inline",kind:t.languages.CompletionItemKind.Field,insertText:"$${1:}$",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"Create A LaTex Inline"}]}}}),t.languages.registerCompletionItemProvider("markdown",{triggerCharacters:["\\"],provideCompletionItems:(n,a,o)=>{const r=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:a.lineNumber,endColumn:a.column});if(isNeedToUseLatexIntellisense(r)){const i=Array.from([...delimiters0,...delimeterSizing0,...greekLetters0,...otherLetters0,...spacing0,...verticalLayout0,...logicAndSetTheory0,...macros0,...bigOperators0,...binaryOperators0,...binomialCoefficients0,...fractions0,...mathOperators0,...relations0,...negatedRelations0,...arrows0,...font0,...size0,...style0,...symbolsAndPunctuation0,...debugging0],(l,m)=>({label:`\\${l}`,kind:t.languages.CompletionItemKind.Function,insertText:l,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(l[0])?"1":"0"})),s=Array.from([...accents1,...annotation1,...verticalLayout1,...overlap1,...spacing1,...logicAndSetTheory1,...mathOperators1,...sqrt1,...extensibleArrows1,...font1,...braketNotation1,...classAssignment1],(l,m)=>({label:`\\${l}`,kind:t.languages.CompletionItemKind.Function,insertText:`${l}{$1}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(l[0])?"1":"0"})),u=Array.from([...verticalLayout2,...binomialCoefficients2,...fractions2,...color2],(l,m)=>({label:`\\${l}`,kind:t.languages.CompletionItemKind.Function,insertText:`${l}{$1}{$2}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(l[0])?"1":"0"})),c=[{label:"\\begin",kind:t.languages.CompletionItemKind.Function,insertText:"begin{${1|"+envs.join(",")+`|}}
	$2
\\end{$1}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet}];return{suggestions:[...i,...s,...u,...c]}}}}),t.languages.registerCompletionItemProvider("markdown",{triggerCharacters:["^"],provideCompletionItems:(n,a,o)=>{const r=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:a.lineNumber,endColumn:a.column});if(isNeedToUseClueIntellisense(r))return{suggestions:[{label:"RED",kind:t.languages.CompletionItemKind.Function,insertText:"RED",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"RED..."},{label:"PINK",kind:t.languages.CompletionItemKind.Function,insertText:"PINK",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"PINK..."}]}}})}function isNeedToUseLatexIntellisense(e){return!!(e[e.length-1]==="\\"&&isInLatexBlock(e))}function isInLatexBlock(e){return(e.match(/\$\$/g)?e.match(/\$\$/g).length%2===1:!1)||(e.match(/\$/g)?e.match(/\$/g).length%2===1:!1)}function isNeedToUseClueIntellisense(e){return e[e.length-1]==="^"}function replaceMonacoAll(e,t,n=""){const a=t??window.editor;let o=e.getFullModelRange();a.executeEdits("my-replace2",[{range:o,text:n,forceMoveMarkers:!0}])}function monacoFormat(e,t){t.languages.registerDocumentFormattingEditProvider("markdown",{provideDocumentFormattingEdits(n){let a=n.getValue();var o=e.getPosition();return prettier.format(a,{parser:"markdown",plugins:[parseMd]}).then(r=>{replaceMonacoAll(n,e,r),e.setPosition(o)}),[]}})}function getDeviceTyByProportion(){const e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;return e/t>=1?"PC":"mobile"}function monacoMouseEvent(e,t){e.onContextMenu(n=>{setContextMenuClickPosition({posx:n.event.posx,posy:n.event.posy})})}function monacoClickEvent(e,t){e.onDidFocusEditorWidget(()=>{window.deco.clear()})}function monacoResizeHeightEvent(e){const t=()=>{e(Math.floor(window.innerHeight*.9))};window.addEventListener("resize",t)}const React$5=window.React,useState=window.React.useState,version="0.45.0",cdnDomain={unpkg:["npm.onmicrosoft.cn","unpkg.com"],jsDelivr:["jsd.onmicrosoft.cn","www.jsdelivr.com","jsd.haorwen.tk"]},cdnLinks={unpkg:{cdn:`https://${cdnDomain.unpkg[0]}/monaco-editor@${version}/dev/vs`},jsDelivr:{cdn:`https://${cdnDomain.jsDelivr[0]}/npm/monaco-editor@${version}/dev/vs`}};try{loader.config({paths:{vs:cdnLinks.unpkg.cdn}})}catch(e){loader.config({paths:{vs:cdnLinks.jsDelivr.cdn}})}const files={"index.js":{name:"index.js",language:"javascript",value:"nihao"},"style.css":{name:"style.css",language:"css",value:"nihao"},"index.md":{name:"index.md",language:"markdown",value:""}},MonacoEditor=observer(function e(){const[t,n]=React$5.useState(640),[a,o]=React$5.useState(800),r=()=>{mdConverter(),setTimeout(()=>{s(d=>({...d,minimap:{enabled:!0}}))},300)},[i,s]=useState({fontSize:16,wordWrap:"on",formatOnType:!0,formatOnPaste:!1,fontLigatures:!0,autoSurround:"quotes",autoClosingQuotes:"always",smoothScrolling:!0,codeLens:!1,pasteAs:{enabled:!1,showPasteSelector:"never"},peekWidgetDefaultFocus:"tree",cursorSmoothCaretAnimation:"explicit",colorDecorators:!0,minimap:{enabled:!0},unicodeHighlight:{nonBasicASCII:!1,ambiguousCharacters:!1}}),[u,c]=useState("index.md"),l=files[u];function m(d){triggerConverterEvent(4)}function f(d,g){g.languages.setLanguageConfiguration("markdown",{autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'",notIn:["string","comment"]},{open:"`",close:"`",notIn:["string","comment"]},{open:"/*",close:"*/",notIn:["string"]},{open:"？",close:"？",notIn:["string","comment"]}]}),g.languages.setMonarchTokensProvider("markdown",{tokenizer:{root:[[/\b(function|return|var)\b/,"keyword"],[/[{}]/,"delimiter"],[/[a-z_$][\w$]*/,"identifier"],[/"[^"]*"/,"string"],[/\d+/,"number"],[/[$$$$]/,"annotation"]]}})}function h(){}function R(d,g){window.editor=d,window.monaco=g,getDeviceTyByProportion()=="PC"&&n(document.getElementById("editor").clientWidth/2),o(document.getElementById("editor").clientHeight),f(d,g),monacoPasteEvent(d),monacoKeyEvent(d,g),monacoSnippets(d,g),monacoFormat(d,g),monacoMouseEvent(d),monacoClickEvent(d),allInit(d,g),monacoResizeHeightEvent(o)}return React$5.createElement(React$5.Fragment,null,React$5.createElement("div",{id:"monaco-editor",style:{width:t,height:"100%"}},React$5.createElement(ResizableBox,{className:"custom-resizable",width:t,height:a,draggableOpts:{grid:[5,15]},minConstraints:[100,a],onResizeStop:r,onResize:d=>{s(g=>({...g,minimap:{enabled:!1}})),n(d.x)},axis:"x"},React$5.createElement(Ft,{className:"monaco-editor-inner",height:"100%",width:t,theme:getTheme()==="light"?"vs-light":"vs-dark",path:l.name,defaultLanguage:l.language,defaultValue:l.value,onMount:R,onChange:m,options:i,beforeMount:h}))))}),React$4=window.React;function MdArea(){return React$4.createElement(React$4.Fragment,null,React$4.createElement(MonacoEditor,null))}const React$3=window.React,EmojiPicker=observer(function e(t){const a=c(),o=React$3.useRef(),[r,i]=React$3.useState(!1),[s,u]=React$3.useState(!1);function c(){let m=getContextMenuClickPosition();return m.posy+435>window.document.body.clientHeight&&(m.posy=window.document.body.clientHeight-435),m}function l(m){insertTextMonacoAtCursor(m.native,!0)}return React$3.useEffect(()=>{i(t.open),t.open?(u(t.open),gsap.fromTo(".emojiPicker",{x:0},{x:20,opacity:1,duration:.6})):gsap.to(".emojiPicker",{opacity:0,duration:.4,onComplete:function(){u(r)}})},[t.open]),React$3.createElement(React$3.Fragment,null,React$3.createElement(Backdrop,{invisible:!0,ref:o,transitionDuration:{appear:500,enter:500,exit:1e3},sx:{zIndex:m=>m.zIndex.drawer+1,pointerEvents:r?"":"none"},open:r,onContextMenu:m=>{m.target.tagName!="EM-EMOJI-PICKER"&&(changeEmojiPickerState("off"),m.preventDefault())},onMouseUp:m=>{m.button==2||m.button==0&&m.target.tagName!="EM-EMOJI-PICKER"&&changeEmojiPickerState("off")}},React$3.createElement(Box$1,{sx:{position:"absolute",top:a.posy-window.document.body.clientHeight*.1,left:a.posx+window.document.body.clientWidth*.02},className:"MIN emojiPicker"},React$3.createElement($e5534fc185f7111e$export$2e2bcd8739ae039,{data,onEmojiSelect:l}))))}),React$2=window.React;function enEvents(e){e&&enableFastKeyEvent()}const Body=observer(function e(){return React$2.useEffect(()=>{enEvents(!0)},[]),React$2.createElement(React$2.Fragment,null,React$2.createElement("div",{style:{marginTop:"1.3vh"},id:"bodyTopBox"},React$2.createElement("div",{id:"editor",className:`${getTheme()=="light"?"theme-light":"theme-dark"} FLEX ROW`},React$2.createElement(MdArea,null),React$2.createElement("article",{id:"view-area-hidden",className:"hidden-pre"}),React$2.createElement("article",{id:"view-area",className:`markdown-body ${getTheme()==="light"?"markdown-body-light":"markdown-body-dark"}`})),React$2.createElement("div",{id:"aboutBox"},React$2.createElement("div",{id:"markdownParser"},React$2.createElement("div",{id:"aboutMd",className:`aboutViewArea markdown-body ${getTheme()==="light"?"markdown-body-light":"markdown-body-dark"}`}))),React$2.createElement(EmojiPicker,{open:getEmojiPickerState()==="on"})))}),React$1=window.React,lightTheme=createTheme({palette:{primary:{main:blue[200],contrastText:"#fff378"},secondary:{main:green[500],contrastText:"pink"},mode:"light"}}),darkTheme=createTheme({palette:{primary:{main:blue[400],contrastText:"wheat"},secondary:{main:green[700],contrastText:"wheat"},mode:"dark"}}),App=observer(()=>React$1.createElement(React$1.Fragment,null,React$1.createElement(ThemeProvider,{theme:getTheme()==="light"?lightTheme:darkTheme},React$1.createElement(CssBaseline,null),React$1.createElement("div",{className:"FLEX COL"},React$1.createElement(DrawerAppBar,null),React$1.createElement(Body,null))))),React=window.React;client.createRoot(document.getElementById("root")).render(React.createElement(App,null));
