var C=Object.defineProperty;var I=(e,t,n)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var x=(e,t,n)=>(I(e,typeof t!="symbol"?t+"":t,n),n);import{c as client}from"./react-dom-d3bdc6a0.js";import{s as styled,B as Button,g as grey,M as Menu,D as Dialog,a as DialogTitle,b as DialogContent,c as DialogContentText,T as TextField,d as DialogActions,e as default_1$1,f as MenuItem,h as default_1$2,F as FormControl,i as Box$1,I as InputLabel,S as Select,j as default_1$3,k as default_1$4,l as default_1$5,m as default_1$6,n as TreeItem,t as treeItemClasses,o as alpha,C as Collapse,p as SimpleTreeView,q as default_1$7,r as default_1$8,u as default_1$9,v as Breadcrumbs,L as Link,w as default_1$a,x as default_1$b,y as Typography,z as default_1$c,A as Switch,E as useTheme,G as Divider,H as default_1$d,J as default_1$e,K as default_1$f,N as Tooltip,Z as Zoom,O as createTheme,P as purple,Q as Drawer,R as ThemeProvider,U as IconButton,V as default_1$g,W as default_1$h,X as Grid,Y as CssBaseline,_ as AppBar,$ as Toolbar,a0 as default_1$i,a1 as default_1$j,a2 as default_1$k,a3 as List,a4 as ListItem,a5 as ListItemButton,a6 as ListItemAvatar,a7 as Avatar,a8 as ListItemText,a9 as default_1$l,aa as default_1$m,ab as default_1$n,ac as debounce,ad as Backdrop,ae as CircularProgress,af as blue,ag as green}from"./@mui-c69c44d3.js";import{openDB,updateDB,cursorGetData,cursorGetDataByIndex}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@V2.1.1/@cdn/functions/App/db.min.js";import hljs from"https://npm.elemecdn.com/@highlightjs/cdn-assets@11.6.0/es/highlight.min.js";import{marked}from"https://npm.elemecdn.com/marked/lib/marked.esm.js";import mermaid from"https://jsd.onmicrosoft.cn/npm/mermaid@10/dist/mermaid.esm.min.mjs";import*as IncrementalDOM from"https://jsd.onmicrosoft.cn/npm/incremental-dom@0.7.0/+esm";import"https://npm.elemecdn.com/katex@0.16.7/dist/katex.min.js";import"https://jsd.onmicrosoft.cn/npm/string-replace-async@3.0.2/index.min.js";import kit from"https://jsd.onmicrosoft.cn/npm/bigonion-kit@0.12.3/esm/kit.min.js";import markdownIt from"https://jsd.onmicrosoft.cn/npm/markdown-it@14.1.0/+esm";import{d as default_1}from"./markdown-it-incremental-dom-c4f66209.js";import mdItMultimdTable from"https://jsd.onmicrosoft.cn/npm/markdown-it-multimd-table@4.2.3/+esm";import markdownItGithubToc from"https://jsd.onmicrosoft.cn/npm/markdown-it-github-toc@3.2.4/src/index.js/+esm";import{full}from"https://jsd.onmicrosoft.cn/npm/markdown-it-emoji@3.0.0/+esm";import{has,emojify}from"https://jsd.onmicrosoft.cn/npm/node-emoji@2.1.3/+esm";import vconsole from"https://jsd.onmicrosoft.cn/npm/vconsole@3.15.1/+esm";import{makeAutoObservable,observable,toJS}from"https://jsd.onmicrosoft.cn/npm/mobx@6.12.0/+esm";import markdownitFootNote from"https://jsd.onmicrosoft.cn/npm/markdown-it-footnote@4.0.0/+esm";import{Notification,Message}from"https://jsd.onmicrosoft.cn/npm/@arco-design/web-react@2.62.0/+esm";import{o as observer}from"./mobx-react-ed2466fd.js";import axios from"https://jsd.onmicrosoft.cn/npm/axios@1.6.5/+esm";import html2canvas from"https://jsd.onmicrosoft.cn/npm/html2canvas@1.4.1/+esm";import{PhotoProvider,PhotoView}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@V2.1.3/@cdn/lib/react-photo-view/react-photo-view.module.js";import{l as loader,F as Ft}from"./@monaco-editor-38e7c7a5.js";import{R as ResizableBox}from"./react-resizable-8f73e4ed.js";import{delimiters0,delimeterSizing0,greekLetters0,otherLetters0,spacing0,verticalLayout0,logicAndSetTheory0,macros0,bigOperators0,binaryOperators0,binomialCoefficients0,fractions0,mathOperators0,relations0,negatedRelations0,arrows0,font0,size0,style0,symbolsAndPunctuation0,debugging0,accents1,annotation1,verticalLayout1,overlap1,spacing1,logicAndSetTheory1,mathOperators1,sqrt1,extensibleArrows1,font1,braketNotation1,classAssignment1,verticalLayout2,binomialCoefficients2,fractions2,color2,envs}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/@cdn/functions/Monaco/snippets/latexRules.min.js";import prettier from"https://jsd.onmicrosoft.cn/npm/prettier@3.2.4/+esm";import parseMd from"https://jsd.onmicrosoft.cn/npm/prettier@3.2.4/plugins/markdown.js/+esm";import data from"https://jsd.onmicrosoft.cn/npm/@emoji-mart/data@1.1.2/+esm";import{$ as $e5534fc185f7111e$export$2e2bcd8739ae039}from"./@emoji-mart-a8b676b0.js";import{gsap}from"https://jsd.onmicrosoft.cn/npm/gsap@3.12.5/+esm";import"./react-2b221fbb.js";import"./@babel-f8d566ba.js";import"./clsx-0839fdbe.js";import"./@emotion-d13e5fae.js";import"./hoist-non-react-statics-3f8ebaa8.js";import"./stylis-79144faa.js";import"./react-is-e5978b8b.js";import"./react-transition-group-bc100b23.js";import"./@popperjs-f3391c26.js";import"./prop-types-7395632d.js";import"./htmlparser2-b305cd15.js";import"./inherits-2c87d58f.js";import"./mobx-react-lite-290ab4f8.js";import"./use-sync-external-store-b84fba6b.js";import"./state-local-dd516420.js";import"./react-draggable-b033082a.js";import"https://jsd.onmicrosoft.cn/npm/emoji-mart@5.6.0/+esm";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const React$l=window.React,ColorButton=styled(Button)(({theme:e})=>({color:e.palette.mode==="light"?"rgb(55, 65, 81)":"#FFFFFF",marginLeft:10,fontFamily:["electronicFont"].join(","),backgroundColor:e.palette.mode==="light"?"#FFFFFF":"","&:hover":{backgroundColor:e.palette.mode==="light"?grey[300]:""}}));function CustomizedButtons(e){return React$l.createElement(ColorButton,{id:"demo-customized-button",href:e.href?e.href:void 0,"aria-controls":e.open?"demo-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":e.open?"true":void 0,disableElevation:!0,onClick:e.onClick,onMouseOver:e.onHover,endIcon:e.endIcon,startIcon:e.startIcon?e.startIcon:void 0,variant:"contained"},e.children)}function getMdTextFromMonaco(){var e;if((e=window.editor)!=null&&e.getValue){let t=window.editor.getValue();return t=t.replace(/\r\n/g,`
`),t}else return"null"}function getRenderHTML(e="view-area"){let t=document.getElementById(e);if(t)return t.innerHTML}function fillInMemoryText(e){openDB("md_content",2).then(t=>{updateDB(t,"users_md",{uuid:1,contentText:e})})}async function readMemoryText(){return new Promise(e=>{openDB("md_content",2).then(t=>{cursorGetData(t,"users_md").then(n=>{e(n)})})})}function fillInMemoryImgs(e,t){openDB("md_content",2).then(n=>{for(let a=0;a<=e.length-1;a++){let r={uuid:t+a,imgBase64:e[a]};updateDB(n,"users_img",r)}})}async function readMemoryImg(e,t){return new Promise(n=>{openDB("md_content",2).then(a=>{cursorGetDataByIndex(a,"users_img",e,t).then(r=>{n(r)})})})}async function readAllMemoryImg(){return new Promise(e=>{openDB("md_content",2).then(t=>{cursorGetData(t,"users_img").then(n=>{e(n)})})})}const supportFileTypes=[".md",".py",".js",".ts"];class FileManager{constructor(t){x(this,"fileHandle",null);t?this.fileHandle=t:this.fileHandle=window._fileHandle??window._fileHandle}async openSingleFile(){try{return[this.fileHandle]=await window.showOpenFilePicker({multiple:!1,types:[{description:"Text Files",accept:{"text/plain":supportFileTypes}}]}),window._fileHandle=this.fileHandle,this.fileHandle}catch(t){return console.error("Error opening file:",t),null}}async readFile(){return this.fileHandle?await(await this.fileHandle.getFile()).text():void 0}async saveFileSilently(t){if(!this.fileHandle)return;const n=await this.fileHandle.createWritable(),a=t;return await n.write(a),await n.close(),!0}async saveAsFile(t){try{const a=await(await window.showSaveFilePicker({suggestedName:"text",types:[{description:"Text Files",accept:{"text/plain":supportFileTypes}}]})).createWritable();await a.write(t??"Sth.."),await a.close(),console.log("File saved successfully as new file.")}catch(n){console.error("Save As operation cancelled or failed:",n)}}}class OperateLocalStorage{constructor(){x(this,"version","0.2")}setItem(t,n){localStorage.setItem(t,n)}getItem(t){return localStorage.getItem(t)?localStorage.getItem(t):""}removeItem(t){localStorage.removeItem(t)}}let welcomeText;function blankTextInit(){return new Promise(e=>{readMemoryText().then(t=>{t.length&&t[0].contentText?(window.editor.setValue(t[0].contentText),e()):(fetch("https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/source/assets/welcome.md").then(n=>n.text()).then(n=>{welcomeText=n,window.editor.setValue(welcomeText)}).catch(n=>{console.error("Error fetching markdown:",n)}),e())})})}function PageBreaker(e){let t=/\|---\|/g;return e=e.replace(t,()=>'<div style="page-break-after: always;"></div>'),e}const index="";async function prepareParser(e){async function t(d){let l=d.attrGet("src");if(l.startsWith("/vf/")){let m=l.match(/\d+/)[0];return await readMemoryImg("uuid",parseInt(m)).then(u=>u[0].imgBase64)}}async function n(d){let l=d.content,m;try{return await mermaid.parse(l,{suppressErrors:!1}),await mermaid.parse(l,{suppressErrors:!0})&&(m=await mermaid.render(`_mermaidSvg_${kit.getUUID().slice(0,5)}`,l)),m.svg}catch(u){return`<pre class="ERR">${u}</pre>`}}let a=[],r=[],i=[],o=[],c=markdownParser();c.renderer.rules.image=function(d,l){var m;return(m=d[l].attrGet("src"))!=null&&m.startsWith("/vf/")&&a.push(d[l]),""},c.renderer.rules.fence=function(d,l,m,u,h){return d[l].info==="mermaid"&&r.push(d[l]),""},c.render(e,{});for(const d of a){let l=await t(d);i.push(l)}for(const d of r){let l=await n(d);o.push(l)}return{vfImgSrcArr:i,vfImgSeq:0,mermaidParsedArr:o,mermaidSeq:0}}async function mdConverter(e=!1){let t=getMdTextFromMonaco();t=PageBreaker(t);let n=await prepareParser(t);e?document.getElementById("view-area").innerHTML=markdownParser().render(t,n):IncrementalDOM.patch(document.getElementById("view-area"),markdownParser().renderToIncrementalDOM(t,n)),hljs.highlightAll()}const regs={markHighlight:/@@(.*?)@@/,emoji:/^:([a-zA-Z0-9_\+\-]+):/},newTokenizer={heading(e){return e.match(/^#{1,6}\s.*/),!1},codespan(e){return e.match(/^\&+([^\&\n]+?)\&+/),!1}},newRenderer={paragraph(e){return`<p class="line-hilight">${e}</p>`},heading(e,t){return`
            <h${t}  class="line-hilight">
              <a href="#">
                <span class="header-link"></span>
              </a>
              ${e}
            </h${t}>`},code(code,lang,_escaped){let finalCodeBlock;return lang=="js-run"?(new vconsole,`${eval(code)}`):(hljs.getLanguage(lang)?finalCodeBlock=`<pre><code class="language-${lang} ">${code}</code></pre>`:lang=="mermaid"?finalCodeBlock=`<div class="language-mermaid language-plaintext">${code}</div>`:finalCodeBlock=`<pre><code class="language-plaintext">${code}</code></pre>`,finalCodeBlock)},image(e,t,n){const a="#";let r=Math.random(),i="auto",o="",c="L",s=n.split(a);if(s.length>1)for(let d=0;d<s.length;d++){let l=s[d];l==="s"&&(o+="box-shadow: rgb(199 199 199) 1vh 2vh 21px"),l==="s1"&&(o+="box-shadow: rgb(146 146 146) 1vh 2vh 21px;"),l==="s2"&&(o+="box-shadow: rgb(32 32 32 / 86%) 1vh 2vh 21px"),(l==="C"||l=="c")&&(c="C"),(l==="R"||l=="r")&&(c="R"),l.startsWith("w")&&(i=s[d].substring(1),i.endsWith("%")||(i+="px"))}return`<div class="imgBox-r FLEX ${r} ${c=="C"?" JUS-CENTER":c=="R"?"JUS-RIGHT":""}" ><img class="img_resize_transition" width="${i}" style="${o}" src="${e}" alt="${n}"></div>`}},importUrlExtension={extensions:[{name:"importUrl",level:"block",start(e){return e.indexOf(`
:`)},tokenizer(e){const n=/^:(https?:\/\/.+?):/.exec(e);if(n)return{type:"importUrl",raw:n[0],url:n[1],html:""}},renderer(e){return`<iframe style="border:none" src="${e.url}" width="100%" height="100%"></iframe>`}}]},markItExtension={extensions:[{name:"markIt",level:"inline",start(e){var t;return(t=e.match(/@@/))==null?void 0:t.index},tokenizer(e,t){const n=e.match(regs.markHighlight),a=n?n[1]:"";if(n)return{type:"markIt",raw:e,text:a}},renderer(e){return`${e.raw.replace(regs.markHighlight,`<mark>${e.text}</mark>`)}`}}]},imgExtension={name:"newRenderer",level:"block",tokenizer:newTokenizer,renderer:newRenderer,async:!0,async walkTokens(e){if(e.type,e.type==="image"){const t=e.href;if(t!=null&&t.match(/vf/)){let n=(t.match(/vf\/(\d+)/)?t.match(/vf\/(\d+)/)[1]:0).toString(),a=await readMemoryImg("uuid",parseInt(n)).then(r=>r[0]?r[0].imgBase64:0);e.href=a}}else e.type==="code"||e.type}},emojiExtension={extensions:[{name:"emoji",level:"inline",start(e){var t;return(t=e.match(/:/))==null?void 0:t.index},tokenizer(e,t){const n=e.match(regs.emoji);return n?{type:"emoji",raw:n[0],text:n[1]}:!1},renderer(e){return has(e.raw)?emojify(e.raw):e.raw}}]};class ConfigStore{constructor({themeState:t,fileManagerState:n,emojiPickerState:a,contextMenuClickPosition:r,settingsConfig:i}){x(this,"themeState");x(this,"fileManagerState");x(this,"emojiPickerState");x(this,"contextMenuClickPosition");x(this,"settingsConfig");makeAutoObservable(this,{themeState:observable,fileManagerState:observable,emojiPickerState:observable,contextMenuClickPosition:observable,settingsConfig:observable}),this.themeState=t,this.fileManagerState=n,this.emojiPickerState=a,this.contextMenuClickPosition=r,this.settingsConfig=i}getAllConfig(){let t={};return Object.getOwnPropertyNames(this).forEach((n,a)=>{t[n]=this[n]}),t}}function markdownitLineNumber(e,t){const n=function(a,r,i,o,c){let s;return a[r].map&&a[r].level===0&&(s=a[r].map[0],a[r].attrSet("data-line",String(s))),c.renderToken(a,r,i)};e.renderer.rules.paragraph_open=e.renderer.rules.heading_open=e.renderer.rules.table_open=n}let myPlugin=function(e){e.core.ruler.before("inline","myrule",function(t){var n=t.tokens;for(let a=0;a<n.length;a++)n[a].content&&n[a].content.indexOf("MYRULE")})},imagePlugin=function(e){e.renderer.rules.image,e.renderer.rules.image=function(t,n,a,r,i){var R;const o=t[n],c="#";let s=o.attrs[o.attrIndex("src")][1],d=o.content;o&&((R=o.attrGet("src"))!=null&&R.startsWith("/vf/"))&&r.vfImgSrcArr&&(s=r.vfImgSrcArr[r.vfImgSeq++]);let l="auto",m="",u="L",h=d.split(c);if(h.length>1)for(let y=0;y<h.length;y++){let $=h[y];$==="s"&&(m+="box-shadow: rgb(199 199 199) 1vh 2vh 21px"),$==="s1"&&(m+="box-shadow: rgb(146 146 146) 1vh 2vh 21px;"),$==="s2"&&(m+="box-shadow: rgb(32 32 32 / 86%) 1vh 2vh 21px"),($==="C"||$=="c")&&(u="C"),($==="R"||$=="r")&&(u="R"),$.startsWith("w")&&(l=h[y].substring(1),l.endsWith("%")||(l+="px"))}return`<div class="imgBox-r FLEX  ${u=="C"?" JUS-CENTER":u=="R"?"JUS-RIGHT":""}" ><img class="img_resize_transition" width="${l}" style="${m}" src="${s}" alt="${d}">
    </div>`}},codePlugin=function(e){const t=e.renderer.rules.code_block;e.renderer.rules.fence=function(n,a,r,i,o){let c;n[a].map&&n[a].level===0&&(c=n[a].map[0],n[a].attrSet("data-line",String(c)));let s=n[a].info,d=n[a].content;if(s==="mermaid"){if(i.mermaidParsedArr)return`<div data-line="${c}" class="language-mermaid language-plaintext">
        ${i.mermaidParsedArr[i.mermaidSeq++]}
        </div>`}else return hljs.getLanguage(s)?`<pre class="language-code" data-line="${c}"><code class="language-${s} ${getTheme()==="light"?"":"hljs-dark"}">${d}</code></pre>`:`<div class="code-container" data-line="${c}">
      <pre><code class="language-plaintext">${d}</code></pre>
    </div>`;return t(n,a,r,i,o)}},cluePlugin=function(e){function t(n){const a=n.tokens;for(let r=0;r<a.length;r++)if(a[r].type==="inline"){let i=a[r].children;for(let o=0;o<i.length;o++){const c=i[o];if(c.type==="text"&&c.content){const d=c.content.match(/\^(.*?)\^(.*?)\#$/);if(d){const l=new n.Token("html_block","",0);l.content=`<div class="${d[2]}">${e.render(d[1])}</div>`,i[o]=l,o++}}}}}e.core.ruler.push("my_rule1",t),e.inline.ruler.before("emphasis","mark",(n,a)=>!1)};function customAlignPlugin(e){e.core.ruler.push("custom_align",function(t){let n=null;t.tokens.forEach((a,r)=>{if(a.type==="paragraph_open"){let i=t.tokens[r+1];i&&i.type==="inline"&&i.children.forEach(o=>{if(o.type==="text"){const c=o.content;switch(c.slice(-2)){case"||":o.content=c.slice(0,-2),n="C";break;case">>":o.content=c.slice(0,-2),n="R";break}}})}n&&a.type==="paragraph_open"&&(a.attrPush(["class",n]),n=null)})})}function customAlignPluginHeading(e){e.core.ruler.push("custom_align_heading",function(t){let n=null;t.tokens.forEach((a,r)=>{if(a.type==="heading_open"){let i=t.tokens[r+1];i&&i.type==="inline"&&i.children.forEach(o=>{if(o.type==="text"){const c=o.content;switch(c.slice(-2)){case"||":o.content=c.slice(0,-2),n="C";break;case">>":o.content=c.slice(0,-2),n="R";break}}})}n&&a.type==="heading_open"&&(a.attrPush(["class",n]),n=null)})})}function preViewClickEvent(e,t,n=e.createDecorationsCollection()){document.getElementById("view-area").addEventListener("dblclick",function(a){let r=a.target,i=0;if(r!==this){for(;r;){if(r.hasAttribute("data-line")){i=parseInt(r.getAttribute("data-line"));break}r=r.parentElement}i&&(e.setPosition({lineNumber:i+1,column:1}),e.revealLineInCenter(i+1,1),n.clear(),n.set([{range:new t.Range(i+1,1,i+1,1),options:{isWholeLine:!0,className:"HILIGHT-MONACO",zIndex:0}}]))}})}const katex=window.katex;function isValidDelim(e,t){var n,a,r=e.posMax,i=!0,o=!0;return n=t>0?e.src.charCodeAt(t-1):-1,a=t+1<=r?e.src.charCodeAt(t+1):-1,(n===32||n===9||a>=48&&a<=57)&&(o=!1),(a===32||a===9)&&(i=!1),{can_open:i,can_close:o}}function math_inline(e,t){var n,a,r,i,o;if(e.src[e.pos]!=="$")return!1;if(i=isValidDelim(e,e.pos),!i.can_open)return t||(e.pending+="$"),e.pos+=1,!0;for(n=e.pos+1,a=n;(a=e.src.indexOf("$",a))!==-1;){for(o=a-1;e.src[o]==="\\";)o-=1;if((a-o)%2==1)break;a+=1}return a===-1?(t||(e.pending+="$"),e.pos=n,!0):a-n===0||a-n===2?(t||(e.pending+="$$"),e.pos=n+1,!0):(i=isValidDelim(e,a),i.can_close?(t||(r=e.push("math_inline","math",0),r.markup="$",r.content=e.src.slice(n,a)),e.pos=a+1,!0):(t||(e.pending+="$"),e.pos=n,!0))}function math_block(e,t,n,a){var r,i,o,c,s=!1,d,l=e.bMarks[t]+e.tShift[t],m=e.eMarks[t];if(l+2>m||e.src.slice(l,l+2)!=="$$")return!1;if(l+=2,r=e.src.slice(l,m),a)return!0;for(r.trim().slice(-2)==="$$"&&(r=r.trim().slice(0,-2),s=!0),o=t;!s&&(o++,!(o>=n||(l=e.bMarks[o]+e.tShift[o],m=e.eMarks[o],l<m&&e.tShift[o]<e.blkIndent)));)e.src.slice(l,m).trim().slice(-2)==="$$"&&(c=e.src.slice(0,m).lastIndexOf("$$"),i=e.src.slice(l,c),s=!0);return e.line=o+1,d=e.push("math_block","math",0),d.block=!0,d.content=(r&&r.trim()?r+`
`:"")+e.getLines(t+1,o,e.tShift[t],!0)+(i&&i.trim()?i:""),d.map=[t,e.line],d.markup="$$",!0}function markdownItLatex(e,t){t=t||{throwOnError:!1,strict:!1};var n=function(o){if(t.displayMode=!1,o)try{return katex.renderToString(o,t)}catch{return o}else return"Latex Missing"},a=function(o,c){return n(o[c].content)},r=function(o,c){t.displayMode=!0;let s;if(c.map&&c.level===0&&(s=c.map[0]),o)try{return`<p data-line=${String(s)}>`+katex.renderToString(o,t)+"</p>"}catch{return o}else return"LATEX MISSING"},i=function(o,c){return r(o[c].content,o[c])+`
`};e.inline.ruler.after("escape","math_inline",math_inline),e.block.ruler.after("blockquote","math_block",math_block,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=a,e.renderer.rules.math_block=i}const noteUseArco=(e,t,n)=>{const a=(n==null?void 0:n.kind)??"success",r=(n==null?void 0:n.position)??"bottomRight";Notification[a]({title:e,content:t,position:r})};function markdownParser(){return markdownIt({html:!0,linkify:!0,typographer:!0,breaks:!0}).use(markdownitLineNumber).use(markdownItGithubToc,{anchorLinkSymbol:"",anchorLinkBefore:!1}).use(myPlugin).use(imagePlugin).use(mdItMultimdTable,{multiline:!0,rowspan:!0,headerless:!0,multibody:!0,aotolabel:!0}).use(codePlugin).use(cluePlugin).use(markdownitFootNote).use(customAlignPlugin).use(customAlignPluginHeading).use(full).use(markdownItLatex).use(default_1,IncrementalDOM)}class settingsClass{constructor(){}markedInit(){marked.use({mangle:!1,headerIds:!1,strict:!1,extensions:[],async:!0,lineNumber:!0},importUrlExtension,imgExtension,markItExtension,emojiExtension)}mermaidInit(){const t={securityLevel:"loose",logLevel:4,startOnLoad:!1,gantt:{fontSize:19,sectionFontSize:"16",numberSectionStyles:10,useMaxWidth:!0},theme:getSettings().advanced.mermaidTheme};mermaid.parseError=n=>{},mermaid.initialize(t),mermaid.mermaidAPI.initialize(t)}hljsInit(){hljs.configure({ignoreUnescapedHTML:!0})}settingsAllInit(){this.markedInit(),this.mermaidInit(),this.hljsInit()}static newSettings(){return new this}}function allInit(e=window.editor,t=window.monaco,n){new settingsClass().settingsAllInit(),blankTextInit().then(async()=>{await mdConverter(),n&&n(),await kit.sleep(110),noteUseArco("已更新到最新版本","当前版本:v2.2.0"),await kit.sleep(780),noteUseArco("版本新增特性","文件管理器",{kind:"info"})}),window.deco=e.createDecorationsCollection(),window._speechData={processing:!1,speechResult:"",speech:null},preViewClickEvent(e,t,window.deco)}const defaultConfig={themeState:"light",fileManagerState:!1,emojiPickerState:"off",contextMenuClickPosition:{posx:20,posy:20},settingsConfig:{basic:{syncScroll:!1,speechLanguage:"zh-CN",fileEditLocal:!0},advanced:{mermaidTheme:"default"}}},normalSettingsKey=[...Object.keys(defaultConfig.settingsConfig.basic),...Object.keys(defaultConfig.settingsConfig.advanced)];Object.keys(defaultConfig.settingsConfig.advanced);const normalMermaidTheme=["default","forest","dark","neutral"],normalMermaidThemeMap=["default (默认，才是最美的！)","forest (说真的，很绿)","dark (说真的，很黑)","neutral (清心寡欲，出家必选)"];function configInit(e){function t(r){typeof n[r]=="object"?a.setItem(r,JSON.stringify(n[r])):a.setItem(r,n[r])}let n=e,a=new OperateLocalStorage;for(let r in n)if(a.getItem(r))if(r=="themeState"||r=="emojiPickerState"||r=="settingsConfig")try{if(typeof n[r]=="object"){const i=JSON.parse(a.getItem(r).toString());for(let o in i)Object.keys(i[o]).forEach(c=>{if(!normalSettingsKey.includes(c))return t(r),n});n[r]=JSON.parse(a.getItem(r).toString())}else n[r]=a.getItem(r).toString()}catch(i){console.log(i),t(r)}else t(r);else t(r);return n}const configStore=new ConfigStore(configInit(defaultConfig)),useConfig=()=>configStore;let opLocalStorage=new OperateLocalStorage;function changeTheme(e){e=="light"?(useConfig().themeState="light",opLocalStorage.setItem("themeState","light")):(useConfig().themeState="dark",opLocalStorage.setItem("themeState","dark"))}function getTheme(){return useConfig().themeState}function changeEmojiPickerState(e){e=="on"?(useConfig().emojiPickerState="on",opLocalStorage.setItem("emojiPickerState","on")):(useConfig().emojiPickerState="off",opLocalStorage.setItem("emojiPickerState","off"))}function getEmojiPickerState(){return useConfig().emojiPickerState}function setContextMenuClickPosition(e){if(e.posx&&e.posy)useConfig().contextMenuClickPosition=e;else return!1}function getContextMenuClickPosition(){return useConfig().contextMenuClickPosition}function changeSettings(e){const t=getSettings(),n=updateSettingsConfig(t,e);useConfig().settingsConfig=n,opLocalStorage.setItem("settingsConfig",JSON.stringify(n))}function getSettings(){return toJS(useConfig().settingsConfig)}function updateSettingsConfig(e,t){for(const n in t)n in e?Object.assign(e[n],t[n]):e[n]=t[n];return e}function changeFileManagerState(e){useConfig().fileManagerState=e}function getFileManagerState(){return useConfig().fileManagerState}const alertUseArco=(e,t,n)=>{const a=(n==null?void 0:n.zIndex)??9999,r=(n==null?void 0:n.kind)??"success";let i=document.getElementsByClassName("arco-message-wrapper arco-message-wrapper-top")[0];i?i.style.zIndex=String(a)??a:kit.addStyle(`.arco-message-wrapper .arco-message-wrapper-top{z-index:${a}}`),Message[r]({style:{position:"relative",zIndex:a},content:e,closable:!0,duration:t??2500,position:"top",...n==null?void 0:n.extraConfig})};async function save(e=null,t=!0){let n=getMdTextFromMonaco(),a="";if(t&&n!="null")try{fillInMemoryText(n),getSettings().basic.fileEditLocal?await new FileManager(window._fileHandle).saveFileSilently(n)?a="成功保存到本地！🎉":a="成功保存到浏览器！🎉(未打开本地文件)":a="成功保存到浏览器！🎉",alertUseArco(a)}catch{alertUseArco("你竟敢拒绝我。",2500,{kind:"error"})}else save()}async function isSaved(){return await readMemoryText().then(e=>{var t;return e?((t=e[0])==null?void 0:t.contentText)===getMdTextFromMonaco():!1})}class ImageStore{constructor(t){x(this,"displayState",!1);makeAutoObservable(this,{displayState:observable}),this.displayState=t}display(){this.displayState=!0}hidden(){this.displayState=!1}}const imageStore=new ImageStore(!1),useImage=()=>imageStore,React$k=window.React,StyledMenu=styled(e=>React$k.createElement(Menu,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...e}))(({theme:e})=>({"& .MuiPaper-root":{borderRadius:6,marginTop:e.spacing(1),color:e.palette.mode==="light"?"rgb(55, 65, 81)":e.palette.grey[300],"& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:20,color:e.palette.mode==="light"?"rgb(55, 65, 81)":e.palette.grey[300],marginRight:e.spacing(1.5)}}}}));function CloudMail(e,t,n){for(var a=document.getElementById("view-area"),r=window.getComputedStyle(a),i=0;i<r.length;i++){var o=r[i];r.getPropertyValue(o)}axios({url:e,method:t,data:n,headers:{"Content-Type":"application/json"}}).then(s=>{console.log(s)})}const React$j=window.React;function Share(e){let t=React$j.useRef(),[n,a]=React$j.useState(!1),r=o=>{a(()=>!1),e.onClick(o)},i=o=>{let c=t.current.value;CloudMail("https://service-g12i7wh1-1321514649.sh.apigw.tencentcs.com/release/mail","post",{to:c,subject:"Mailed from Markdown Online+",html:`<div class="markdown-body">${getRenderHTML()}</div>`,raw:0}),r(o),Notification.success({title:"邮件发送成功！",content:"Beta版本,请勿重复尝试",position:"topRight"}),Notification.info({title:"请注意,邮件发送暂时不能完全支持mermaid和Latex",content:"Beta版本,请勿重复尝试",position:"topRight"}),e.closAll()};return React$j.createElement(React$j.Fragment,null,React$j.createElement(Dialog,{fullWidth:!0,maxWidth:"sm",open:n,onClose:r},React$j.createElement(DialogTitle,null,"神奇邮箱"),React$j.createElement(DialogContent,null,React$j.createElement(DialogContentText,null,"请输入你要发送到的邮箱",React$j.createElement("br",null)),React$j.createElement(TextField,{inputRef:t,autoFocus:!0,margin:"dense",id:"name",label:"Email Address",type:"email",fullWidth:!0,variant:"standard"})),React$j.createElement(DialogActions,null,React$j.createElement(Button,{onClick:r},"取消"),React$j.createElement(Button,{onClick:i},"发送"))),React$j.createElement(default_1$1,null),"分享(开发中)",React$j.createElement(StyledMenu,{style:{width:"fitContent"},anchorOrigin:{vertical:-5,horizontal:12},id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:e.anchorEl,open:e.open,onClick:e.onClick},React$j.createElement(MenuItem,{onClick:o=>{o.stopPropagation(),a(!0)},disabled:!0,disableRipple:!0},React$j.createElement(default_1$2,null),"邮箱分享")))}function exportAsImage(e=3,t="markdown.jpeg"){let n=document.getElementById("view-area").innerHTML;window.document.body.innerHTML=`<div id="exportBox" style="width:64vw" class="markdown-body markdown-body-${getTheme()==="light"?"light":"dark"}">${n}</div>`,kit.sleep(250).then(()=>{html2canvas(document.getElementById("exportBox"),{scale:e}).then(a=>{let r=a.toDataURL("image/png",.6);var i=document.createElement("a");i.download=t,i.href=r,i.click()}),kit.sleep(2e3).then(()=>{window.location.reload()})})}function exportAsMd(){let e=getMdTextFromMonaco()??"";kit.sleep(250).then(()=>{var t=document.createElement("a");t.href="data:text/plain;charset=utf-8,"+encodeURIComponent(e),t.download="text.md",t.click()})}function myPrint(){kit.sleep(400).then(()=>{window.print()})}const React$i=window.React;function Export(e){let t=e.closeExportMenu;e.closeMenu;let[n,a]=React$i.useState(!1),r=l=>{console.log(l),t(l),a(()=>!1)},i=React$i.useRef();const[o,c]=React$i.useState(3),s=l=>{l.stopPropagation(),c(l.target.value)};let d=l=>{r(l);let m=i.current.value;exportAsImage(o??4,m??"md_snapshot.png"),e.closeMenu(l),noteUseArco("导出成功！","Beta版本",{kind:"info",position:"topRight"})};return React$i.createElement(React$i.Fragment,null,React$i.createElement(Dialog,{className:"avoid",onClose:r,open:n,fullWidth:!0,maxWidth:"sm"},React$i.createElement("div",{onClick:l=>{l.stopPropagation()}},React$i.createElement(DialogTitle,null,"导出设置"),React$i.createElement(DialogContent,null,React$i.createElement(DialogContentText,null,"请选择图片清晰度"),React$i.createElement("br",null),React$i.createElement(FormControl,{fullWidth:!0},React$i.createElement(Box$1,null,React$i.createElement(InputLabel,{id:"demo-simple-select-label"},"图片清晰度"),React$i.createElement(Select,{label:"图片清晰度",defaultValue:"4",defaultChecked:!0,fullWidth:!0,onChange:s},React$i.createElement(MenuItem,{value:"1"},"1 (比较模糊,体积轻巧)"),React$i.createElement(MenuItem,{value:"2"},"2 (有些模糊)"),React$i.createElement(MenuItem,{value:"4"},"3 (默认,适中,推荐)"),React$i.createElement(MenuItem,{value:"6"},"4 (比较清晰,体积稍大)"),React$i.createElement(MenuItem,{value:"10"},"5 (超鸡无敌霹雳霸清晰,体积较大)"))),React$i.createElement(Box$1,{marginX:"8px"},React$i.createElement(TextField,{inputRef:i,margin:"dense",id:"export_img_name",defaultValue:"md_snapshot.png",label:"导出的文件名",type:"text",fullWidth:!0,variant:"standard",placeholder:"md_snapshot.png"})))),React$i.createElement(DialogActions,null,React$i.createElement(Button,{onClick:r},"取消"),React$i.createElement(Button,{onClick:d},"确认导出")))),React$i.createElement(default_1$3,null),"导出",React$i.createElement(StyledMenu,{style:{width:"fitContent"},anchorOrigin:{vertical:-5,horizontal:12},id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:e.anchorEl,open:e.open,onClick:l=>{t(l)}},React$i.createElement(MenuItem,{onClick:()=>{myPrint()},disableRipple:!0},React$i.createElement(default_1$4,null),"导出为PDF"),React$i.createElement(MenuItem,{onClick:l=>{a(!0),t(l)},disableRipple:!0},React$i.createElement(default_1$5,null),"导出为图片(Beta1.0)"),React$i.createElement(MenuItem,{onClick:()=>{exportAsMd()},disableRipple:!0},React$i.createElement(default_1$6,null),"导出为Markdown")))}const React$h=window.React;function TransitionComponent(e){return React$h.createElement(Collapse,{...e})}const StyledTreeItem=styled(TreeItem)(({theme:e})=>({color:e.palette.mode==="light"?e.palette.grey[800]:e.palette.grey[200],[`& .${treeItemClasses.content}`]:{borderRadius:e.spacing(.5),padding:e.spacing(.5,1),margin:e.spacing(.2,0),[`& .${treeItemClasses.label}`]:{fontSize:"0.89rem",fontWeight:500}},[`& .${treeItemClasses.iconContainer}`]:{borderRadius:"80%",backgroundColor:e.palette.mode==="light"?alpha(e.palette.primary.main,.45):e.palette.primary.dark,color:e.palette.mode==="dark"&&e.palette.primary.contrastText,padding:e.spacing(0,1.2)}})),CustomTreeItem=React$h.forwardRef((e,t)=>React$h.createElement(StyledTreeItem,{...e,slots:{groupTransition:TransitionComponent,...e.slots},ref:t}));function SettingsRoute(){return React$h.createElement(React$h.Fragment,null,React$h.createElement(Box$1,{className:"transparent-scrollbar",sx:{overflow:"scroll",flex:"0 0 30%",minHeight:20,overflowX:"hidden",borderRight:"solid rgba(0, 0, 0, 0.12)"}},React$h.createElement(SimpleTreeView,{"aria-label":"customized",defaultExpandedItems:["1_x"],slots:{endIcon:default_1$7},sx:{userSelect:"none",minHeight:270,maxWidth:300}},React$h.createElement(CustomTreeItem,{slots:{endIcon:default_1$8},onClick:()=>{document.getElementById("settings_1_x").scrollIntoView()},itemId:"1_x",label:"基础设置"},React$h.createElement(CustomTreeItem,{slots:{endIcon:default_1$9},onClick:()=>{document.getElementById("settings_1_1").scrollIntoView()},itemId:"1_2",label:"主题设置"}),React$h.createElement(CustomTreeItem,{slots:{endIcon:default_1$8},onClick:()=>{document.getElementById("settings_1_2").scrollIntoView()},itemId:"1_3",label:"编辑器设置"})),React$h.createElement(CustomTreeItem,{itemId:"2_x",label:"高级设置"},React$h.createElement(CustomTreeItem,{itemId:"2_2",label:"导出设置"}),React$h.createElement(CustomTreeItem,{itemId:"2_3",label:"Mermaid设置"})))))}const React$g=window.React;function handleClick(e){e.preventDefault()}function IconBreadcrumbs(){return React$g.createElement(Box$1,{sx:{marginBottom:"5px"},role:"presentation",onClick:handleClick},React$g.createElement(Breadcrumbs,{"aria-label":"breadcrumb"},React$g.createElement(Link,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/"},React$g.createElement(default_1$a,{sx:{mr:.5},fontSize:"inherit"}),"MUI"),React$g.createElement(Link,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/material-ui/getting-started/installation/"},React$g.createElement(default_1$b,{sx:{mr:.5},fontSize:"inherit"}),"Basic"),React$g.createElement(Typography,{sx:{display:"flex",alignItems:"center"},color:"text.primary"},React$g.createElement(default_1$c,{sx:{mr:.5},fontSize:"inherit"}),"Theme")))}let MaterialUISwitch=styled(Switch)(({theme:e})=>({width:62,height:34,padding:7,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(22px)","& .MuiSwitch-thumb:before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M4.2 2.5l-.7 1.8-1.8.7 1.8.7.7 1.8.6-1.8L6.7 5l-1.9-.7-.6-1.8zm15 8.3a6.7 6.7 0 11-6.6-6.6 5.8 5.8 0 006.6 6.6z"/></svg>')`},"& + .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be"}}},"& .MuiSwitch-thumb":{backgroundColor:e.palette.mode==="dark"?"#003892":"#001e3c",width:32,height:32,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M9.305 1.667V3.75h1.389V1.667h-1.39zm-4.707 1.95l-.982.982L5.09 6.072l.982-.982-1.473-1.473zm10.802 0L13.927 5.09l.982.982 1.473-1.473-.982-.982zM10 5.139a4.872 4.872 0 00-4.862 4.86A4.872 4.872 0 0010 14.862 4.872 4.872 0 0014.86 10 4.872 4.872 0 0010 5.139zm0 1.389A3.462 3.462 0 0113.471 10a3.462 3.462 0 01-3.473 3.472A3.462 3.462 0 016.527 10 3.462 3.462 0 0110 6.528zM1.665 9.305v1.39h2.083v-1.39H1.666zm14.583 0v1.39h2.084v-1.39h-2.084zM5.09 13.928L3.616 15.4l.982.982 1.473-1.473-.982-.982zm9.82 0l-.982.982 1.473 1.473.982-.982-1.473-1.473zM9.305 16.25v2.083h1.389V16.25h-1.39z"/></svg>')`}},"& .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be",borderRadius:20/2}}));const React$f=window.React,IOSSwitch=styled(e=>React$f.createElement(Switch,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...e}))(({theme:e})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:e.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:e.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:e.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:e.transitions.create(["background-color"],{duration:500})}}));let speechRecognition=(e,t=!0,n)=>{const a=new webkitSpeechRecognition||new SpeechRecognition;let r=!1;return a.lang=e,a.continuous=!0,a.interimResults=!1,t&&a.start(),a.onstart=()=>{r=!0},a.onresult=i=>{let o=i.results[i.results.length-1][0].transcript;o=o.replace(/ /g,""),window._speechData.speechResult=o,n(o.length),r===!1&&a.stopRecognition()},a.onerror=function(i){i.error=="not-allowed"?alertUseArco("语音权限被拒绝，世界，拒绝了我...",4500):console.log("语音识别错误:",i.error)},a.onend=()=>{console.log(r),r&&a.start()},a.stopRecognition=()=>{a.stop(),r=!1},{recognition:a,recognizing:r}};const speechLanguageMap=[["zh-CN","普通话"],["en-US","English"],["ja-JP","日本語"],["fr-ch","法语（瑞士）"],["ko","韩语"]],React$e=window.React,SettingsBody=observer(function e(){const t=getTheme(),n=useTheme(),a={transition:"0.3s",position:"relative",padding:"5px",borderRadius:"3px",display:"flex",flexDirection:"column",mt:"10px",mb:"5px",ml:"0px",pl:"25px","&::before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:4,backgroundColor:"transparent",transition:"background-color 0.3s"},"&:hover::before":{backgroundColor:t==="light"?"#840084":"#d2d2d2"},"&:hover":{backgroundColor:t==="light"?"#E7E6E5":""}},r={color:n.palette.info.contrastText??"#8B8A8A",fontSize:"0.79rem",fontWeight:500,mb:"5px"},[i,o]=React$e.useState(!1);function c(m,u){const h=document.querySelector(".markdown-body");u?(changeTheme("dark"),o(m.target.checked),console.log(h.style.cssText),h.style.cssText=""):(changeTheme("light"),o(m.target.checked),console.log(h.style.cssText))}function s(m,u){changeSettings(u?{basic:{syncScroll:!0}}:{basic:{syncScroll:!1}})}function d(m){changeSettings({basic:{speechLanguage:m.target.value}})}function l(m){changeSettings({advanced:{mermaidTheme:m.target.value}}),mermaid.init({theme:m.target.value}),mdConverter()}return React$e.useEffect(()=>{o(getTheme()==="dark")},[getTheme()]),React$e.createElement(React$e.Fragment,null,React$e.createElement(Box$1,{className:"transparent-scrollbar",sx:{width:"100%",padding:"1rem",display:"flex",flexDirection:"column",fontSize:"0.89rem",maxHight:"200px",overflowY:"scroll"}},React$e.createElement(Typography,{id:"settings_1_x",sx:{fontSize:"30px",fontWeight:"700"}},"基础设置"),React$e.createElement(Divider,null),React$e.createElement(Box$1,{sx:a},React$e.createElement(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500}},"Theme"),React$e.createElement(Typography,{sx:r},"更改编辑器的主题"),React$e.createElement(MaterialUISwitch,{checked:i,size:"small",inputProps:{"aria-label":"controlled"},onChange:c})),React$e.createElement(Box$1,{sx:a},React$e.createElement(Box$1,{className:"FLEX ROW"},React$e.createElement(Typography,{id:"settings_1_2",sx:{fontSize:"0.89rem",fontWeight:500}},"Synchronous Scrolling")),React$e.createElement(Typography,{sx:r},"同步滚动左边编辑区和预览区域。(开发中)"),React$e.createElement(IOSSwitch,{checked:getSettings().basic.syncScroll,size:"small",inputProps:{"aria-label":"controlled"},onChange:s})),React$e.createElement(Box$1,{sx:a},React$e.createElement(Typography,{sx:{fontSize:"0.89rem",fontWeight:500}},"Speech To Text"),React$e.createElement(Typography,{sx:r},"选择语音转文字的识别语言"),React$e.createElement(Select,{value:getSettings().basic.speechLanguage??"zh-CN",defaultChecked:!0,fullWidth:!0,size:"small",onChange:d},speechLanguageMap.map((m,u)=>React$e.createElement(MenuItem,{key:u,value:m[0]},m[1])))),React$e.createElement(Typography,{id:"settings_1_x",sx:{mt:"20px",fontSize:"30px",fontWeight:"700"}},"高级设置（施工中）"),React$e.createElement(Divider,null),React$e.createElement(Box$1,{sx:a},React$e.createElement(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500}},"Export Settings"),React$e.createElement(Typography,{sx:r},"更改导出设置(施工中)"),React$e.createElement(IOSSwitch,{disabled:!0,size:"small",inputProps:{"aria-label":"controlled"}})),React$e.createElement(Box$1,{sx:a},React$e.createElement(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500}},"Mermaid Theme Configs"),React$e.createElement(Typography,{sx:r},"Mermaid流程图主题"),React$e.createElement(Select,{value:getSettings().advanced.mermaidTheme??"default",defaultChecked:!0,fullWidth:!0,size:"small",color:"primary",onChange:l},normalMermaidTheme.map((m,u)=>React$e.createElement(MenuItem,{key:u,value:m},normalMermaidThemeMap[u]))))))}),React$d=window.React;function Settings(e){useTheme().palette;const t=getTheme();React$d.useRef();let[n,a]=React$d.useState(!1);React$d.useState("");let r=i=>{a(()=>!1),e.onClick(i),e.closeAll()};return React$d.useEffect(()=>{}),React$d.createElement(React$d.Fragment,null,React$d.createElement(Dialog,{fullScreen:!1,maxWidth:!1,open:e.open,onClose:r,sx:{height:"100vh"}},React$d.createElement(Box$1,{sx:{background:t==="light"?"#F8FAFB":"",padding:"1rem",height:"58vh",width:"60vw"}},React$d.createElement(IconBreadcrumbs,null),React$d.createElement(Divider,{sx:{my:.5}}),React$d.createElement(Box$1,{sx:{height:"48vh",display:"flex",background:t==="light"?"#F8FAFB":"",padding:"5px",flexDirection:"row",borderRradius:"50px",borderRadius:"5px"}},React$d.createElement(SettingsRoute,null),React$d.createElement(SettingsBody,null)))),React$d.createElement(default_1$7,null),"设置")}const React$c=window.React,CustomizedMenus=observer(()=>{const e=useImage(),[t,n]=React$c.useState(null),[a,r]=React$c.useState(null),[i,o]=React$c.useState(null),[c,s]=React$c.useState(null),[d,l]=React$c.useState(!1),m=!!t,u=!!a,h=!!i,R=!!c,y=f=>{n(f.currentTarget)},$=f=>{r(f.currentTarget),f.stopPropagation()},w=async f=>{await isSaved()?(o(f.target),f.stopPropagation()):(f.stopPropagation(),g(),l(!0))},b=f=>{s(f.currentTarget)},g=()=>{n(null)},p=f=>{r(null),f.stopPropagation()},E=f=>{o(null),f.stopPropagation()},k=f=>{s(null),f.stopPropagation()},v=()=>{e.display(),g()},S=()=>{changeFileManagerState(!0),g()};return React$c.createElement("div",null,React$c.createElement(Dialog,{open:d,onClose:()=>{l(!1)}},React$c.createElement(DialogTitle,null,React$c.createElement(Typography,{variant:"h6",gutterBottom:!0},"确定导出吗，你还没有保存呢！")),React$c.createElement(DialogContent,null,React$c.createElement(DialogContentText,null,React$c.createElement(Typography,{variant:"body1",gutterBottom:!0},'Once you have clicked the "yes" button, your text will be saved.'))),React$c.createElement(DialogActions,null,React$c.createElement(Button,{onClick:()=>{l(!1),save(),myPrint()}},"是嘟"),React$c.createElement(Button,{onClick:()=>{l(!1)},autoFocus:!0},"达咩"))),React$c.createElement(CustomizedButtons,{open:m,endIcon:React$c.createElement(default_1$d,null),onClick:y},"更多"),React$c.createElement(StyledMenu,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:t,open:m,onClose:g},React$c.createElement(MenuItem,{onClick:v,disableRipple:!0},React$c.createElement(default_1$8,null),"图片管理器"),React$c.createElement(MenuItem,{onClick:S,disableRipple:!0},React$c.createElement(default_1$e,null),"文件管理器(实验性)"),React$c.createElement(MenuItem,{onClick:f=>{w(f)},disableRipple:!0},React$c.createElement(Export,{anchorEl:i,open:h,closeMenu:g,closeExportMenu:E})),React$c.createElement(Divider,{sx:{my:.5}}),React$c.createElement(MenuItem,{onClick:f=>{$(f)},disableRipple:!0},React$c.createElement(Share,{closAll:g,anchorEl:a,open:u,onClick:p})),React$c.createElement(MenuItem,{onClick:f=>{b(f)},disableRipple:!0},React$c.createElement(Settings,{closeAll:g,anchorEl:c,open:R,onClick:k})),React$c.createElement(MenuItem,{onClick:()=>{g()},disableRipple:!0},React$c.createElement(default_1$f,null),"更多(敬请期待)  ")))});function insertTextMonacoAtCursor(e,t,n=window.editor,a=window.monaco){const r=window.editor,i=e,o=window.editor.getSelections()[0];r.executeEdits("img-insert",[{range:new window.monaco.Range(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn),text:i,forceMoveMarkers:t}])}function writeClipboard(e){navigator.clipboard.writeText(e).catch(t=>{console.error("Failed to copy text: ",t)})}const React$b=window.React,_MagicImg=React$b.forwardRef(MagicImg);function MagicImg(e,t){let n="FLEX JUS-CENTER ",a={width:"fitContent"};const[r,i]=React$b.useState(!1);function o(d){d.altKey&&writeClipboard(`![我是图片](/vf/${e.uuid})`),d.ctrlKey&&insertTextMonacoAtCursor(`![我是图片](/vf/${e.uuid})`,!0)}let[c,s]=React$b.useState({src:e.src,uuid:e.uuid,magic:e.magic!=0,className:n+(e.className??""),style:e.style?{...e.style,...a}:a});return React$b.createElement(React$b.Fragment,null,React$b.createElement("div",{...c,...e,ref:t,className:c.className,style:c.style},React$b.createElement(PhotoProvider,null,React$b.createElement(PhotoView,{triggers:["onDoubleClick"],src:c.src},React$b.createElement(Tooltip,{placement:"right",TransitionComponent:Zoom,arrow:!0,title:"按住Ctrl点击插入"},React$b.createElement("img",{onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},onClick:d=>{o(d)},style:{width:"70%",transition:" 0.2s ease-in-out",borderRadius:"5px",transform:r?"translate(0px, -2px)":"",boxShadow:r?"1vh 2vh 21px rgb(79 79 79)":"rgb(216 216 216) 1vh 2vh 21px"},src:c.src,alt:"error"}))))))}const React$a=window.React;function LR(e){const t=React$a.Children.toArray(e.children).length;let n="LR ",a={display:"flex",flexDirection:"row",justifyContent:e.jus??"center",alignItems:e.ali??"center",width:"100%",height:"100%"},[r,i]=React$a.useState({style:e.style?{...e.style,...a}:a,className:n+(e.className??""),space:e.space??void 0,order:[]}),[o,c]=React$a.useState({marginRight:"5px",width:"100%",height:"100%"});return React$a.createElement(React$a.Fragment,null,React$a.createElement("div",{...r,...e,className:r.className,style:r.style},React$a.Children.map(e.children,(s,d)=>d==t-1?React$a.createElement("div",{style:{...o,flex:r.space?"auto":void 0}},s):React$a.createElement("div",{style:{...o,order:`${r.order[d]}`,flex:`0 0 ${r.space?r.space[d]:void 0}%`}},s))))}const React$9=window.React;function Box(e){var i,o;let t="Box ",n={display:"flex",flexDirection:e.dir??"row",justifyContent:e.jus??"center",alignItems:e.ali??"center",width:e.min==1?"fitContent":"100%",height:e.min==1?"fitContent":"100%",transform:e.move?`translate(${((i=e.move)==null?void 0:i.x)??0}, ${((o=e.move)==null?void 0:o.y)??0})`:void 0},[a,r]=React$9.useState({style:e.style?{...e.style,...n}:n,className:t+(e.className??""),space:e.space??void 0,order:[]});return React$9.createElement(React$9.Fragment,null,React$9.createElement("div",{...a,...e,className:a.className,style:a.style},e.children))}function deleteDBAll(e){let t=window.indexedDB.deleteDatabase(e);t.onerror=function(n){console.log("删除失败")},t.onsuccess=function(n){console.log("删除成功")}}const React$8=window.React,theme=createTheme({palette:{primary:{main:"#1976d2"},secondary:purple}}),TemporaryDrawer=observer(e=>{const t=useImage(),[n,a]=React$8.useState(!1),[r,i]=React$8.useState([]),[o,c]=React$8.useState(!1);function s(){c(!0)}return React$8.useEffect(()=>{readAllMemoryImg().then(d=>{i(d)})}),React$8.useEffect(()=>{a(t.displayState)},[t.displayState]),React$8.createElement(React$8.Fragment,null,React$8.createElement(Dialog,{open:o,onClose:()=>{c(!1)}},React$8.createElement(DialogTitle,{id:"alert-dialog-title"},"Ready to delete all the images?"),React$8.createElement(DialogContent,null,React$8.createElement(DialogContentText,{id:"alert-dialog-description"},'Once you have clicked the "yes" button, your pictures and your text will be deleted!')),React$8.createElement(DialogActions,null,React$8.createElement(Button,{onClick:()=>{c(!1),deleteDBAll("md_content"),window.location.reload()}},"YES"),React$8.createElement(Button,{onClick:()=>{c(!1)},autoFocus:!0},"NO"))),React$8.createElement(Drawer,{anchor:"bottom",open:n,elevation:16,onClose:()=>{t.hidden()}},React$8.createElement("div",{style:{height:"60svh"}},React$8.createElement("div",null,React$8.createElement(ThemeProvider,{theme},React$8.createElement(Box,null,React$8.createElement(LR,{space:[90]},React$8.createElement(Box,{min:1,move:{x:"5svw"}},React$8.createElement("p",null,"图片管理器"),React$8.createElement(Tooltip,{title:React$8.createElement("div",null,"管理粘贴上传的图片",React$8.createElement("ul",{style:{margin:"2px"}},React$8.createElement("li",null,"按住Ctrl点击图片插入"),React$8.createElement("li",null,"双击图片放大预览"),React$8.createElement("li",null,"按住Alt点击图片复制图片")))},React$8.createElement(IconButton,null,React$8.createElement(default_1$g,{color:"primary"})))),React$8.createElement(Box,null,React$8.createElement(Tooltip,{title:"删除全部图片和储存的文字"},React$8.createElement(IconButton,{onClick:s},React$8.createElement(default_1$h,{color:"primary"})))))))),React$8.createElement(Divider,{style:{marginBottom:"1.3svh"}}),React$8.createElement(Grid,{container:!0,rowSpacing:5,columns:16},r?r.map((d,l)=>React$8.createElement(Grid,{id:d.uuid,key:d.uuid,xs:8},React$8.createElement(_MagicImg,{magic:0,src:d.imgBase64,uuid:d.uuid}))):void 0))))}),svg_1=""+new URL("../2904f250.aboutBox关闭.svg",import.meta.url).href;let aboutMd;const aboutBox=async()=>{let e=`
<div class="closeBox" id="closeAbout">
<img id="closeAboutSvg" class="closeSvg" src=${svg_1} alt="">
</div>
`;await fetch("https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/source/assets/about.md").then(async n=>{aboutMd=n.text(),document.getElementById("aboutMd")&&(document.getElementById("aboutMd").innerHTML=e+t(await aboutMd))}).catch(n=>{console.error("Error fetching markdown:",n)});function t(n){return markdownParser().render(n)}document.getElementById("closeAboutSvg").addEventListener("click",()=>{document.getElementById("aboutBox").style.display="none"}),document.getElementById("aboutBox").addEventListener("click",n=>{n.target==document.getElementById("markdownParser")&&(document.getElementById("aboutBox").style.display="none")}),document.getElementById("aboutBox").style.display="block"};function replaceMonacoAll(e,t,n=""){const a=t??window.editor,r=e.editor.getEditors()[0].getModel().getFullModelRange();a.executeEdits("my-replace2",[{range:r,text:n,forceMoveMarkers:!0}])}const React$7=window.React,fileManager=new FileManager,FileDrawer=observer(function e(){const[t,n]=React$7.useState(""),a=useTheme(),r=o=>()=>{changeFileManagerState(o)},i=(o,c)=>{changeSettings({basic:{fileEditLocal:c}})};return React$7.createElement(React$7.Fragment,null,React$7.createElement(Drawer,{sx:{"& .MuiBackdrop-root":{backgroundColor:"transparent"}},anchor:"right",open:getFileManagerState(),onClose:r(!1)},React$7.createElement(Box$1,{sx:{padding:"20px",width:"26svw",display:"flex",alignItems:"center",justifyContent:"center",height:"100svh",flexDirection:"column"}},React$7.createElement(Box$1,{className:"FLEX COL"},React$7.createElement(Typography,null,getSettings().basic.fileEditLocal?t:""),React$7.createElement(Button,{sx:{mb:"10px"},onClick:async()=>{try{const o=await fileManager.openSingleFile();if(n((o==null?void 0:o.name)??""),o){alertUseArco("正在打开本地文件，别急，你给我等会😅");const c=await fileManager.readFile();c&&(replaceMonacoAll(window.monaco,window.editor,c),alertUseArco(`打开${o==null?void 0:o.name}成功！😀`))}else alertUseArco("左顾右盼，活在梦幻?",2500,{kind:"warning"})}catch{alertUseArco("尼玛的报错乐🤣",2e3,{kind:"error"})}},variant:"contained",color:"primary"},"打开文件"),React$7.createElement(Button,{sx:{mb:"10px"},variant:"contained",onClick:()=>{fileManager.saveAsFile(getMdTextFromMonaco())}},"另存为"),React$7.createElement(Box$1,{className:"FLEX COW ALI-CEN"},React$7.createElement(Typography,{sx:{mr:"10px",fontSize:"17px"},color:a.palette.info.contrastText},"同步本地编辑"),React$7.createElement(IOSSwitch,{checked:getSettings().basic.fileEditLocal,size:"small",inputProps:{"aria-label":"controlled"},onChange:i}))))))}),React$6=window.React,runTo=(e,t)=>{kit.sleep(t).then(()=>{window.location.href=e})},handleHomeClick=()=>{runTo("https://bigonion.cn",300)},boxShadow="0px 2px 4px -1px rgba(0,0,0,0.2), 0px 4px 5px 0px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12);",drawerWidth=240,DrawerAppBar=observer(e=>{const t=useTheme(),{window:n}=e,[a,r]=React$6.useState(!1),i=()=>{r(d=>!d)},o=n!==void 0?()=>n().document.body:void 0;React$6.useState(!1);const c=()=>{Message.info({content:"此功能仍然在开发中",closable:!0,duration:3e3,position:"bottom"})},s=React$6.createElement(Box$1,{onClick:i,sx:{textAlign:"center",height:"100%",bgcolor:"black"}},React$6.createElement(Typography,{variant:"h1",sx:{fontSize:"20px",my:2,color:"wheat",textAlign:"center",boxShadow}},"Markdown+ Online View"),React$6.createElement(List,{sx:{height:"100%",bgcolor:"background.paper"}},React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:handleHomeClick},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$a,null))),React$6.createElement(ListItemText,{primary:"Home",secondary:""}))),React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:c},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$l,null))),React$6.createElement(ListItemText,{primary:"Photos",secondary:""}))),React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:myPrint},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$m,null))),React$6.createElement(ListItemText,{primary:"Export",secondary:""}))),React$6.createElement(ListItem,null,React$6.createElement(ListItemButton,{onClick:()=>{aboutBox()}},React$6.createElement(ListItemAvatar,null,React$6.createElement(Avatar,null,React$6.createElement(default_1$n,null))),React$6.createElement(ListItemText,{primary:"About",secondary:""})))));return React$6.createElement(React$6.Fragment,null,React$6.createElement("div",{className:"FLEX header-app-bar",style:{flex:"0 0 8.7vh"}},React$6.createElement(CssBaseline,null),React$6.createElement(AppBar,{component:"nav",sx:{position:"inherit",justifyContent:"center",zIndex:100,height:"8.7vh",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"}},React$6.createElement(Toolbar,null,React$6.createElement(IconButton,{color:"inherit",onClick:i,sx:{mr:200,display:{sm:"none"}}},React$6.createElement(default_1$i,null)),React$6.createElement(default_1$j,{sx:{color:t.palette.mode=="light"?"black":"white",display:{xs:"none",md:"flex"},transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",mr:1}}),React$6.createElement(Typography,{variant:"h1",component:"a",fontFamily:"monospace",href:"/",sx:{flexGrow:1,display:{xs:"none",sm:"block"},color:t.palette.mode==="light"?t.palette.primary.contrastText:t.palette.secondary.contrastText,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",textDecoration:"none"}},React$6.createElement("h1",{style:{fontSize:"28px"}},"Markdown+ Online View")),React$6.createElement(Box$1,{sx:{display:{xs:"none",sm:"flex",flexDirection:"row"}}},React$6.createElement(CustomizedButtons,{href:"https://bigonion.cn",startIcon:React$6.createElement(default_1$k,null)},"首页"),React$6.createElement(CustomizedButtons,{onClick:()=>{aboutBox()},startIcon:React$6.createElement(default_1$g,null)},"关于"),React$6.createElement(CustomizedMenus,null),React$6.createElement(TemporaryDrawer,null),React$6.createElement(FileDrawer,null)))),React$6.createElement(Box$1,{sx:{display:{xs:"flex",sm:"none"}},component:"nav"},React$6.createElement(Drawer,{container:o,variant:"temporary",open:a,onClose:i,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:drawerWidth}}},s))))});function exeSyncScrollAction(e,t){if(getSettings().basic.syncScroll)alertUseArco("同步滚动已关闭 🧐 ",2e3),changeSettings({basic:{syncScroll:!1}});else{alertUseArco("同步滚动已开启 😍 ",2e3);const n=e.getScrollTop();e.setScrollTop(n+.3),e.setScrollTop(n-.3);const a=e.getVisibleRanges();if(a.length>0){const i=a[0].startLineNumber,o=document.getElementById("view-area");i==1&&o.scrollTo({top:0,behavior:"smooth"})}changeSettings({basic:{syncScroll:!0}})}}function exeFileManagerAction(e,t){getFileManagerState()?changeFileManagerState(!1):changeFileManagerState(!0)}function enableFastKeyEvent(){document.addEventListener("keydown",e=>{e.ctrlKey&&e.key=="q"&&(e.stopPropagation(),e.preventDefault(),exeSyncScrollAction(window.editor)),e.ctrlKey&&(e.altKey||e.shiftKey)&&e.key=="f"&&(e.stopPropagation(),e.preventDefault(),exeFileManagerAction()),e.ctrlKey&&e.key=="s"&&(e.stopPropagation(),e.preventDefault(),save()),e.ctrlKey&&e.key=="b"},!0)}function monacoPasteEvent(e,t){e.getContainerDomNode().addEventListener("paste",n=>{handlePasteEvent(n).then(a=>{if(a){let r="",i=new Date().getTime();console.log(a);for(let o=0;o<=a.length-1;o++)console.log(o),r+=`![我是图片](/vf/${i+o})`;fillInMemoryImgs(a,i),insertTextMonacoAtCursor(r,!0)}})},!0)}function handlePasteEvent(e){return new Promise(t=>{let a=(e.clipboardData||window.clipboardData).items;const r=a.length;let i=[];for(let o=0;o<a.length;o++){let c=a[o];if(c.kind=="file"){e.preventDefault(),e.stopPropagation();let s=c.getAsFile(),d=new FileReader;d.onload=function(m){i.push(m.target.result),o===r-1&&t(i)};const l=s.type.split("/")[1];(l==="png"||l==="jpg"||l==="jpeg"||l==="webp"||l==="svg")&&d.readAsDataURL(s)}else t([])}})}let lock=!1,triggerTime=0;function triggerConverterEvent(e=2){let t,n;triggerTime++,lock?(clearTimeout(t),t=setTimeout(function(){mdConverter(),triggerTime=0},300)):(clearTimeout(n),triggerTime>=e?(lock=!0,mdConverter(),n=setTimeout(()=>{lock=!1,triggerTime=0},200)):mdConverter())}function getCommandPaletteText(){return document.getElementsByClassName("ibwrapper")[0]?document.getElementsByClassName("ibwrapper")[0].children[0].value:""}function exeTableAction(){const e=getCommandPaletteText().split("#")[1],t=getCommandPaletteText().split("#")[2];insertTextMonacoAtCursor(generateMarkdownTable(e,t),!0)}function generateMarkdownTable(e,t){if(!e||!t)return"";let n="| ";for(let a=0;a<t;a++)n+=`Header  ${a+1} | `;n+=`
|`;for(let a=0;a<t;a++)n+="--- | ";for(let a=0;a<e;a++){n+=`
| `;for(let r=0;r<t;r++)n+=` Cell ${a+1}-${r+1} | `}return n}function exeInsertPageBreakerAction(){insertTextMonacoAtCursor(`|---|
`,!0)}function exeLatexBlockAction(e,t){const n=e.getPosition();n.column==1&&(insertTextMonacoAtCursor(`$$

$$`,!0),e.setPosition({column:1,lineNumber:n.lineNumber+1}))}function exeEmojiPickerAction(e,t){getEmojiPickerState()==="on"?changeEmojiPickerState("off"):changeEmojiPickerState("on")}function exeSpeechPanelAction(e,t){const n=getSettings().basic.speechLanguage??"zh-CN";let a=r=>{insertTextMonacoAtCursor(window._speechData.speechResult,!0)};if(window._speechData.processing)alertUseArco("语音识别已关闭，嗯你闭嘴吧，我不听...",2e3),window._speechData.processing=!1,window._speechData.speech.stopRecognition(),window._speechData.speech=null,window._speechData.speechResult="";else{alertUseArco("语音识别已开启，嗯你说，我在听...",3e3),window._speechData.processing=!0;let{recognition:r}=speechRecognition(n,!0,a);window._speechData.speech=r}}function exeBoldAction(e,t){const n=e.getSelection();let r=e.getModel().getValueInRange(n),i;r.startsWith("**")&&r.endsWith("**")?i=r.slice(2,-2):i=`**${r}**`;var c=new t.Range(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn);if(e.executeEdits("my-source",[{range:c,text:i,forceMoveMarkers:!1}]),i!==r){const s=new t.Selection(n.startLineNumber,n.startColumn,n.endLineNumber,n.startColumn+i.length);e.setSelection(s)}}function exeAlignRightAction(e,t){const n=e.getSelection(),a=e.getModel(),r=n.startLineNumber,i=a.getLineContent(r),o=i.length;let c="",s=o+1,d=o+1;const l=i.slice(-2);l===">>"?(c="",s=o-1):l==="||"?(c=">>",s=o-1):c=">>";const m=new t.Range(r,s,r,d);e.executeEdits("my-source",[{range:m,text:c,forceMoveMarkers:!0}]);const u=new t.Selection(r,s+c.length,r,s+c.length);e.setSelection(u)}function exeAlignCenterAction(e,t){const n=e.getSelection(),a=e.getModel(),r=n.startLineNumber,i=a.getLineContent(r),o=i.length;let c="",s=o+1,d=o+1;const l=i.slice(-2);l==="||"?(c="",s=o-1):l===">>"?(c="||",s=o-1):c="||";const m=new t.Range(r,s,r,d);e.executeEdits("my-source",[{range:m,text:c,forceMoveMarkers:!0}]);const u=new t.Selection(r,s+c.length,r,s+c.length);e.setSelection(u)}function monacoKeyEvent(e,t){const n={save:t.KeyMod.CtrlCmd|t.KeyCode.KeyS,quotation:t.KeyMod.Shift|t.KeyCode.Quote,format:t.KeyMod.Shift|t.KeyCode.KeyF,pageBreaker:t.KeyMod.CtrlCmd|t.KeyMod.Alt|t.KeyCode.Enter,latexBlock:t.KeyMod.CtrlCmd|t.KeyCode.KeyM,voice2Words:t.KeyMod.CtrlCmd|t.KeyMod.Alt|t.KeyCode.KeyV,syncScroll:t.KeyMod.CtrlCmd|t.KeyCode.KeyQ,fileManager:t.KeyMod.CtrlCmd|t.KeyMod.Shift|t.KeyCode.KeyF,markdownTextEditFastKey:{bold:t.KeyMod.CtrlCmd|t.KeyCode.KeyB,italics:t.KeyMod.CtrlCmd|t.KeyCode.KeyI,underline:t.KeyMod.CtrlCmd|t.KeyCode.KeyU,alignCenter:t.KeyMod.CtrlCmd|t.KeyCode.KeyE,alignRight:t.KeyMod.CtrlCmd|t.KeyCode.KeyR}};e.addAction({id:"show.emojiPicker",label:"打开表情包超市 🤪",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:-100,run:()=>{exeEmojiPickerAction()}}),e.addAction({id:"insert.tableAny",label:"插入任意行和列,格式: table#x#x",keybindings:[],run:()=>{exeTableAction()}}),e.addAction({id:"reload-no-cache",label:"强制刷新Markdown在线",keybindings:[],run:()=>{window.location.reload(!0)}}),e.addAction({id:"export.asPDF",label:"保存并导出为PDF",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:0,run:async()=>{await isSaved()?myPrint():(save(),kit.sleep(800).then(()=>{myPrint()}))}}),e.addAction({id:"export.asImg",label:"作为PNG格式的图片导出",keybindings:[],run:()=>{exportAsImage()}}),e.addAction({id:"insert.pageBreaker",label:"插入一个分页符",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:0,run:()=>{exeInsertPageBreakerAction()}}),e.addAction({id:"insert.latexBlock",label:"插入一个LaTex语法块",keybindings:[n.latexBlock],contextMenuGroupId:"navigation",contextMenuOrder:0,run:()=>{exeLatexBlockAction(e)}}),e.addAction({id:"insert.voice2words",label:"语音转文字...嘟...喂...听得见吗....",keybindings:[n.voice2Words],contextMenuGroupId:"navigation",contextMenuOrder:1,run:()=>{exeSpeechPanelAction()}}),e.addAction({id:"command.syncScroll",label:"同步滚动 (开启/关闭)",keybindings:[n.syncScroll],contextMenuGroupId:"navigation",run:()=>{exeSyncScrollAction(e)}}),e.addAction({id:"command.fileManagerState",label:"文件管理器 (开启/关闭)",keybindings:[n.fileManager],contextMenuGroupId:"navigation",run:()=>{exeFileManagerAction()}}),e.addAction({id:"insert.bold",label:"加粗文本",keybindings:[n.markdownTextEditFastKey.bold],contextMenuGroupId:"navigation",run:()=>{exeBoldAction(e,t)}}),e.addAction({id:"insert.alignRight",label:"文本居右",keybindings:[n.markdownTextEditFastKey.alignRight],contextMenuGroupId:"navigation",run:()=>{exeAlignRightAction(e,t)}}),e.addAction({id:"insert.alignCenter",label:"文本居中",keybindings:[n.markdownTextEditFastKey.alignCenter],contextMenuGroupId:"navigation",run:()=>{exeAlignCenterAction(e,t)}}),e.addAction({id:"reload",label:"重新加载窗口(Reload Window)",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:100,run:()=>{window.location.reload()}})}function monacoSnippets(e,t){t.languages.registerCompletionItemProvider("markdown",{provideCompletionItems:(n,a,r)=>{const i=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:a.lineNumber,endColumn:a.column});if(!isInLatexBlock(i)&&a.column===2)return{suggestions:[{label:"clg",kind:t.languages.CompletionItemKind.Function,insertText:"console.log(${1:val})",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"调试..."},{label:"code",kind:t.languages.CompletionItemKind.Function,insertText:"\n```${1:js}\n${2:}\n```\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"code"},{label:"table 2x2",kind:t.languages.CompletionItemKind.Function,insertText:"\n|${1:}    |${1:}     |\n|--- |---  |\n|${1:}    |${1:}     |\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"table 2x2"},{label:"table 2x4",kind:t.languages.CompletionItemKind.Function,insertText:"\n|${1:}    |${1:}    |${1:}    |${1:}    |\n|--- |--- |--- |--- |\n|${1:}    |${1:}    |${1:}    |${1:}    |\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"table 2x4"},{label:"ignore",kind:t.languages.CompletionItemKind.Field,insertText:"<!-- prettier-ignore -->",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"ignore prettier"},{label:"ignore-block",kind:t.languages.CompletionItemKind.Field,insertText:`<!-- prettier-ignore-start -->
\${1:}
<!-- prettier-ignore-end -->`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"ignore block"},{label:"latex-block",kind:t.languages.CompletionItemKind.Field,insertText:`$$
\${1:}
$$
`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"Create A LaTex Block"},{label:"latex-inline",kind:t.languages.CompletionItemKind.Field,insertText:"$${1:}$",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"Create A LaTex Inline"}]}}}),t.languages.registerCompletionItemProvider("markdown",{triggerCharacters:["\\"],provideCompletionItems:(n,a,r)=>{const i=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:a.lineNumber,endColumn:a.column});if(isNeedToUseLatexIntellisense(i)){const o=Array.from([...delimiters0,...delimeterSizing0,...greekLetters0,...otherLetters0,...spacing0,...verticalLayout0,...logicAndSetTheory0,...macros0,...bigOperators0,...binaryOperators0,...binomialCoefficients0,...fractions0,...mathOperators0,...relations0,...negatedRelations0,...arrows0,...font0,...size0,...style0,...symbolsAndPunctuation0,...debugging0],(l,m)=>({label:`\\${l}`,kind:t.languages.CompletionItemKind.Function,insertText:l,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(l[0])?"1":"0"})),c=Array.from([...accents1,...annotation1,...verticalLayout1,...overlap1,...spacing1,...logicAndSetTheory1,...mathOperators1,...sqrt1,...extensibleArrows1,...font1,...braketNotation1,...classAssignment1],(l,m)=>({label:`\\${l}`,kind:t.languages.CompletionItemKind.Function,insertText:`${l}{$1}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(l[0])?"1":"0"})),s=Array.from([...verticalLayout2,...binomialCoefficients2,...fractions2,...color2],(l,m)=>({label:`\\${l}`,kind:t.languages.CompletionItemKind.Function,insertText:`${l}{$1}{$2}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(l[0])?"1":"0"})),d=[{label:"\\begin",kind:t.languages.CompletionItemKind.Function,insertText:"begin{${1|"+envs.join(",")+`|}}
	$2
\\end{$1}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet}];return{suggestions:[...o,...c,...s,...d]}}}}),t.languages.registerCompletionItemProvider("markdown",{triggerCharacters:["^"],provideCompletionItems:(n,a,r)=>{const i=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:a.lineNumber,endColumn:a.column});if(isNeedToUseClueIntellisense(i))return{suggestions:[{label:"RED",kind:t.languages.CompletionItemKind.Function,insertText:"RED",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"RED..."},{label:"PINK",kind:t.languages.CompletionItemKind.Function,insertText:"PINK",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"PINK..."}]}}})}function isNeedToUseLatexIntellisense(e){return!!(e[e.length-1]==="\\"&&isInLatexBlock(e))}function isInLatexBlock(e){return(e.match(/\$\$/g)?e.match(/\$\$/g).length%2===1:!1)||(e.match(/\$/g)?e.match(/\$/g).length%2===1:!1)}function isNeedToUseClueIntellisense(e){return e[e.length-1]==="^"}function monacoFormat(e,t){t.languages.registerDocumentFormattingEditProvider("markdown",{provideDocumentFormattingEdits(n){let a=n.getValue();var r=e.getPosition();return prettier.format(a,{parser:"markdown",plugins:[parseMd]}).then(i=>{replaceMonacoAll(window.monaco,e,i),e.setPosition(r)}),[]}})}function getDeviceTyByProportion(){const e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;return e/t>=1?"PC":"mobile"}function monacoMouseEvent(e,t){e.onContextMenu(n=>{setContextMenuClickPosition({posx:n.event.posx,posy:n.event.posy})})}function monacoClickEvent(e,t){e.onDidFocusEditorWidget(()=>{window.deco.clear()})}function monacoResizeHeightEvent(e){const t=()=>{e(Math.floor(window.innerHeight*.9))};window.addEventListener("resize",t)}function monacoScrollEvent(e,t){const n=debounce(()=>{syncScrollOnce(e)},20);e.onDidScrollChange(n)}function syncScrollOnce(e,t){if(getSettings().basic.syncScroll){const n=e.getVisibleRanges();if(n.length>0){const r=n[0].startLineNumber;syncScroll(r-1)}}}function syncScroll(e){const t=document.getElementById("view-area");if(!t)return;if(e===0){t.scrollTo({top:0,behavior:"smooth"});return}const n=document.querySelectorAll("#view-area [data-line]");let a=null,r=null,i=1/0,o=1/0,c=null;if(n.forEach(s=>{const l=parseInt(s.getAttribute("data-line")||"0",10)-e;l==0?c=s:(l<0&&Math.abs(l)<i&&(i=Math.abs(l),a=s),l>0&&l<o&&(o=l,r=s))}),c){t.scrollTo({top:c.offsetTop,behavior:"smooth"});return}if(!r){t.scrollTo({top:a.offsetTop,behavior:"smooth"});return}if(a&&r){const s=a.offsetTop,d=r.offsetTop,l=(e-(e-i))/(o+i),m=(d-s)*l+s;t.scrollTo({top:m,behavior:"smooth"})}}const React$5=window.React,useState=window.React.useState,version="0.45.0",cdnDomain={unpkg:["npm.onmicrosoft.cn","unpkg.com"],jsDelivr:["jsd.onmicrosoft.cn","www.jsdelivr.com","jsd.haorwen.tk"]},cdnLinks={unpkg:{cdn:`https://${cdnDomain.unpkg[0]}/monaco-editor@${version}/dev/vs`},jsDelivr:{cdn:`https://${cdnDomain.jsDelivr[0]}/npm/monaco-editor@${version}/dev/vs`}};try{loader.config({paths:{vs:cdnLinks.unpkg.cdn}})}catch(e){loader.config({paths:{vs:cdnLinks.jsDelivr.cdn}})}const files={"index.js":{name:"index.js",language:"javascript",value:"nihao"},"style.css":{name:"style.css",language:"css",value:"nihao"},"index.md":{name:"index.md",language:"markdown",value:""}},MonacoEditor=observer(function e(){const t=React$5.useRef(null),[n,a]=React$5.useState(!0),r=()=>{a(!1)},[i,o]=React$5.useState(640),[c,s]=React$5.useState(800),d=()=>{mdConverter(!0),setTimeout(()=>{m(g=>({...g,minimap:{enabled:!0}}))},300)},[l,m]=useState({fontSize:16,wordWrap:"on",formatOnType:!0,formatOnPaste:!1,fontLigatures:!0,autoSurround:"quotes",autoClosingQuotes:"always",smoothScrolling:!0,codeLens:!1,pasteAs:{enabled:!1,showPasteSelector:"never"},peekWidgetDefaultFocus:"tree",cursorSmoothCaretAnimation:"explicit",colorDecorators:!0,minimap:{enabled:!0},unicodeHighlight:{nonBasicASCII:!1,ambiguousCharacters:!1}}),[u,h]=useState("index.md"),R=files[u];function y(g){triggerConverterEvent(4)}function $(g,p){getDeviceTyByProportion()=="PC"&&o(document.getElementById("editor").clientWidth/2),s(document.getElementById("editor").clientHeight),p.languages.setLanguageConfiguration("markdown",{autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'",notIn:["string","comment"]},{open:"`",close:"`",notIn:["string","comment"]},{open:"/*",close:"*/",notIn:["string"]},{open:"？",close:"？",notIn:["string","comment"]}]}),p.languages.setMonarchTokensProvider("markdown",{tokenizer:{root:[[/\b(function|return|var)\b/,"keyword"],[/\|\|/,"string"],[/>>/,"string"],[/[{}]/,"delimiter"],[/[a-z_$][\w$]*/,"identifier"],[/"[^"]*"/,"string"],[/\d+/,"number"],[/[$$$$]/,"keyword"]]}})}function w(){}function b(g,p){window.editor=g,window.monaco=p,allInit(g,p,r),$(g,p),monacoPasteEvent(g),monacoKeyEvent(g,p),monacoSnippets(g,p),monacoFormat(g,p),monacoMouseEvent(g),monacoClickEvent(g),monacoScrollEvent(g),monacoResizeHeightEvent(s)}return React$5.createElement(React$5.Fragment,null,React$5.createElement("div",{ref:t,id:"monaco-editor",style:{width:i,height:"100%"}},React$5.createElement(ResizableBox,{className:"custom-resizable",width:i,height:c,draggableOpts:{grid:[5,15]},minConstraints:[100,c],onResizeStop:d,onResize:g=>{m(p=>({...p,minimap:{enabled:!1}})),o(g.x)},axis:"x"},React$5.createElement(Ft,{className:"monaco-editor-inner",height:"100%",width:i,theme:getTheme()==="light"?"vs-light":"vs-dark",path:R.name,defaultLanguage:R.language,defaultValue:R.value,onMount:b,onChange:y,options:l,beforeMount:w})),React$5.createElement(Backdrop,{sx:{color:"#fff",zIndex:g=>g.zIndex.drawer+1},open:n,onClick:r},React$5.createElement(CircularProgress,{color:"inherit"}))))}),React$4=window.React;function MdArea(){return React$4.createElement(React$4.Fragment,null,React$4.createElement(MonacoEditor,null))}const React$3=window.React,EmojiPicker=observer(function e(t){const a=d(),r=React$3.useRef(),[i,o]=React$3.useState(!1),[c,s]=React$3.useState(!1);function d(){let m=getContextMenuClickPosition();return m.posy+435>window.document.body.clientHeight&&(m.posy=window.document.body.clientHeight-435),m}function l(m){insertTextMonacoAtCursor(m.native,!0)}return React$3.useEffect(()=>{o(t.open),t.open?(s(t.open),gsap.fromTo(".emojiPicker",{x:0},{x:20,opacity:1,duration:.6})):gsap.to(".emojiPicker",{opacity:0,duration:.4,onComplete:function(){s(i)}})},[t.open]),React$3.createElement(React$3.Fragment,null,React$3.createElement(Backdrop,{invisible:!0,ref:r,transitionDuration:{appear:500,enter:500,exit:1e3},sx:{zIndex:m=>m.zIndex.drawer+1,pointerEvents:i?"":"none"},open:i,onContextMenu:m=>{m.target.tagName!="EM-EMOJI-PICKER"&&(changeEmojiPickerState("off"),m.preventDefault())},onMouseUp:m=>{m.button==2||m.button==0&&m.target.tagName!="EM-EMOJI-PICKER"&&changeEmojiPickerState("off")}},React$3.createElement(Box$1,{sx:{position:"absolute",top:a.posy-window.document.body.clientHeight*.1,left:a.posx+window.document.body.clientWidth*.02},className:"MIN emojiPicker"},React$3.createElement($e5534fc185f7111e$export$2e2bcd8739ae039,{data,onEmojiSelect:l}))))}),React$2=window.React;function enEvents(e){e&&enableFastKeyEvent()}const Body=observer(function e(){React$2.useState("");const t=React$2.useRef(null);return React$2.useEffect(()=>{enEvents(!0)},[]),React$2.createElement(React$2.Fragment,null,React$2.createElement("div",{style:{marginTop:"1.3vh"},id:"bodyTopBox"},React$2.createElement("div",{id:"editor",className:`${getTheme()=="light"?"theme-light":"theme-dark"} FLEX ROW`},React$2.createElement(MdArea,null),React$2.createElement("article",{id:"view-area-hidden",className:"hidden-pre"}),React$2.createElement("article",{ref:t,id:"view-area",className:`markdown-body ${getTheme()==="light"?"markdown-body-light":"markdown-body-dark"}`})),React$2.createElement("div",{id:"aboutBox"},React$2.createElement("div",{id:"markdownParser"},React$2.createElement("div",{id:"aboutMd",className:`aboutViewArea markdown-body ${getTheme()==="light"?"markdown-body-light":"markdown-body-dark"}`}))),React$2.createElement(EmojiPicker,{open:getEmojiPickerState()==="on"})))}),React$1=window.React,bothStyle={zIndex:{drawer:1300,modal:1200,appBar:1200}},lightTheme=createTheme({...bothStyle,palette:{primary:{main:blue[200],contrastText:"#fff378"},secondary:{main:green[500],contrastText:"pink"},info:{main:blue[200],contrastText:"#8B8A8A"},mode:"light"}}),darkTheme=createTheme({...bothStyle,palette:{primary:{main:blue[400],contrastText:"wheat"},secondary:{main:green[700],contrastText:"wheat"},info:{main:green[600],contrastText:"#8B8A8A"},mode:"dark"}}),App=observer(()=>(React$1.useEffect(()=>{kit.addStyle(`
    ::selection {
      border-radius: 5px;
      background-color: ${getTheme()==="light"?"#add6ff":"#636363"};
    }
    `)},[]),React$1.createElement(React$1.Fragment,null,React$1.createElement(ThemeProvider,{theme:getTheme()==="light"?lightTheme:darkTheme},React$1.createElement(CssBaseline,null),React$1.createElement(Box$1,{className:"FLEX COL App-top"},React$1.createElement(DrawerAppBar,null),React$1.createElement(Body,null)))))),React=window.React;client.createRoot(document.getElementById("root")).render(React.createElement(App,null));
