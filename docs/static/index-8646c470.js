var C=Object.defineProperty;var I=(e,t,n)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var j=(e,t,n)=>(I(e,typeof t!="symbol"?t+"":t,n),n);import{j as jsxRuntimeExports,R as React,r as reactExports}from"./react-28cb0b77.js";import{c as client}from"./react-dom-983c8056.js";import{s as styled,B as Button,g as grey,M as Menu,D as Dialog,a as DialogTitle,b as DialogContent,c as DialogContentText,T as TextField,d as DialogActions,e as default_1,f as MenuItem,h as default_1$1,F as FormControl,i as Box$1,I as InputLabel,S as Select,j as default_1$3,k as default_1$4,l as default_1$5,m as default_1$6,n as TreeItem,t as treeItemClasses,o as alpha,C as Collapse,p as SimpleTreeView,q as default_1$7,r as default_1$8,u as default_1$9,v as Breadcrumbs,L as Link,w as default_1$a,x as default_1$b,y as Typography,z as default_1$c,A as Switch,E as Divider,G as useTheme,H as default_1$d,J as default_1$e,K as Tooltip,Z as Zoom,N as createTheme,O as purple,P as Drawer,Q as ThemeProvider,R as IconButton,U as default_1$f,V as default_1$g,W as Grid,X as CssBaseline,Y as AppBar,_ as Toolbar,$ as default_1$h,a0 as default_1$i,a1 as default_1$j,a2 as List,a3 as ListItem,a4 as ListItemButton,a5 as ListItemAvatar,a6 as Avatar,a7 as ListItemText,a8 as default_1$k,a9 as default_1$l,aa as default_1$m,ab as Backdrop,ac as blue,ad as green}from"./@mui-15c6c6dd.js";import{openDB,updateDB,cursorGetData,cursorGetDataByIndex}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@V2.1.1/@cdn/functions/App/db.min.js";import{M as Message,N as Notification}from"./@arco-design-9847a9f9.js";import{makeAutoObservable,observable,toJS}from"https://jsd.onmicrosoft.cn/npm/mobx@6.12.0/+esm";import{o as observer}from"./mobx-react-8637508b.js";import axios from"https://jsd.onmicrosoft.cn/npm/axios@1.6.5/+esm";import hljs from"https://npm.elemecdn.com/@highlightjs/cdn-assets@11.6.0/es/highlight.min.js";import{marked}from"https://npm.elemecdn.com/marked/lib/marked.esm.js";import mermaid from"https://jsd.onmicrosoft.cn/npm/mermaid@10/dist/mermaid.esm.min.mjs";import*as IncrementalDOM from"https://jsd.onmicrosoft.cn/npm/incremental-dom@0.7.0/+esm";import"https://npm.elemecdn.com/katex@0.16.7/dist/katex.min.js";import"https://jsd.onmicrosoft.cn/npm/string-replace-async@3.0.2/index.min.js";import kit from"https://jsd.onmicrosoft.cn/npm/bigonion-kit@0.12.3/esm/kit.min.js";import{M as MarkdownIt}from"./markdown-it-6b60e067.js";import{d as default_1$2}from"./markdown-it-incremental-dom-007b13f8.js";import mdItMultimdTable from"https://jsd.onmicrosoft.cn/npm/markdown-it-multimd-table@4.2.3/+esm";import markdownItGithubToc from"https://jsd.onmicrosoft.cn/npm/markdown-it-github-toc@3.2.4/src/index.js/+esm";import{full}from"https://jsd.onmicrosoft.cn/npm/markdown-it-emoji@3.0.0/+esm";import{has,emojify}from"https://jsd.onmicrosoft.cn/npm/node-emoji@2.1.3/+esm";import vconsole from"https://jsd.onmicrosoft.cn/npm/vconsole@3.15.1/+esm";import markdownitFootNote from"https://jsd.onmicrosoft.cn/npm/markdown-it-footnote@4.0.0/+esm";import html2canvas from"https://jsd.onmicrosoft.cn/npm/html2canvas@1.4.1/+esm";import{u as useSpring,a as animated}from"./@react-spring-bea5b8bf.js";import{Q,Z}from"./react-photo-view-492fd7fb.js";import{l as loader,F as Ft}from"./@monaco-editor-60b23ecd.js";import{R as ResizableBox}from"./react-resizable-835779a2.js";import{delimiters0,delimeterSizing0,greekLetters0,otherLetters0,spacing0,verticalLayout0,logicAndSetTheory0,macros0,bigOperators0,binaryOperators0,binomialCoefficients0,fractions0,mathOperators0,relations0,negatedRelations0,arrows0,font0,size0,style0,symbolsAndPunctuation0,debugging0,accents1,annotation1,verticalLayout1,overlap1,spacing1,logicAndSetTheory1,mathOperators1,sqrt1,extensibleArrows1,font1,braketNotation1,classAssignment1,verticalLayout2,binomialCoefficients2,fractions2,color2,envs}from"https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/@cdn/functions/Monaco/snippets/latexRules.min.js";import prettier from"https://jsd.onmicrosoft.cn/npm/prettier@3.2.4/+esm";import parseMd from"https://jsd.onmicrosoft.cn/npm/prettier@3.2.4/plugins/markdown.js/+esm";import data from"https://jsd.onmicrosoft.cn/npm/@emoji-mart/data@1.1.2/+esm";import{$ as $e5534fc185f7111e$export$2e2bcd8739ae039}from"./@emoji-mart-d936e9b4.js";import{gsap}from"https://jsd.onmicrosoft.cn/npm/gsap@3.12.5/+esm";import"./@babel-49eadfe8.js";import"./scheduler-765c72db.js";import"./react-is-a192e302.js";import"./clsx-0839fdbe.js";import"./@emotion-896e1f3e.js";import"./hoist-non-react-statics-3f8ebaa8.js";import"./stylis-79144faa.js";import"./react-transition-group-1ee0623f.js";import"./dom-helpers-9a525042.js";import"./@popperjs-f3391c26.js";import"./prop-types-d3a39c01.js";import"./dayjs-0054e3fc.js";import"./mobx-react-lite-4b8305a9.js";import"./use-sync-external-store-d57a27c6.js";import"./mdurl-d7fdfec3.js";import"./uc.micro-78e30319.js";import"./entities-52510f6e.js";import"./linkify-it-7ae06500.js";import"./punycode.js-c41da3d1.js";import"./htmlparser2-7c989eee.js";import"./inherits-2c87d58f.js";import"./state-local-dd516420.js";import"./react-draggable-d53cddad.js";import"./emoji-mart-029374f1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const ColorButton=styled(Button)(({theme:e})=>({color:e.palette.mode==="light"?"rgb(55, 65, 81)":"#FFFFFF",marginLeft:10,fontFamily:["electronicFont"].join(","),backgroundColor:e.palette.mode==="light"?"#FFFFFF":"","&:hover":{backgroundColor:e.palette.mode==="light"?grey[300]:""}}));function CustomizedButtons(e){return jsxRuntimeExports.jsx(ColorButton,{id:"demo-customized-button",href:e.href?e.href:void 0,"aria-controls":e.open?"demo-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":e.open?"true":void 0,disableElevation:!0,onClick:e.onClick,onMouseOver:e.onHover,endIcon:e.endIcon,startIcon:e.startIcon?e.startIcon:void 0,variant:"contained",children:e.children})}function getMdTextFromMonaco(){var e;if((e=window.editor)!=null&&e.getValue){let t=window.editor.getValue();return t=t.replace(/\r\n/g,`
`),t}else return"null"}function getRenderHTML(e="view-area"){let t=document.getElementById(e);if(t)return t.innerHTML}function fillInMemoryText(e){openDB("md_content",2).then(t=>{updateDB(t,"users_md",{uuid:1,contentText:e})})}async function readMemoryText(){return new Promise(e=>{openDB("md_content",2).then(t=>{cursorGetData(t,"users_md").then(n=>{e(n)})})})}function fillInMemoryImgs(e,t){openDB("md_content",2).then(n=>{for(let i=0;i<=e.length-1;i++){let o={uuid:t+i,imgBase64:e[i]};updateDB(n,"users_img",o)}})}async function readMemoryImg(e,t){return new Promise(n=>{openDB("md_content",2).then(i=>{cursorGetDataByIndex(i,"users_img",e,t).then(o=>{n(o)})})})}async function readAllMemoryImg(){return new Promise(e=>{openDB("md_content",2).then(t=>{cursorGetData(t,"users_img").then(n=>{e(n)})})})}function save(e=null,t=!0){let n=getMdTextFromMonaco();t&&n!="null"?(Message.success({style:{position:"relative",zIndex:1},content:"保存成功!",closable:!0,duration:2500,position:"top"}),fillInMemoryText(n)):save()}async function isSaved(){return await readMemoryText().then(e=>{var t;return e?((t=e[0])==null?void 0:t.contentText)===getMdTextFromMonaco():!1})}class ImageStore{constructor(t){j(this,"displayState",!1);makeAutoObservable(this,{displayState:observable}),this.displayState=t}display(){this.displayState=!0}hidden(){this.displayState=!1}}const imageStore=new ImageStore(!1),useImage=()=>imageStore,StyledMenu=styled(e=>jsxRuntimeExports.jsx(Menu,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...e}))(({theme:e})=>({"& .MuiPaper-root":{borderRadius:6,marginTop:e.spacing(1),color:e.palette.mode==="light"?"rgb(55, 65, 81)":e.palette.grey[300],"& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:20,color:e.palette.mode==="light"?"rgb(55, 65, 81)":e.palette.grey[300],marginRight:e.spacing(1.5)}}}}));function CloudMail(e,t,n){for(var i=document.getElementById("view-area"),o=window.getComputedStyle(i),r=0;r<o.length;r++){var s=o[r];o.getPropertyValue(s)}axios({url:e,method:t,data:n,headers:{"Content-Type":"application/json"}}).then(d=>{console.log(d)})}function Share(e){let t=React.useRef(),[n,i]=React.useState(!1),o=s=>{i(()=>!1),e.onClick(s)},r=s=>{let c=t.current.value;CloudMail("https://service-g12i7wh1-1321514649.sh.apigw.tencentcs.com/release/mail","post",{to:c,subject:"Mailed from Markdown Online+",html:`<div class="markdown-body">${getRenderHTML()}</div>`,raw:0}),o(s),Notification.success({title:"邮件发送成功！",content:"Beta版本,请勿重复尝试",position:"topRight"}),Notification.info({title:"请注意,邮件发送暂时不能完全支持mermaid和Latex",content:"Beta版本,请勿重复尝试",position:"topRight"}),e.closAll()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Dialog,{fullWidth:!0,maxWidth:"sm",open:n,onClose:o,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"神奇邮箱"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsxs(DialogContentText,{children:["请输入你要发送到的邮箱",jsxRuntimeExports.jsx("br",{})]}),jsxRuntimeExports.jsx(TextField,{inputRef:t,autoFocus:!0,margin:"dense",id:"name",label:"Email Address",type:"email",fullWidth:!0,variant:"standard"})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:o,children:"取消"}),jsxRuntimeExports.jsx(Button,{onClick:r,children:"发送"})]})]}),jsxRuntimeExports.jsx(default_1,{}),"分享(开发中)",jsxRuntimeExports.jsx(StyledMenu,{style:{width:"fitContent"},anchorOrigin:{vertical:-5,horizontal:12},id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:e.anchorEl,open:e.open,onClick:e.onClick,children:jsxRuntimeExports.jsxs(MenuItem,{onClick:s=>{s.stopPropagation(),i(!0)},disableRipple:!0,children:[jsxRuntimeExports.jsx(default_1$1,{}),"邮箱分享"]})})]})}class operateLocalStorage{constructor(){j(this,"version","0.1")}setItem(t,n){localStorage.setItem(t,n)}getItem(t){return localStorage.getItem(t)?localStorage.getItem(t):""}removeItem(t){localStorage.removeItem(t)}}let welcomeText;function blankTextInit(){return new Promise(e=>{fetch("https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/source/assets/welcome.md").then(t=>t.text()).then(t=>{welcomeText=t}).catch(t=>{console.error("Error fetching markdown:",t)}),readMemoryText().then(t=>{t.length&&t[0].contentText?(window.editor.setValue(t[0].contentText),e()):(window.editor.setValue(welcomeText),e())})})}function PageBreaker(e){let t=/\|---\|/g;return e=e.replace(t,()=>'<div style="page-break-after: always;"></div>'),e}const index="";async function prepareParser(e){async function t(l){let a=l.attrGet("src");if(a.startsWith("/vf/")){let u=a.match(/\d+/)[0];return await readMemoryImg("uuid",parseInt(u)).then(g=>g[0].imgBase64)}}async function n(l){let a=l.content,u;try{return await mermaid.parse(a,{suppressErrors:!1}),await mermaid.parse(a,{suppressErrors:!0})&&(u=await mermaid.render(`_mermaidSvg_${kit.getUUID().slice(0,5)}`,a)),u.svg}catch(g){return`<pre class="ERR">${g}</pre>`}}let i=[],o=[],r=[],s=[],c=markdownParser();c.renderer.rules.image=function(l,a){var u;return(u=l[a].attrGet("src"))!=null&&u.startsWith("/vf/")&&i.push(l[a]),""},c.renderer.rules.fence=function(l,a,u,g,h){return l[a].info==="mermaid"&&o.push(l[a]),""},c.render(e,{});for(const l of i){let a=await t(l);r.push(a)}for(const l of o){let a=await n(l);s.push(a)}return{vfImgSrcArr:r,vfImgSeq:0,mermaidParsedArr:s,mermaidSeq:0}}async function mdConverter(e=!0){let t=getMdTextFromMonaco();t=PageBreaker(t);let n=await prepareParser(t);IncrementalDOM.patch(document.getElementById("view-area"),markdownParser().renderToIncrementalDOM(t,n)),hljs.highlightAll()}const regs={markHighlight:/@@(.*?)@@/,emoji:/^:([a-zA-Z0-9_\+\-]+):/},newTokenizer={heading(e){return e.match(/^#{1,6}\s.*/),!1},codespan(e){return e.match(/^\&+([^\&\n]+?)\&+/),!1}},newRenderer={paragraph(e){return`<p class="line-hilight">${e}</p>`},heading(e,t){return`
            <h${t}  class="line-hilight">
              <a href="#">
                <span class="header-link"></span>
              </a>
              ${e}
            </h${t}>`},code(code,lang,_escaped){let finalCodeBlock;return lang=="js-run"?(new vconsole,`${eval(code)}`):(hljs.getLanguage(lang)?finalCodeBlock=`<pre><code class="language-${lang} ">${code}</code></pre>`:lang=="mermaid"?finalCodeBlock=`<div class="language-mermaid language-plaintext">${code}</div>`:finalCodeBlock=`<pre><code class="language-plaintext">${code}</code></pre>`,finalCodeBlock)},image(e,t,n){const i="#";let o=Math.random(),r="auto",s="",c="L",d=n.split(i);if(d.length>1)for(let l=0;l<d.length;l++){let a=d[l];a==="s"&&(s+="box-shadow: rgb(199 199 199) 1vh 2vh 21px"),a==="s1"&&(s+="box-shadow: rgb(146 146 146) 1vh 2vh 21px;"),a==="s2"&&(s+="box-shadow: rgb(32 32 32 / 86%) 1vh 2vh 21px"),(a==="C"||a=="c")&&(c="C"),(a==="R"||a=="r")&&(c="R"),a.startsWith("w")&&(r=d[l].substring(1),r.endsWith("%")||(r+="px"))}return`<div class="imgBox-r FLEX ${o} ${c=="C"?" JUS-CENTER":c=="R"?"JUS-RIGHT":""}" ><img class="img_resize_transition" width="${r}" style="${s}" src="${e}" alt="${n}"></div>`}},importUrlExtension={extensions:[{name:"importUrl",level:"block",start(e){return e.indexOf(`
:`)},tokenizer(e){const n=/^:(https?:\/\/.+?):/.exec(e);if(n)return{type:"importUrl",raw:n[0],url:n[1],html:""}},renderer(e){return`<iframe style="border:none" src="${e.url}" width="100%" height="100%"></iframe>`}}]},markItExtension={extensions:[{name:"markIt",level:"inline",start(e){var t;return(t=e.match(/@@/))==null?void 0:t.index},tokenizer(e,t){const n=e.match(regs.markHighlight),i=n?n[1]:"";if(n)return{type:"markIt",raw:e,text:i}},renderer(e){return`${e.raw.replace(regs.markHighlight,`<mark>${e.text}</mark>`)}`}}]},imgExtension={name:"newRenderer",level:"block",tokenizer:newTokenizer,renderer:newRenderer,async:!0,async walkTokens(e){if(e.type,e.type==="image"){const t=e.href;if(t!=null&&t.match(/vf/)){let n=(t.match(/vf\/(\d+)/)?t.match(/vf\/(\d+)/)[1]:0).toString(),i=await readMemoryImg("uuid",parseInt(n)).then(o=>o[0]?o[0].imgBase64:0);e.href=i}}else e.type==="code"||e.type}},emojiExtension={extensions:[{name:"emoji",level:"inline",start(e){var t;return(t=e.match(/:/))==null?void 0:t.index},tokenizer(e,t){const n=e.match(regs.emoji);return n?{type:"emoji",raw:n[0],text:n[1]}:!1},renderer(e){return has(e.raw)?emojify(e.raw):e.raw}}]};class ConfigStore{constructor({themeState:t,emojiPickerState:n,contextMenuClickPosition:i,settingsConfig:o}){j(this,"themeState");j(this,"emojiPickerState");j(this,"contextMenuClickPosition");j(this,"settingsConfig");makeAutoObservable(this,{themeState:observable,emojiPickerState:observable,contextMenuClickPosition:observable,settingsConfig:observable}),this.themeState=t,this.emojiPickerState=n,this.contextMenuClickPosition=i,this.settingsConfig=o}getAllConfig(){let t={};return Object.getOwnPropertyNames(this).forEach((n,i)=>{t[n]=this[n]}),t}}function markdownitLineNumber(e,t){const n=function(i,o,r,s,c){let d;return i[o].map&&i[o].level===0&&(d=i[o].map[0],i[o].attrSet("data-line",String(d))),c.renderToken(i,o,r)};e.renderer.rules.paragraph_open=e.renderer.rules.heading_open=e.renderer.rules.table_open=n}let myPlugin=function(e){e.core.ruler.before("inline","myrule",function(t){var n=t.tokens;for(let i=0;i<n.length;i++)n[i].content&&n[i].content.indexOf("MYRULE")})},imagePlugin=function(e){e.renderer.rules.image,e.renderer.rules.image=function(t,n,i,o,r){var b;const s=t[n],c="#";let d=s.attrs[s.attrIndex("src")][1],l=s.content;s&&((b=s.attrGet("src"))!=null&&b.startsWith("/vf/"))&&o.vfImgSrcArr&&(d=o.vfImgSrcArr[o.vfImgSeq++]);let a="auto",u="",g="L",h=l.split(c);if(h.length>1)for(let m=0;m<h.length;m++){let x=h[m];x==="s"&&(u+="box-shadow: rgb(199 199 199) 1vh 2vh 21px"),x==="s1"&&(u+="box-shadow: rgb(146 146 146) 1vh 2vh 21px;"),x==="s2"&&(u+="box-shadow: rgb(32 32 32 / 86%) 1vh 2vh 21px"),(x==="C"||x=="c")&&(g="C"),(x==="R"||x=="r")&&(g="R"),x.startsWith("w")&&(a=h[m].substring(1),a.endsWith("%")||(a+="px"))}return`<div class="imgBox-r FLEX  ${g=="C"?" JUS-CENTER":g=="R"?"JUS-RIGHT":""}" ><img class="img_resize_transition" width="${a}" style="${u}" src="${d}" alt="${l}">
    </div>`}},codePlugin=function(e){const t=e.renderer.rules.code_block;e.renderer.rules.fence=function(n,i,o,r,s){let c;n[i].map&&n[i].level===0&&(c=n[i].map[0],n[i].attrSet("data-line",String(c)));let d=n[i].info,l=n[i].content;if(d==="mermaid"){if(r.mermaidParsedArr)return`<div data-line="${c}" class="language-mermaid language-plaintext">
        ${r.mermaidParsedArr[r.mermaidSeq++]}
        </div>`}else return hljs.getLanguage(d)?`<pre data-line="${c}"><code class="language-${d} ${getTheme()==="light"?"":"hljs-dark"}">${l}</code></pre>`:`<div class="code-container" data-line="${c}">
      <pre><code class="language-plaintext">${l}</code></pre>
    </div>`;return t(n,i,o,r,s)}},cluePlugin=function(e){function t(n){const i=n.tokens;for(let o=0;o<i.length;o++)if(i[o].type==="inline"){let r=i[o].children;for(let s=0;s<r.length;s++){const c=r[s];if(c.type==="text"&&c.content){const l=c.content.match(/\^(.*?)\^(.*?)\#$/);if(l){const a=new n.Token("html_block","",0);a.content=`<div class="${l[2]}">${e.render(l[1])}</div>`,r[s]=a,s++}}}}}e.core.ruler.push("my_rule1",t),e.inline.ruler.before("emphasis","mark",(n,i)=>!1)};function preViewClickEvent(e,t,n=e.createDecorationsCollection()){document.getElementById("view-area").addEventListener("dblclick",function(i){let o=i.target,r=0;if(o!==this){for(;o;){if(o.hasAttribute("data-line")){r=parseInt(o.getAttribute("data-line"));break}o=o.parentElement}r&&(window.editor.setPosition({lineNumber:r+1,column:1}),window.editor.revealLineInCenter(r+1),n.clear(),n.set([{range:new t.Range(r+1,1,r+1,1),options:{isWholeLine:!0,className:"HILIGHT-MONACO",zIndex:0}}]))}})}const katex=window.katex;function isValidDelim(e,t){var n,i,o=e.posMax,r=!0,s=!0;return n=t>0?e.src.charCodeAt(t-1):-1,i=t+1<=o?e.src.charCodeAt(t+1):-1,(n===32||n===9||i>=48&&i<=57)&&(s=!1),(i===32||i===9)&&(r=!1),{can_open:r,can_close:s}}function math_inline(e,t){var n,i,o,r,s;if(e.src[e.pos]!=="$")return!1;if(r=isValidDelim(e,e.pos),!r.can_open)return t||(e.pending+="$"),e.pos+=1,!0;for(n=e.pos+1,i=n;(i=e.src.indexOf("$",i))!==-1;){for(s=i-1;e.src[s]==="\\";)s-=1;if((i-s)%2==1)break;i+=1}return i===-1?(t||(e.pending+="$"),e.pos=n,!0):i-n===0||i-n===2?(t||(e.pending+="$$"),e.pos=n+1,!0):(r=isValidDelim(e,i),r.can_close?(t||(o=e.push("math_inline","math",0),o.markup="$",o.content=e.src.slice(n,i)),e.pos=i+1,!0):(t||(e.pending+="$"),e.pos=n,!0))}function math_block(e,t,n,i){var o,r,s,c,d=!1,l,a=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(a+2>u||e.src.slice(a,a+2)!=="$$")return!1;if(a+=2,o=e.src.slice(a,u),i)return!0;for(o.trim().slice(-2)==="$$"&&(o=o.trim().slice(0,-2),d=!0),s=t;!d&&(s++,!(s>=n||(a=e.bMarks[s]+e.tShift[s],u=e.eMarks[s],a<u&&e.tShift[s]<e.blkIndent)));)e.src.slice(a,u).trim().slice(-2)==="$$"&&(c=e.src.slice(0,u).lastIndexOf("$$"),r=e.src.slice(a,c),d=!0);return e.line=s+1,l=e.push("math_block","math",0),l.block=!0,l.content=(o&&o.trim()?o+`
`:"")+e.getLines(t+1,s,e.tShift[t],!0)+(r&&r.trim()?r:""),l.map=[t,e.line],l.markup="$$",!0}function markdownItLatex(e,t){t=t||{throwOnError:!1,strict:!1};var n=function(s){if(t.displayMode=!1,s)try{return katex.renderToString(s,t)}catch{return s}else return"Latex Missing"},i=function(s,c){return n(s[c].content)},o=function(s,c){t.displayMode=!0;let d;if(c.map&&c.level===0&&(d=c.map[0]),s)try{return`<p data-line=${String(d)}>`+katex.renderToString(s,t)+"</p>"}catch{return s}else return"LATEX MISSING"},r=function(s,c){return o(s[c].content,s[c])+`
`};e.inline.ruler.after("escape","math_inline",math_inline),e.block.ruler.after("blockquote","math_block",math_block,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=i,e.renderer.rules.math_block=r}function markdownParser(){return MarkdownIt({html:!0,linkify:!0,typographer:!0,breaks:!0}).use(markdownitLineNumber).use(myPlugin).use(imagePlugin).use(mdItMultimdTable,{multiline:!0,rowspan:!0,headerless:!0,multibody:!0,aotolabel:!0}).use(codePlugin).use(cluePlugin).use(markdownitFootNote).use(markdownItGithubToc,{anchorLinkSymbol:""}).use(full).use(markdownItLatex).use(default_1$2,IncrementalDOM)}class settingsClass{constructor(){}markedInit(){marked.use({mangle:!1,headerIds:!1,strict:!1,extensions:[],async:!0,lineNumber:!0},importUrlExtension,imgExtension,markItExtension,emojiExtension)}mermaidInit(){mermaid.parseError=t=>{},mermaid.initialize({securityLevel:"loose",logLevel:4,startOnLoad:!1,theme:"base"}),mermaid.mermaidAPI.initialize({startOnLoad:!1})}hljsInit(){hljs.configure({ignoreUnescapedHTML:!0})}settingsAllInit(){this.markedInit(),this.mermaidInit(),this.hljsInit()}static newSettings(){return new this}}function allInit(e=window.editor,t=window.monaco){new settingsClass().settingsAllInit(),blankTextInit().then(()=>{mdConverter(),kit.sleep(110).then(()=>{Notification.success({title:"已更新到最新版本",content:"当前版本:v2.1.1",position:"bottomRight"}),kit.sleep(780).then(()=>{Notification.info({title:"版本新增特性",content:"1. 修复溢出滚动条bug 2.新增语音识别",position:"bottomRight"})})})}),window.deco=e.createDecorationsCollection(),preViewClickEvent(e,t,window.deco),window._speechData={processing:!1,speechResult:"",speech:null}}const defaultConfig={themeState:"light",emojiPickerState:"off",contextMenuClickPosition:{posx:20,posy:20},settingsConfig:{basic:{syncScroll:!0,speechLanguage:"zh-CN"},advanced:{}}};function configInit(e){function t(o){typeof n[o]=="object"?i.setItem(o,JSON.stringify(n[o])):i.setItem(o,n[o])}let n=e,i=new operateLocalStorage;for(let o in n)if(i.getItem(o))if(o=="themeState"||o=="emojiPickerState"||o=="settingsConfig")try{typeof n[o]=="object"?n[o]=JSON.parse(i.getItem(o).toString()):n[o]=i.getItem(o).toString()}catch{t(o)}else t(o);else t(o);return n}const configStore=new ConfigStore(configInit(defaultConfig)),useConfig=()=>configStore;let opLocalStorage=new operateLocalStorage;function changeTheme(e){e=="light"?(useConfig().themeState="light",opLocalStorage.setItem("themeState","light")):(useConfig().themeState="dark",opLocalStorage.setItem("themeState","dark"))}function getTheme(){return useConfig().themeState}function changeEmojiPickerState(e){e=="on"?(useConfig().emojiPickerState="on",opLocalStorage.setItem("emojiPickerState","on")):(useConfig().emojiPickerState="off",opLocalStorage.setItem("emojiPickerState","off"))}function getEmojiPickerState(){return useConfig().emojiPickerState}function setContextMenuClickPosition(e){if(e.posx&&e.posy)useConfig().contextMenuClickPosition=e;else return!1}function getContextMenuClickPosition(){return useConfig().contextMenuClickPosition}function changeSettings(e){const t=getSettings(),n=updateSettingsConfig(t,e);useConfig().settingsConfig=n,opLocalStorage.setItem("settingsConfig",JSON.stringify(n))}function getSettings(){return toJS(useConfig().settingsConfig)}function updateSettingsConfig(e,t){for(const n in t)n in e?Object.assign(e[n],t[n]):e[n]=t[n];return e}function exportAsImage(e=3,t="markdown.jpeg"){let n=document.getElementById("view-area").innerHTML;window.document.body.innerHTML=`<div id="exportBox" style="width:64vw" class="markdown-body markdown-body-${getTheme()==="light"?"light":"dark"}">${n}</div>`,kit.sleep(250).then(()=>{html2canvas(document.getElementById("exportBox"),{scale:e}).then(i=>{let o=i.toDataURL("image/png",.6);var r=document.createElement("a");r.download=t,r.href=o,r.click()}),kit.sleep(2e3).then(()=>{window.location.reload()})})}function exportAsMd(){let e=getMdTextFromMonaco()??"";kit.sleep(250).then(()=>{var t=document.createElement("a");t.href="data:text/plain;charset=utf-8,"+encodeURIComponent(e),t.download="text.md",t.click()})}function myPrint(){let e=document.getElementById("view-area").innerHTML;window.document.body.style.background=getTheme()==="light"?"":"#0D1117",window.document.body.innerHTML=`<div class="markdown-body markdown-body-${getTheme()==="light"?"light":"dark"}">${e}</div>`,kit.sleep(250).then(()=>{window.print(),location.reload()})}function Export(e){let t=e.closeExportMenu;e.closeMenu;let[n,i]=React.useState(!1),o=a=>{console.log(a),t(a),i(()=>!1)},r=React.useRef();const[s,c]=React.useState(3),d=a=>{a.stopPropagation(),c(a.target.value)};let l=a=>{o(a);let u=r.current.value;exportAsImage(s??4,u??"md_snapshot.png"),e.closeMenu(a),Notification.success({title:"导出成功！",content:"Beta版本,请勿重复尝试",position:"topRight"})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Dialog,{className:"avoid",onClose:o,open:n,fullWidth:!0,maxWidth:"sm",children:jsxRuntimeExports.jsxs("div",{onClick:a=>{a.stopPropagation()},children:[jsxRuntimeExports.jsx(DialogTitle,{children:"导出设置"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(DialogContentText,{children:"请选择图片清晰度"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[jsxRuntimeExports.jsxs(Box$1,{children:[jsxRuntimeExports.jsx(InputLabel,{id:"demo-simple-select-label",children:"图片清晰度"}),jsxRuntimeExports.jsxs(Select,{label:"图片清晰度",defaultValue:"4",defaultChecked:!0,fullWidth:!0,onChange:d,children:[jsxRuntimeExports.jsx(MenuItem,{value:"1",children:"1 (比较模糊,体积轻巧)"}),jsxRuntimeExports.jsx(MenuItem,{value:"2",children:"2 (有些模糊)"}),jsxRuntimeExports.jsx(MenuItem,{value:"4",children:"3 (默认,适中,推荐)"}),jsxRuntimeExports.jsx(MenuItem,{value:"6",children:"4 (比较清晰,体积稍大)"}),jsxRuntimeExports.jsx(MenuItem,{value:"10",children:"5 (超鸡无敌霹雳霸清晰,体积较大)"})]})]}),jsxRuntimeExports.jsx(Box$1,{marginX:"8px",children:jsxRuntimeExports.jsx(TextField,{inputRef:r,margin:"dense",id:"export_img_name",defaultValue:"md_snapshot.png",label:"导出的文件名",type:"text",fullWidth:!0,variant:"standard",placeholder:"md_snapshot.png"})})]})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:o,children:"取消"}),jsxRuntimeExports.jsx(Button,{onClick:l,children:"确认导出"})]})]})}),jsxRuntimeExports.jsx(default_1$3,{}),"导出",jsxRuntimeExports.jsxs(StyledMenu,{style:{width:"fitContent"},anchorOrigin:{vertical:-5,horizontal:12},id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:e.anchorEl,open:e.open,onClick:a=>{t(a)},children:[jsxRuntimeExports.jsxs(MenuItem,{onClick:()=>{myPrint()},disableRipple:!0,children:[jsxRuntimeExports.jsx(default_1$4,{}),"导出为PDF"]}),jsxRuntimeExports.jsxs(MenuItem,{onClick:a=>{i(!0),t(a)},disableRipple:!0,children:[jsxRuntimeExports.jsx(default_1$5,{}),"导出为图片(Beta1.0)"]}),jsxRuntimeExports.jsxs(MenuItem,{onClick:()=>{exportAsMd()},disableRipple:!0,children:[jsxRuntimeExports.jsx(default_1$6,{}),"导出为Markdown"]})]})]})}function TransitionComponent(e){const t=useSpring({to:{opacity:e.in?1:0,transform:`translate3d(${e.in?0:20}px,0,0)`}});return jsxRuntimeExports.jsx(animated.div,{style:t,children:jsxRuntimeExports.jsx(Collapse,{...e})})}const StyledTreeItem=styled(TreeItem)(({theme:e})=>({color:e.palette.mode==="light"?e.palette.grey[800]:e.palette.grey[200],[`& .${treeItemClasses.content}`]:{borderRadius:e.spacing(.5),padding:e.spacing(.5,1),margin:e.spacing(.2,0),[`& .${treeItemClasses.label}`]:{fontSize:"0.89rem",fontWeight:500}},[`& .${treeItemClasses.iconContainer}`]:{borderRadius:"80%",backgroundColor:e.palette.mode==="light"?alpha(e.palette.primary.main,.45):e.palette.primary.dark,color:e.palette.mode==="dark"&&e.palette.primary.contrastText,padding:e.spacing(0,1.2)}})),CustomTreeItem=reactExports.forwardRef((e,t)=>jsxRuntimeExports.jsx(StyledTreeItem,{...e,slots:{groupTransition:TransitionComponent,...e.slots},ref:t}));function SettingsRoute(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Box$1,{className:"transparent-scrollbar",sx:{overflow:"scroll",flex:"0 0 30%",minHeight:20,overflowX:"hidden",borderRight:"solid rgba(0, 0, 0, 0.12)"},children:jsxRuntimeExports.jsxs(SimpleTreeView,{"aria-label":"customized",defaultExpandedItems:["1_x"],slots:{endIcon:default_1$7},sx:{userSelect:"none",minHeight:270,maxWidth:300},children:[jsxRuntimeExports.jsxs(CustomTreeItem,{slots:{endIcon:default_1$8},onClick:()=>{document.getElementById("settings_1_x").scrollIntoView()},itemId:"1_x",label:"基础设置",children:[jsxRuntimeExports.jsx(CustomTreeItem,{slots:{endIcon:default_1$9},onClick:()=>{document.getElementById("settings_1_1").scrollIntoView()},itemId:"1_2",label:"主题设置"}),jsxRuntimeExports.jsx(CustomTreeItem,{slots:{endIcon:default_1$8},onClick:()=>{document.getElementById("settings_1_2").scrollIntoView()},itemId:"1_3",label:"编辑器设置"})]}),jsxRuntimeExports.jsxs(CustomTreeItem,{itemId:"2_x",label:"高级设置",children:[jsxRuntimeExports.jsx(CustomTreeItem,{itemId:"2_2",label:"导出设置"}),jsxRuntimeExports.jsx(CustomTreeItem,{itemId:"2_3",label:"Mermaid设置"})]})]})})})}function handleClick(e){e.preventDefault()}function IconBreadcrumbs(){return jsxRuntimeExports.jsx(Box$1,{sx:{marginBottom:"5px"},role:"presentation",onClick:handleClick,children:jsxRuntimeExports.jsxs(Breadcrumbs,{"aria-label":"breadcrumb",children:[jsxRuntimeExports.jsxs(Link,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/",children:[jsxRuntimeExports.jsx(default_1$a,{sx:{mr:.5},fontSize:"inherit"}),"MUI"]}),jsxRuntimeExports.jsxs(Link,{underline:"hover",sx:{display:"flex",alignItems:"center"},color:"inherit",href:"/material-ui/getting-started/installation/",children:[jsxRuntimeExports.jsx(default_1$b,{sx:{mr:.5},fontSize:"inherit"}),"Core"]}),jsxRuntimeExports.jsxs(Typography,{sx:{display:"flex",alignItems:"center"},color:"text.primary",children:[jsxRuntimeExports.jsx(default_1$c,{sx:{mr:.5},fontSize:"inherit"}),"Breadcrumb"]})]})})}let MaterialUISwitch=styled(Switch)(({theme:e})=>({width:62,height:34,padding:7,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(22px)","& .MuiSwitch-thumb:before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M4.2 2.5l-.7 1.8-1.8.7 1.8.7.7 1.8.6-1.8L6.7 5l-1.9-.7-.6-1.8zm15 8.3a6.7 6.7 0 11-6.6-6.6 5.8 5.8 0 006.6 6.6z"/></svg>')`},"& + .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be"}}},"& .MuiSwitch-thumb":{backgroundColor:e.palette.mode==="dark"?"#003892":"#001e3c",width:32,height:32,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M9.305 1.667V3.75h1.389V1.667h-1.39zm-4.707 1.95l-.982.982L5.09 6.072l.982-.982-1.473-1.473zm10.802 0L13.927 5.09l.982.982 1.473-1.473-.982-.982zM10 5.139a4.872 4.872 0 00-4.862 4.86A4.872 4.872 0 0010 14.862 4.872 4.872 0 0014.86 10 4.872 4.872 0 0010 5.139zm0 1.389A3.462 3.462 0 0113.471 10a3.462 3.462 0 01-3.473 3.472A3.462 3.462 0 016.527 10 3.462 3.462 0 0110 6.528zM1.665 9.305v1.39h2.083v-1.39H1.666zm14.583 0v1.39h2.084v-1.39h-2.084zM5.09 13.928L3.616 15.4l.982.982 1.473-1.473-.982-.982zm9.82 0l-.982.982 1.473 1.473.982-.982-1.473-1.473zM9.305 16.25v2.083h1.389V16.25h-1.39z"/></svg>')`}},"& .MuiSwitch-track":{opacity:1,backgroundColor:e.palette.mode==="dark"?"#8796A5":"#aab4be",borderRadius:20/2}}));const IOSSwitch=styled(e=>jsxRuntimeExports.jsx(Switch,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...e}))(({theme:e})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:e.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:e.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:e.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:e.transitions.create(["background-color"],{duration:500})}}));let speechRecognition=(e,t=!0,n)=>{const i=new webkitSpeechRecognition||new SpeechRecognition;let o=!1;return i.lang=e,i.continuous=!0,i.interimResults=!1,t&&i.start(),i.onstart=()=>{o=!0},i.onresult=r=>{let s=r.results[r.results.length-1][0].transcript;console.log(s,s.length),window._speechData.speechResult=s,n(s.length),o===!1&&i.stopRecognition()},i.onerror=r=>{console.error(r.error)},i.onend=()=>{console.log(o),o&&i.start()},i.stopRecognition=()=>{i.stop(),o=!1},{recognition:i,recognizing:o}};const speechLanguageMap={1:["zh-CN","普通话"],2:["en-US","English"],3:["ja-JP","日本語"]},SettingsBody=observer(function e(){const t=getTheme(),n={transition:"0.3s",position:"relative",padding:"5px",borderRadius:"3px",display:"flex",flexDirection:"column",mt:"10px",mb:"5px",ml:"0px",pl:"25px","&::before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:4,backgroundColor:"transparent",transition:"background-color 0.3s"},"&:hover::before":{backgroundColor:t==="light"?"#840084":"#d2d2d2"},"&:hover":{backgroundColor:t==="light"?"#E7E6E5":""}},i={color:"#8B8A8A",fontSize:"0.79rem",fontWeight:500,mb:"5px"},[o,r]=React.useState(!1);function s(l,a){const u=document.querySelector(".markdown-body");a?(changeTheme("dark"),r(l.target.checked),console.log(u.style.cssText),u.style.cssText=""):(changeTheme("light"),r(l.target.checked),console.log(u.style.cssText))}function c(l,a){changeSettings(a?{basic:{syncScroll:!0}}:{basic:{syncScroll:!1}})}function d(l){changeSettings({basic:{speechLanguage:l.target.value}})}return React.useEffect(()=>{r(getTheme()==="dark")},[getTheme()]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(Box$1,{className:"transparent-scrollbar",sx:{width:"100%",padding:"1rem",display:"flex",flexDirection:"column",fontSize:"0.89rem",maxHight:"200px",overflowY:"scroll"},children:[jsxRuntimeExports.jsx(Typography,{id:"settings_1_x",sx:{fontSize:"30px",fontWeight:"700"},children:"基础设置"}),jsxRuntimeExports.jsx(Divider,{}),jsxRuntimeExports.jsxs(Box$1,{sx:n,children:[jsxRuntimeExports.jsx(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500},children:"Theme"}),jsxRuntimeExports.jsx(Typography,{sx:i,children:"更改编辑器的主题"}),jsxRuntimeExports.jsx(MaterialUISwitch,{checked:o,size:"small",inputProps:{"aria-label":"controlled"},onChange:s})]}),jsxRuntimeExports.jsxs(Box$1,{sx:n,children:[jsxRuntimeExports.jsx(Typography,{id:"settings_1_2",sx:{fontSize:"0.89rem",fontWeight:500},children:"Synchronous Scrolling"}),jsxRuntimeExports.jsx(Typography,{sx:i,children:"同步滚动左边编辑区和预览区域。(开发中)"}),jsxRuntimeExports.jsx(IOSSwitch,{checked:getSettings().basic.syncScroll,size:"small",inputProps:{"aria-label":"controlled"},onChange:c})]}),jsxRuntimeExports.jsxs(Box$1,{sx:n,children:[jsxRuntimeExports.jsx(Typography,{sx:{fontSize:"0.89rem",fontWeight:500},children:"Speech To Text"}),jsxRuntimeExports.jsx(Typography,{sx:i,children:"选择语音转文字的识别语言"}),jsxRuntimeExports.jsxs(Select,{value:getSettings().basic.speechLanguage??"zh-CN",defaultChecked:!0,fullWidth:!0,size:"small",onChange:d,children:[jsxRuntimeExports.jsx(MenuItem,{value:speechLanguageMap[1][0],children:speechLanguageMap[1][1]}),jsxRuntimeExports.jsx(MenuItem,{value:speechLanguageMap[2][0],children:speechLanguageMap[2][1]}),jsxRuntimeExports.jsx(MenuItem,{value:speechLanguageMap[3][0],children:speechLanguageMap[3][1]})]})]}),jsxRuntimeExports.jsx(Typography,{id:"settings_1_x",sx:{mt:"20px",fontSize:"30px",fontWeight:"700"},children:"高级设置（施工中）"}),jsxRuntimeExports.jsx(Divider,{}),jsxRuntimeExports.jsxs(Box$1,{sx:n,children:[jsxRuntimeExports.jsx(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500},children:"Export Settings"}),jsxRuntimeExports.jsx(Typography,{sx:i,children:"更改导出设置(施工中)"}),jsxRuntimeExports.jsx(IOSSwitch,{disabled:!0,size:"small",inputProps:{"aria-label":"controlled"}})]}),jsxRuntimeExports.jsxs(Box$1,{sx:n,children:[jsxRuntimeExports.jsx(Typography,{id:"settings_1_1",sx:{fontSize:"0.89rem",fontWeight:500},children:"Mermaid Configs"}),jsxRuntimeExports.jsx(Typography,{sx:i,children:"更改Mermaid流程图的设置(施工中)"}),jsxRuntimeExports.jsx(IOSSwitch,{disabled:!0,size:"small",inputProps:{"aria-label":"controlled"}})]})]})})});function Settings(e){useTheme().palette;const t=getTheme();React.useRef();let[n,i]=React.useState(!1);React.useState("");let o=r=>{i(()=>!1),e.onClick(r),e.closeAll()};return React.useEffect(()=>{}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Dialog,{fullScreen:!1,maxWidth:!1,open:e.open,onClose:o,sx:{height:"100vh"},children:jsxRuntimeExports.jsxs(Box$1,{sx:{background:t==="light"?"#F8FAFB":"",padding:"1rem",height:"58vh",width:"60vw"},children:[jsxRuntimeExports.jsx(IconBreadcrumbs,{}),jsxRuntimeExports.jsx(Divider,{sx:{my:.5}}),jsxRuntimeExports.jsxs(Box$1,{sx:{height:"48vh",display:"flex",background:t==="light"?"#F8FAFB":"",padding:"5px",flexDirection:"row",borderRradius:"50px",borderRadius:"5px"},children:[jsxRuntimeExports.jsx(SettingsRoute,{}),jsxRuntimeExports.jsx(SettingsBody,{})]})]})}),jsxRuntimeExports.jsx(default_1$7,{}),"设置"]})}const CustomizedMenus=observer(()=>{const e=useImage(),[t,n]=reactExports.useState(null),[i,o]=reactExports.useState(null),[r,s]=reactExports.useState(null),[c,d]=reactExports.useState(null),[l,a]=reactExports.useState(!1),u=!!t,g=!!i,h=!!r,b=!!c,m=p=>{n(p.currentTarget)},x=p=>{o(p.currentTarget),p.stopPropagation()},E=async p=>{await isSaved()?(s(p.target),p.stopPropagation()):(p.stopPropagation(),f(),a(!0))},R=p=>{d(p.currentTarget)},f=()=>{n(null)},y=p=>{o(null),p.stopPropagation()},w=p=>{s(null),p.stopPropagation()},k=p=>{d(null),p.stopPropagation()},v=()=>{e.display(),f()};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs(Dialog,{open:l,onClose:()=>{a(!1)},children:[jsxRuntimeExports.jsx(DialogTitle,{children:jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"Ready To Export? You Have Not Saved Yet!"})}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{children:jsxRuntimeExports.jsx(Typography,{variant:"body1",gutterBottom:!0,children:'Once you have clicked the "yes" button, your text will be saved.'})})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>{a(!1),save(),myPrint()},children:"YES"}),jsxRuntimeExports.jsx(Button,{onClick:()=>{a(!1)},autoFocus:!0,children:"NO"})]})]}),jsxRuntimeExports.jsx(CustomizedButtons,{open:u,endIcon:jsxRuntimeExports.jsx(default_1$d,{}),onClick:m,children:"更多"}),jsxRuntimeExports.jsxs(StyledMenu,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},elevation:24,anchorEl:t,open:u,onClose:f,children:[jsxRuntimeExports.jsxs(MenuItem,{onClick:v,disableRipple:!0,children:[jsxRuntimeExports.jsx(default_1$8,{}),"图片管理器"]}),jsxRuntimeExports.jsx(MenuItem,{onClick:p=>{E(p)},disableRipple:!0,children:jsxRuntimeExports.jsx(Export,{anchorEl:r,open:h,closeMenu:f,closeExportMenu:w})}),jsxRuntimeExports.jsx(Divider,{sx:{my:.5}}),jsxRuntimeExports.jsx(MenuItem,{onClick:p=>{x(p)},disableRipple:!0,children:jsxRuntimeExports.jsx(Share,{closAll:f,anchorEl:i,open:g,onClick:y})}),jsxRuntimeExports.jsx(MenuItem,{onClick:p=>{R(p)},disableRipple:!0,children:jsxRuntimeExports.jsx(Settings,{closeAll:f,anchorEl:c,open:b,onClick:k})}),jsxRuntimeExports.jsxs(MenuItem,{onClick:()=>{f()},disableRipple:!0,children:[jsxRuntimeExports.jsx(default_1$e,{}),"更多(敬请期待)"]})]})]})});function getSelectionText(e=window.editor){const t=e??window.editor;var n=t.getSelection(),i=n.startLineNumber,o=n.startColumn,r=n.endLineNumber,s=n.endColumn,c=t.getModel().getValueInRange({startLineNumber:i,startColumn:o,endLineNumber:r,endColumn:s});return c}function selectionIsNull(e=window.editor){const n=(e??window.editor).getSelection();return n.startLineNumber==n.endLineNumber&&n.startColumn==n.endColumn}function insertTextMonacoAtCursor(e,t,n=window.editor,i=window.monaco){const o=window.editor,r=e,s=window.editor.getSelections()[0];o.executeEdits("img-insert",[{range:new window.monaco.Range(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn),text:r,forceMoveMarkers:t}])}function insertQuotationInMonaco(e=window.editor){const t=e??window.editor,n=t.getSelection();if(!selectionIsNull()&&!getSelectionText(e)[0].match(/["']/)){t.executeEdits("my-insert-quotation-double",[{range:new window.monaco.Range(n.startLineNumber,n.startColumn,n.startLineNumber,n.startColumn),text:'"',forceMoveMarkers:!1},{range:new window.monaco.Range(n.endLineNumber,n.endColumn,n.endLineNumber,n.endColumn),text:'"',forceMoveMarkers:!1}]);let i={startLineNumber:n.startLineNumber,startColumn:n.startColumn+1,endLineNumber:n.endLineNumber,endColumn:n.endColumn+1};t.setSelection(i)}else selectionIsNull()?t.executeEdits("my-insert-quotation-single",[{range:new window.monaco.Range(n.startLineNumber,n.startColumn,n.startLineNumber,n.startColumn),text:'"',forceMoveMarkers:!0}]):t.executeEdits("my-insert-quotation-single2",[{range:new window.monaco.Range(n.startLineNumber,n.startColumn+1,n.startLineNumber,n.startColumn),text:'"',forceMoveMarkers:!0}])}function writeClipboard(e){navigator.clipboard.writeText(e).catch(t=>{console.error("Failed to copy text: ",t)})}const _MagicImg=React.forwardRef(MagicImg);function MagicImg(e,t){let n="FLEX JUS-CENTER ",i={width:"fitContent"};const[o,r]=React.useState(!1);function s(l){l.altKey&&writeClipboard(`![我是图片](/vf/${e.uuid})`),l.ctrlKey&&insertTextMonacoAtCursor(`![我是图片](/vf/${e.uuid})`,!0)}let[c,d]=React.useState({src:e.src,uuid:e.uuid,magic:e.magic!=0,className:n+(e.className??""),style:e.style?{...e.style,...i}:i});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{...c,...e,ref:t,className:c.className,style:c.style,children:jsxRuntimeExports.jsx(Q,{children:jsxRuntimeExports.jsx(Z,{triggers:["onDoubleClick"],src:c.src,children:jsxRuntimeExports.jsx(Tooltip,{placement:"right",TransitionComponent:Zoom,arrow:!0,title:"按住Ctrl点击插入",children:jsxRuntimeExports.jsx("img",{onMouseEnter:()=>{r(!0)},onMouseLeave:()=>{r(!1)},onClick:l=>{s(l)},style:{width:"70%",transition:" 0.2s ease-in-out",borderRadius:"5px",transform:o?"translate(0px, -2px)":"",boxShadow:o?"1vh 2vh 21px rgb(79 79 79)":"rgb(216 216 216) 1vh 2vh 21px"},src:c.src,alt:"error"})})})})})})}function LR(e){const t=React.Children.toArray(e.children).length;let n="LR ",i={display:"flex",flexDirection:"row",justifyContent:e.jus??"center",alignItems:e.ali??"center",width:"100%",height:"100%"},[o,r]=React.useState({style:e.style?{...e.style,...i}:i,className:n+(e.className??""),space:e.space??void 0,order:[]}),[s,c]=React.useState({marginRight:"5px",width:"100%",height:"100%"});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{...o,...e,className:o.className,style:o.style,children:React.Children.map(e.children,(d,l)=>l==t-1?jsxRuntimeExports.jsx("div",{style:{...s,flex:o.space?"auto":void 0},children:d}):jsxRuntimeExports.jsx("div",{style:{...s,order:`${o.order[l]}`,flex:`0 0 ${o.space?o.space[l]:void 0}%`},children:d}))})})}function Box(e){var r,s;let t="Box ",n={display:"flex",flexDirection:e.dir??"row",justifyContent:e.jus??"center",alignItems:e.ali??"center",width:e.min==1?"fitContent":"100%",height:e.min==1?"fitContent":"100%",transform:e.move?`translate(${((r=e.move)==null?void 0:r.x)??0}, ${((s=e.move)==null?void 0:s.y)??0})`:void 0},[i,o]=React.useState({style:e.style?{...e.style,...n}:n,className:t+(e.className??""),space:e.space??void 0,order:[]});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{...i,...e,className:i.className,style:i.style,children:e.children})})}function deleteDBAll(e){let t=window.indexedDB.deleteDatabase(e);t.onerror=function(n){console.log("删除失败")},t.onsuccess=function(n){console.log("删除成功")}}const theme=createTheme({palette:{primary:{main:"#1976d2"},secondary:purple}}),TemporaryDrawer=observer(e=>{const t=useImage(),[n,i]=reactExports.useState(!1),[o,r]=reactExports.useState([]),[s,c]=reactExports.useState(!1);function d(){c(!0)}return reactExports.useEffect(()=>{readAllMemoryImg().then(l=>{r(l)})}),reactExports.useEffect(()=>{i(t.displayState)},[t.displayState]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Dialog,{open:s,onClose:()=>{c(!1)},children:[jsxRuntimeExports.jsx(DialogTitle,{id:"alert-dialog-title",children:"Ready to delete all the images?"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{id:"alert-dialog-description",children:'Once you have clicked the "yes" button, your pictures and your text will be deleted!'})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>{c(!1),deleteDBAll("md_content"),window.location.reload()},children:"YES"}),jsxRuntimeExports.jsx(Button,{onClick:()=>{c(!1)},autoFocus:!0,children:"NO"})]})]}),jsxRuntimeExports.jsx(Drawer,{anchor:"bottom",open:n,elevation:16,onClose:()=>{t.hidden()},children:jsxRuntimeExports.jsxs("div",{style:{height:"60vh"},children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(ThemeProvider,{theme,children:jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsxs(LR,{space:[90],children:[jsxRuntimeExports.jsxs(Box,{min:1,move:{x:"5vw"},children:[jsxRuntimeExports.jsx("p",{children:"图片管理器"}),jsxRuntimeExports.jsx(Tooltip,{title:jsxRuntimeExports.jsxs("div",{children:["管理粘贴上传的图片",jsxRuntimeExports.jsxs("ul",{style:{margin:"2px"},children:[jsxRuntimeExports.jsx("li",{children:"按住Ctrl点击图片插入"}),jsxRuntimeExports.jsx("li",{children:"双击图片放大预览"}),jsxRuntimeExports.jsx("li",{children:"按住Alt点击图片复制图片"})]})]}),children:jsxRuntimeExports.jsx(IconButton,{children:jsxRuntimeExports.jsx(default_1$f,{color:"primary"})})})]}),jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Tooltip,{title:"删除全部图片和储存的文字",children:jsxRuntimeExports.jsx(IconButton,{onClick:d,children:jsxRuntimeExports.jsx(default_1$g,{color:"primary"})})})})]})})})}),jsxRuntimeExports.jsx(Divider,{style:{marginBottom:"1.3vh"}}),jsxRuntimeExports.jsx(Grid,{container:!0,rowSpacing:5,columns:16,children:o?o.map((l,a)=>jsxRuntimeExports.jsx(Grid,{id:l.uuid,xs:8,children:jsxRuntimeExports.jsx(_MagicImg,{magic:0,src:l.imgBase64,uuid:l.uuid})},l.uuid)):void 0})]})})]})}),svg_1=""+new URL("../2904f250.aboutBox关闭.svg",import.meta.url).href;let aboutMd;const aboutBox=async()=>{let e=`
<div class="closeBox" id="closeAbout">
<img id="closeAboutSvg" class="closeSvg" src=${svg_1} alt="">
</div>
`;await fetch("https://jsd.onmicrosoft.cn/gh/LiWeny16/MarkdownOnline@main/source/assets/about.md").then(async n=>{aboutMd=n.text(),document.getElementById("aboutMd")&&(document.getElementById("aboutMd").innerHTML=e+t(await aboutMd))}).catch(n=>{console.error("Error fetching markdown:",n)});function t(n){return markdownParser().render(n)}document.getElementById("closeAboutSvg").addEventListener("click",()=>{document.getElementById("aboutBox").style.display="none"}),document.getElementById("aboutBox").addEventListener("click",n=>{n.target==document.getElementById("markdownParser")&&(document.getElementById("aboutBox").style.display="none")}),document.getElementById("aboutBox").style.display="block"},runTo=(e,t)=>{kit.sleep(t).then(()=>{window.location.href=e})},handleHomeClick=()=>{runTo("https://bigonion.cn",300)},boxShadow="0px 2px 4px -1px rgba(0,0,0,0.2), 0px 4px 5px 0px rgba(0,0,0,0.14), 0px 1px 10px 0px rgba(0,0,0,0.12);",drawerWidth=240,DrawerAppBar=observer(e=>{const t=useTheme(),{window:n}=e,[i,o]=reactExports.useState(!1),r=()=>{o(l=>!l)},s=n!==void 0?()=>n().document.body:void 0;reactExports.useState(!1);const c=()=>{Message.info({content:"此功能仍然在开发中",closable:!0,duration:3e3,position:"bottom"})},d=jsxRuntimeExports.jsxs(Box$1,{onClick:r,sx:{textAlign:"center",height:"100%",bgcolor:"black"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h1",sx:{fontSize:"20px",my:2,color:"wheat",textAlign:"center",boxShadow},children:"Markdown+ Online View"}),jsxRuntimeExports.jsxs(List,{sx:{height:"100%",bgcolor:"background.paper"},children:[jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsxs(ListItemButton,{onClick:handleHomeClick,children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:jsxRuntimeExports.jsx(default_1$a,{})})}),jsxRuntimeExports.jsx(ListItemText,{primary:"Home",secondary:""})]})}),jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsxs(ListItemButton,{onClick:c,children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:jsxRuntimeExports.jsx(default_1$k,{})})}),jsxRuntimeExports.jsx(ListItemText,{primary:"Photos",secondary:""})]})}),jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsxs(ListItemButton,{onClick:myPrint,children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:jsxRuntimeExports.jsx(default_1$l,{})})}),jsxRuntimeExports.jsx(ListItemText,{primary:"Export",secondary:""})]})}),jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsxs(ListItemButton,{onClick:()=>{aboutBox()},children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:jsxRuntimeExports.jsx(default_1$m,{})})}),jsxRuntimeExports.jsx(ListItemText,{primary:"About",secondary:""})]})})]})]});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"FLEX ",style:{flex:"0 0 8.7vh"},children:[jsxRuntimeExports.jsx(CssBaseline,{}),jsxRuntimeExports.jsx(AppBar,{component:"nav",sx:{position:"inherit",justifyContent:"center",zIndex:100,height:"8.7vh",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},children:jsxRuntimeExports.jsxs(Toolbar,{children:[jsxRuntimeExports.jsx(IconButton,{color:"inherit",onClick:r,sx:{mr:200,display:{sm:"none"}},children:jsxRuntimeExports.jsx(default_1$h,{})}),jsxRuntimeExports.jsx(default_1$i,{sx:{color:t.palette.mode=="light"?"black":"white",display:{xs:"none",md:"flex"},transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",mr:1}}),jsxRuntimeExports.jsx(Typography,{variant:"h1",component:"a",fontFamily:"monospace",href:"/",sx:{flexGrow:1,display:{xs:"none",sm:"block"},color:t.palette.mode==="light"?t.palette.primary.contrastText:t.palette.secondary.contrastText,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",textDecoration:"none"},children:jsxRuntimeExports.jsx("h1",{style:{fontSize:"28px"},children:"Markdown+ Online View"})}),jsxRuntimeExports.jsxs(Box$1,{sx:{display:{xs:"none",sm:"flex",flexDirection:"row"}},children:[jsxRuntimeExports.jsx(CustomizedButtons,{href:"https://bigonion.cn",startIcon:jsxRuntimeExports.jsx(default_1$j,{}),children:"首页"}),jsxRuntimeExports.jsx(CustomizedButtons,{onClick:()=>{aboutBox()},startIcon:jsxRuntimeExports.jsx(default_1$f,{}),children:"关于"}),jsxRuntimeExports.jsx(CustomizedMenus,{}),jsxRuntimeExports.jsx(TemporaryDrawer,{})]})]})}),jsxRuntimeExports.jsx(Box$1,{sx:{display:{xs:"flex",sm:"none"}},component:"nav",children:jsxRuntimeExports.jsx(Drawer,{container:s,variant:"temporary",open:i,onClose:r,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:drawerWidth}},children:d})})]})})});function enableFastKeyEvent(){document.addEventListener("keydown",e=>{e.key=="Tab"&&e.preventDefault(),e.ctrlKey&&e.key=="b",e.key=="c"&&e.altKey,e.ctrlKey&&e.key=="s"&&(e.stopPropagation(),e.preventDefault(),save()),e.key=="i"&&e.altKey&&e.ctrlKey,e.key=="o"&&e.altKey&&e.ctrlKey},!0)}function monacoPasteEvent(e,t){e.getContainerDomNode().addEventListener("paste",n=>{handlePasteEvent(n).then(i=>{if(i){let o="",r=new Date().getTime();console.log(i);for(let s=0;s<=i.length-1;s++)console.log(s),o+=`![我是图片](/vf/${r+s})`;fillInMemoryImgs(i,r),insertTextMonacoAtCursor(o,!0)}})},!0)}function handlePasteEvent(e){return new Promise(t=>{let i=(e.clipboardData||window.clipboardData).items;const o=i.length;let r=[];for(let s=0;s<i.length;s++){let c=i[s];if(c.kind=="file"){e.preventDefault(),e.stopPropagation();let d=c.getAsFile(),l=new FileReader;l.onload=function(u){r.push(u.target.result),s===o-1&&t(r)};const a=d.type.split("/")[1];(a==="png"||a==="jpg"||a==="jpeg"||a==="webp"||a==="svg")&&l.readAsDataURL(d)}else t([])}})}let lock=!1,triggerTime=0;function triggerConverterEvent(e=2){let t,n;triggerTime++,lock?(clearTimeout(t),t=setTimeout(function(){mdConverter(),triggerTime=0},300)):(clearTimeout(n),triggerTime>=e?(lock=!0,mdConverter(),n=setTimeout(()=>{lock=!1,triggerTime=0},200)):mdConverter())}function getCommandPaletteText(){return document.getElementsByClassName("ibwrapper")[0]?document.getElementsByClassName("ibwrapper")[0].children[0].value:""}function exeTableAction(){const e=getCommandPaletteText().split("#")[1],t=getCommandPaletteText().split("#")[2];insertTextMonacoAtCursor(generateMarkdownTable(e,t),!0)}function generateMarkdownTable(e,t){if(!e||!t)return"";let n="| ";for(let i=0;i<t;i++)n+=`Header  ${i+1} | `;n+=`
|`;for(let i=0;i<t;i++)n+="--- | ";for(let i=0;i<e;i++){n+=`
| `;for(let o=0;o<t;o++)n+=` Cell ${i+1}-${o+1} | `}return n}function exeInsertPageBreakerAction(){insertTextMonacoAtCursor(`|---|
`,!0)}function exeLatexBlockAction(e,t){const n=e.getPosition();n.column==1&&(insertTextMonacoAtCursor(`$$

$$`,!0),e.setPosition({column:1,lineNumber:n.lineNumber+1}))}function exeEmojiPickerAction(e,t){getEmojiPickerState()==="on"?changeEmojiPickerState("off"):changeEmojiPickerState("on")}function exeSpeechPanelAction(e,t){const n=getSettings().basic.speechLanguage??"zh-CN";let i=o=>{insertTextMonacoAtCursor(window._speechData.speechResult,!0)};if(window._speechData.processing)window._speechData.processing=!1,window._speechData.speech.stopRecognition(),window._speechData.speech=null,window._speechData.speechResult="";else{window._speechData.processing=!0;let{recognition:o}=speechRecognition(n,!0,i);window._speechData.speech=o}}function monacoKeyEvent(e,t){const n={save:t.KeyMod.CtrlCmd|t.KeyCode.KeyS,left:t.KeyMod.CtrlCmd|t.KeyCode.KeyL,right:t.KeyMod.CtrlCmd|t.KeyCode.KeyR,quotation:t.KeyMod.Shift|t.KeyCode.Quote,format:t.KeyMod.Shift|t.KeyCode.KeyF,pageBreaker:t.KeyMod.CtrlCmd|t.KeyMod.Alt|t.KeyCode.Enter,latexBlock:t.KeyMod.CtrlCmd|t.KeyCode.KeyM,voice2Words:t.KeyMod.CtrlCmd|t.KeyMod.Alt|t.KeyCode.KeyV};e.addAction({id:"fsKey2",label:"fsKey2",keybindings:[],run:i=>{e.getAction("editor.action.formatDocument").run()}}),e.addAction({id:"fsKey3",label:"fsKey3",keybindings:[n.left],run:()=>{}}),e.addAction({id:"fsKey4",label:"fsKey4",keybindings:[],run:()=>{insertQuotationInMonaco()}}),e.addAction({id:"table-any",label:"table#x#x",keybindings:[],run:()=>{exeTableAction()}}),e.addAction({id:"reload",label:"Reload Markdown Online View+",keybindings:[],contextMenuGroupId:"navigation",run:()=>{window.location.reload()}}),e.addAction({id:"reload-no-cache",label:"Reload Markdown Online View+ (With No Cache)",keybindings:[],run:()=>{window.location.reload(!0)}}),e.addAction({id:"export.asPDF",label:"Export AS PDF",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:0,run:async()=>{await isSaved()?myPrint():(save(),kit.sleep(800).then(()=>{myPrint()}))}}),e.addAction({id:"export.asImg",label:"Export As Image",keybindings:[],run:()=>{exportAsImage()}}),e.addAction({id:"insert.pageBreaker",label:"Insert A Page Breaker",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:0,run:()=>{exeInsertPageBreakerAction()}}),e.addAction({id:"insert.latexBlock",label:"Insert A Latex Block",keybindings:[n.latexBlock],contextMenuGroupId:"navigation",contextMenuOrder:0,run:()=>{exeLatexBlockAction(e)}}),e.addAction({id:"show.emojiPicker",label:"Show Emoji Picker 🤪",keybindings:[],contextMenuGroupId:"navigation",contextMenuOrder:-100,run:()=>{exeEmojiPickerAction()}}),e.addAction({id:"insert.voice2words",label:"Speech to text",keybindings:[n.voice2Words],contextMenuGroupId:"navigation",run:()=>{exeSpeechPanelAction()}})}function monacoSnippets(e,t){t.languages.registerCompletionItemProvider("markdown",{provideCompletionItems:(n,i,o)=>{const r=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:i.lineNumber,endColumn:i.column});if(!isInLatexBlock(r)&&i.column===2)return{suggestions:[{label:"clg",kind:t.languages.CompletionItemKind.Function,insertText:"console.log(${1:val})",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"调试..."},{label:"code",kind:t.languages.CompletionItemKind.Function,insertText:"\n```${1:js}\n${2:}\n```\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"code"},{label:"table 2x2",kind:t.languages.CompletionItemKind.Function,insertText:"\n|${1:}    |${1:}     |\n|--- |---  |\n|${1:}    |${1:}     |\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"table 2x2"},{label:"table 2x4",kind:t.languages.CompletionItemKind.Function,insertText:"\n|${1:}    |${1:}    |${1:}    |${1:}    |\n|--- |--- |--- |--- |\n|${1:}    |${1:}    |${1:}    |${1:}    |\n",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"table 2x4"},{label:"ignore",kind:t.languages.CompletionItemKind.Field,insertText:"<!-- prettier-ignore -->",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"ignore prettier"},{label:"ignore-block",kind:t.languages.CompletionItemKind.Field,insertText:`<!-- prettier-ignore-start -->
\${1:}
<!-- prettier-ignore-end -->`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"ignore block"},{label:"latex-block",kind:t.languages.CompletionItemKind.Field,insertText:`$$
\${1:}
$$
`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"Create A LaTex Block"},{label:"latex-inline",kind:t.languages.CompletionItemKind.Field,insertText:"$${1:}$",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"Create A LaTex Inline"}]}}}),t.languages.registerCompletionItemProvider("markdown",{triggerCharacters:["\\"],provideCompletionItems:(n,i,o)=>{const r=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:i.lineNumber,endColumn:i.column});if(isNeedToUseLatexIntellisense(r)){const s=Array.from([...delimiters0,...delimeterSizing0,...greekLetters0,...otherLetters0,...spacing0,...verticalLayout0,...logicAndSetTheory0,...macros0,...bigOperators0,...binaryOperators0,...binomialCoefficients0,...fractions0,...mathOperators0,...relations0,...negatedRelations0,...arrows0,...font0,...size0,...style0,...symbolsAndPunctuation0,...debugging0],(a,u)=>({label:`\\${a}`,kind:t.languages.CompletionItemKind.Function,insertText:a,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(a[0])?"1":"0"})),c=Array.from([...accents1,...annotation1,...verticalLayout1,...overlap1,...spacing1,...logicAndSetTheory1,...mathOperators1,...sqrt1,...extensibleArrows1,...font1,...braketNotation1,...classAssignment1],(a,u)=>({label:`\\${a}`,kind:t.languages.CompletionItemKind.Function,insertText:`${a}{$1}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(a[0])?"1":"0"})),d=Array.from([...verticalLayout2,...binomialCoefficients2,...fractions2,...color2],(a,u)=>({label:`\\${a}`,kind:t.languages.CompletionItemKind.Function,insertText:`${a}{$1}{$2}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,sortText:/[A-Z]/.test(a[0])?"1":"0"})),l=[{label:"\\begin",kind:t.languages.CompletionItemKind.Function,insertText:"begin{${1|"+envs.join(",")+`|}}
	$2
\\end{$1}`,insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet}];return{suggestions:[...s,...c,...d,...l]}}}}),t.languages.registerCompletionItemProvider("markdown",{triggerCharacters:["^"],provideCompletionItems:(n,i,o)=>{const r=n.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:i.lineNumber,endColumn:i.column});if(isNeedToUseClueIntellisense(r))return{suggestions:[{label:"RED",kind:t.languages.CompletionItemKind.Function,insertText:"RED",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"RED..."},{label:"PINK",kind:t.languages.CompletionItemKind.Function,insertText:"PINK",insertTextRules:t.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:"PINK..."}]}}})}function isNeedToUseLatexIntellisense(e){return!!(e[e.length-1]==="\\"&&isInLatexBlock(e))}function isInLatexBlock(e){return(e.match(/\$\$/g)?e.match(/\$\$/g).length%2===1:!1)||(e.match(/\$/g)?e.match(/\$/g).length%2===1:!1)}function isNeedToUseClueIntellisense(e){return e[e.length-1]==="^"}function replaceMonacoAll(e,t,n=""){const i=t??window.editor;let o=e.getFullModelRange();i.executeEdits("my-replace2",[{range:o,text:n,forceMoveMarkers:!0}])}function monacoFormat(e,t){t.languages.registerDocumentFormattingEditProvider("markdown",{provideDocumentFormattingEdits(n){let i=n.getValue();var o=e.getPosition();return prettier.format(i,{parser:"markdown",plugins:[parseMd]}).then(r=>{replaceMonacoAll(n,e,r),e.setPosition(o)}),[]}})}function getDeviceTyByProportion(){const e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;return e/t>=1?"PC":"mobile"}function monacoMouseEvent(e,t){e.onContextMenu(n=>{setContextMenuClickPosition({posx:n.event.posx,posy:n.event.posy})})}function monacoClickEvent(e,t){e.onDidFocusEditorWidget(()=>{window.deco.clear()})}function monacoResizeHeightEvent(e){const t=()=>{e(Math.floor(window.innerHeight*.9))};window.addEventListener("resize",t)}const version="0.45.0",cdnDomain={unpkg:["npm.onmicrosoft.cn","unpkg.com"],jsDelivr:["jsd.onmicrosoft.cn","www.jsdelivr.com","jsd.haorwen.tk"]},cdnLinks={unpkg:{cdn:`https://${cdnDomain.unpkg[0]}/monaco-editor@${version}/dev/vs`},jsDelivr:{cdn:`https://${cdnDomain.jsDelivr[0]}/npm/monaco-editor@${version}/dev/vs`}};try{loader.config({paths:{vs:cdnLinks.unpkg.cdn}})}catch(e){loader.config({paths:{vs:cdnLinks.jsDelivr.cdn}})}const files={"index.js":{name:"index.js",language:"javascript",value:"nihao"},"style.css":{name:"style.css",language:"css",value:"nihao"},"index.md":{name:"index.md",language:"markdown",value:""}},MonacoEditor=observer(function e(){const[t,n]=React.useState(640),[i,o]=React.useState(800),r=()=>{mdConverter(),setTimeout(()=>{c(m=>({...m,minimap:{enabled:!0}}))},300)},[s,c]=reactExports.useState({fontSize:16,wordWrap:"on",formatOnType:!0,formatOnPaste:!1,fontLigatures:!0,autoSurround:"quotes",autoClosingQuotes:"always",smoothScrolling:!0,codeLens:!1,pasteAs:{enabled:!1,showPasteSelector:"never"},peekWidgetDefaultFocus:"tree",cursorSmoothCaretAnimation:"explicit",colorDecorators:!0,minimap:{enabled:!0},unicodeHighlight:{nonBasicASCII:!1,ambiguousCharacters:!1}}),[d,l]=reactExports.useState("index.md"),a=files[d];function u(m){triggerConverterEvent(4)}function g(m,x){x.languages.setLanguageConfiguration("markdown",{autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'",notIn:["string","comment"]},{open:"`",close:"`",notIn:["string","comment"]},{open:"/*",close:"*/",notIn:["string"]},{open:"？",close:"？",notIn:["string","comment"]}]}),x.languages.setMonarchTokensProvider("markdown",{tokenizer:{root:[[/\b(function|return|var)\b/,"keyword"],[/[{}]/,"delimiter"],[/[a-z_$][\w$]*/,"identifier"],[/"[^"]*"/,"string"],[/\d+/,"number"],[/[$$$$]/,"annotation"]]}})}function h(){}function b(m,x){window.editor=m,window.monaco=x,getDeviceTyByProportion()=="PC"&&n(document.getElementById("editor").clientWidth/2),o(document.getElementById("editor").clientHeight),g(m,x),monacoPasteEvent(m),monacoKeyEvent(m,x),monacoSnippets(m,x),monacoFormat(m,x),monacoMouseEvent(m),monacoClickEvent(m),allInit(m,x),monacoResizeHeightEvent(o)}return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{id:"monaco-editor",style:{width:t,height:"100%"},children:jsxRuntimeExports.jsx(ResizableBox,{className:"custom-resizable",width:t,height:i,draggableOpts:{grid:[5,15]},minConstraints:[100,i],onResizeStop:r,onResize:m=>{c(x=>({...x,minimap:{enabled:!1}})),n(m.x)},axis:"x",children:jsxRuntimeExports.jsx(Ft,{className:"monaco-editor-inner",height:"100%",width:t,theme:getTheme()==="light"?"vs-light":"vs-dark",path:a.name,defaultLanguage:a.language,defaultValue:a.value,onMount:b,onChange:u,options:s,beforeMount:h})})})})});function MdArea(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(MonacoEditor,{})})}const EmojiPicker=observer(function e(t){const i=l(),o=React.useRef(),[r,s]=React.useState(!1),[c,d]=React.useState(!1);function l(){let u=getContextMenuClickPosition();return u.posy+435>window.document.body.clientHeight&&(u.posy=window.document.body.clientHeight-435),u}function a(u){insertTextMonacoAtCursor(u.native,!0)}return React.useEffect(()=>{s(t.open),t.open?(d(t.open),gsap.fromTo(".emojiPicker",{x:0},{x:20,opacity:1,duration:.6})):gsap.to(".emojiPicker",{opacity:0,duration:.4,onComplete:function(){d(r)}})},[t.open]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Backdrop,{invisible:!0,ref:o,transitionDuration:{appear:500,enter:500,exit:1e3},sx:{zIndex:u=>u.zIndex.drawer+1,pointerEvents:r?"":"none"},open:r,onContextMenu:u=>{u.target.tagName!="EM-EMOJI-PICKER"&&(changeEmojiPickerState("off"),u.preventDefault())},onMouseUp:u=>{u.button==2||u.button==0&&u.target.tagName!="EM-EMOJI-PICKER"&&changeEmojiPickerState("off")},children:jsxRuntimeExports.jsx(Box$1,{sx:{position:"absolute",top:i.posy-window.document.body.clientHeight*.1,left:i.posx+window.document.body.clientWidth*.02},className:"MIN emojiPicker",children:jsxRuntimeExports.jsx($e5534fc185f7111e$export$2e2bcd8739ae039,{data,onEmojiSelect:a})})})})});function enEvents(e){e&&enableFastKeyEvent()}const Body=observer(function e(){return React.useEffect(()=>{enEvents(!0)},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{style:{marginTop:"1.3vh"},id:"bodyTopBox",children:[jsxRuntimeExports.jsxs("div",{id:"editor",className:`${getTheme()=="light"?"theme-light":"theme-dark"} FLEX ROW`,children:[jsxRuntimeExports.jsx(MdArea,{}),jsxRuntimeExports.jsx("article",{id:"view-area-hidden",className:"hidden-pre"}),jsxRuntimeExports.jsx("article",{id:"view-area",className:`markdown-body ${getTheme()==="light"?"markdown-body-light":"markdown-body-dark"}`})]}),jsxRuntimeExports.jsx("div",{id:"aboutBox",children:jsxRuntimeExports.jsx("div",{id:"markdownParser",children:jsxRuntimeExports.jsx("div",{id:"aboutMd",className:`aboutViewArea markdown-body ${getTheme()==="light"?"markdown-body-light":"markdown-body-dark"}`})})}),jsxRuntimeExports.jsx(EmojiPicker,{open:getEmojiPickerState()==="on"})]})})}),lightTheme=createTheme({palette:{primary:{main:blue[200],contrastText:"#fff378"},secondary:{main:green[500],contrastText:"pink"},mode:"light"}}),darkTheme=createTheme({palette:{primary:{main:blue[400],contrastText:"wheat"},secondary:{main:green[700],contrastText:"wheat"},mode:"dark"}}),App=observer(()=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(ThemeProvider,{theme:getTheme()==="light"?lightTheme:darkTheme,children:[jsxRuntimeExports.jsx(CssBaseline,{}),jsxRuntimeExports.jsxs("div",{className:"FLEX COL",children:[jsxRuntimeExports.jsx(DrawerAppBar,{}),jsxRuntimeExports.jsx(Body,{})]})]})}));client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
